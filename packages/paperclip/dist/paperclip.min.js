var paperclip=function(n){"use strict";function e(n,e){function t(){this.constructor=n}for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}function t(n,e,t,r){return new(t||(t=Promise))(function(u,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function i(n){try{c(r.throw(n))}catch(n){o(n)}}function c(n){n.done?u(n.value):new t(function(e){e(n.value)}).then(a,i)}c((r=r.apply(n,e)).next())})}var r;!function(n){n[n.STRING=0]="STRING",n[n.BLOCK=1]="BLOCK",n[n.STRING_BLOCK=2]="STRING_BLOCK",n[n.ELEMENT=3]="ELEMENT",n[n.SELF_CLOSING_ELEMENT=4]="SELF_CLOSING_ELEMENT",n[n.TEXT_NODE=5]="TEXT_NODE",n[n.COMMENT=6]="COMMENT",n[n.ATTRIBUTE=7]="ATTRIBUTE",n[n.START_TAG=8]="START_TAG",n[n.BLOCK_STRING=9]="BLOCK_STRING",n[n.FRAGMENT=10]="FRAGMENT",n[n.END_TAG=11]="END_TAG"}(r||(r={}));var u;!function(n){n[n.TYPE=0]="TYPE",n[n.ECHO=1]="ECHO",n[n.IF=2]="IF",n[n.NUMBER=3]="NUMBER",n[n.RESERVED_KEYWORD=4]="RESERVED_KEYWORD",n[n.ELSEIF=5]="ELSEIF",n[n.NOT=6]="NOT",n[n.OPERATION=7]="OPERATION",n[n.GROUP=8]="GROUP",n[n.REFERENCE=9]="REFERENCE",n[n.ELSE=10]="ELSE",n[n.REPEAT=11]="REPEAT"}(u||(u={}));var o,a=function(n){return n.type==r.SELF_CLOSING_ELEMENT?[]:n.childNodes},i=function(n){return n.type==r.SELF_CLOSING_ELEMENT?n.name:n.startTag.name},c=function(n){return n.value.value},s=function(n){return n.type==r.SELF_CLOSING_ELEMENT?n.attributes:n.startTag.attributes},l=function(n){return n.type===r.ELEMENT||n.type===r.ELEMENT||n.type===r.START_TAG||n.type===r.END_TAG},E=function(n,e,t){if(void 0===t&&(t=[]),!1===e(n,t))return!1;if(n.childNodes)for(var r=n,u=0,o=r.childNodes.length;u<o;u++){var a=r.childNodes[u];if(!1===E(a,e,t.concat(["childNodes",u])))return!1}},p=function(n){return n.type===r.ELEMENT?n.startTag:n},f=function(n,e){return p(n).modifiers.find(function(n){return n.type===e})},d=function(n,e){var t;return E(e,function(e,r){if(e===n)return t=r,!1}),t},T=function(n,e){var t=[];return E(n,function(n){e(n)&&t.push(n)}),t},v=function(n,e){return T(n,function(n){return n.childNodes&&n.childNodes.find(function(n){return n===e||e.type===r.START_TAG&&n.type===r.ELEMENT&&n.startTag===e})})[0]},N=function(n,e,t){return{type:n,pos:e,value:t}},h=function(n){var e=1,t=0,r={};return(n+" ").split("").forEach(function(n,u){r[u]=[t,e],"\n"===n&&(t=0,e++),t++}),r},_=function(n,e){var t="number"==typeof n?n:n.pos,r=h(e)[t];return{column:r[0],line:r[1],pos:t}},A=function(n,e,t){return{start:n.line?n:_(n,t),end:e&&e.line?e:_(t.length,t)}},S=function(){function n(n){this._target=n,this.pos=0,this.length=n.length}return n.prototype.curr=function(){return this._target[this.pos]},n.prototype.shift=function(){var n=this._target[this.pos];return this.next(),n},n.prototype.hasNext=function(){return this.pos<this.length-1},n.prototype.next=function(){return this._target[Math.min(this.pos=this.pos+1,this.length)]},n.prototype.prev=function(){return this._target[Math.max(this.pos=this.pos-1,0)]},n.prototype.ended=function(){return this.pos>=this.length},n}(),R=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t.prototype.scan=function(n){for(var e="";this.pos<this.length;){var t=this._target[this.pos];if(!t.match(n))break;e+=t,this.pos++}return e},t.prototype.peek=function(n){return this._target.substr(this.pos,n)},t.prototype.take=function(n){var e=this._target.substr(this.pos,n);return this.pos+=n,e},t}(S),y=function(n){function t(e,t){var r=n.call(this,t)||this;return r.source=e,r}return e(t,n),t.prototype.peek=function(n){return void 0===n&&(n=1),this._target[this.pos+n]},t.prototype.peekUntil=function(n){for(var e=this.pos;e<this.length-1;)if(n(this._target[++e]))return this._target[e]},t.prototype.curr=function(){return n.prototype.curr.call(this)},t.prototype.next=function(){return n.prototype.next.call(this)},t}(S);!function(n){n[n.LESS_THAN=0]="LESS_THAN",n[n.LESS_THAN_OR_EQUAL=1]="LESS_THAN_OR_EQUAL",n[n.CLOSE_TAG=2]="CLOSE_TAG",n[n.GREATER_THAN=3]="GREATER_THAN",n[n.GREATER_THAN_OR_EQUAL=4]="GREATER_THAN_OR_EQUAL",n[n.COMMENT_START=5]="COMMENT_START",n[n.COMMENT_END=6]="COMMENT_END",n[n.BACKSLASH=7]="BACKSLASH",n[n.BANG=8]="BANG",n[n.AND=9]="AND",n[n.OR=10]="OR",n[n.PLUS=11]="PLUS",n[n.MINUS=12]="MINUS",n[n.STAR=13]="STAR",n[n.PERCENT=14]="PERCENT",n[n.PAREN_OPEN=15]="PAREN_OPEN",n[n.PAREN_CLOSE=16]="PAREN_CLOSE",n[n.DOUBLE_EQUALS=17]="DOUBLE_EQUALS",n[n.TRIPPLE_EQUELS=18]="TRIPPLE_EQUELS",n[n.BRACKET_OPEN=19]="BRACKET_OPEN",n[n.BRACKET_CLOSE=20]="BRACKET_CLOSE",n[n.CURLY_BRACKET_OPEN=21]="CURLY_BRACKET_OPEN",n[n.CURLY_BRACKET_CLOSE=22]="CURLY_BRACKET_CLOSE",n[n.EQUALS=23]="EQUALS",n[n.SINGLE_QUOTE=24]="SINGLE_QUOTE",n[n.DOUBLE_QUOTE=25]="DOUBLE_QUOTE",n[n.TEXT=26]="TEXT",n[n.RESERVED_KEYWORD=27]="RESERVED_KEYWORD",n[n.WHITESPACE=28]="WHITESPACE"}(o||(o={}));var L=function(n){for(var e=new R(n),t=[];!e.ended();){var r=e.curr(),u=void 0;if("<"===r)u="</"===e.peek(2)?N(o.CLOSE_TAG,e.pos,e.take(2)):"\x3c!--"===e.peek(4)?N(o.COMMENT_START,e.pos,e.take(4)):"<="===e.peek(2)?N(o.LESS_THAN_OR_EQUAL,e.pos,e.take(2)):N(o.LESS_THAN,e.pos,e.shift());else if("-"===r&&"--\x3e"===e.peek(3))u=N(o.COMMENT_END,e.pos,e.take(3));else if("&"===r&&"&&"===e.peek(2))u=N(o.AND,e.pos,e.take(2));else if("|"===r&&"||"===e.peek(2))u=N(o.OR,e.pos,e.take(2));else if(">"===r)u=">="===e.peek(2)?N(o.GREATER_THAN_OR_EQUAL,e.pos,e.take(2)):N(o.GREATER_THAN,e.pos,e.shift());else if("="===r)u="==="===e.peek(3)?N(o.TRIPPLE_EQUELS,e.pos,e.take(3)):"=="===e.peek(2)?N(o.DOUBLE_EQUALS,e.pos,e.take(2)):N(o.EQUALS,e.pos,e.shift());else if("'"===r)u=N(o.SINGLE_QUOTE,e.pos,e.shift());else if("!"===r)u=N(o.BANG,e.pos,e.shift());else if("/"===r)u=N(o.BACKSLASH,e.pos,e.shift());else if('"'===r)u=N(o.DOUBLE_QUOTE,e.pos,e.shift());else if("+"===r)u=N(o.PLUS,e.pos,e.shift());else if("-"===r)u=N(o.MINUS,e.pos,e.shift());else if("*"===r)u=N(o.STAR,e.pos,e.shift());else if("%"===r)u=N(o.PERCENT,e.pos,e.shift());else if("["===r)u=N(o.BRACKET_OPEN,e.pos,e.shift());else if("]"===r)u=N(o.BRACKET_CLOSE,e.pos,e.shift());else if("("===r)u=N(o.PAREN_OPEN,e.pos,e.shift());else if(")"===r)u=N(o.PAREN_CLOSE,e.pos,e.shift());else if("{"===r)u=N(o.CURLY_BRACKET_OPEN,e.pos,e.shift());else if("}"===r)u=N(o.CURLY_BRACKET_CLOSE,e.pos,e.shift());else if(/[\s\r\n\t]/.test(r))u=N(o.WHITESPACE,e.pos,e.scan(/[\s\r\n\t]/));else{var a=e.scan(/[^-<>,='"(){}\[\]\s\r\n\t]/)||e.shift();u=N("undefined"===a?o.RESERVED_KEYWORD:o.TEXT,e.pos,a)}t.push(u)}return new y(n,t)},O={},$=function(n){if(O[n])return O[n];var e=L(n);return g(e)},g=function(n){for(var e=[];!n.ended();)e.push(m(n));return 1===e.length?e[0]:{type:r.FRAGMENT,location:A(0,n.source.length,n.source),childNodes:e}},m=function(n){switch(n.curr().type){case o.WHITESPACE:return Y(n);case o.SINGLE_QUOTE:case o.DOUBLE_QUOTE:return W(n);case o.LESS_THAN:return F(n);case o.CLOSE_TAG:return H(n);case o.COMMENT_START:return D(n);default:return K(n)?C(n):Y(n)}},C=function(n){var e=n.curr();n.next(),n.next(),X(n);var t=b(n);return X(n),n.next(),n.next(),{type:r.BLOCK,location:A(e,n.curr(),n.source),value:t}},b=function(n){switch(n.curr().value){case"bind":return I(n);case"repeat":return B(n);case"if":return P(n,u.IF);case"elseif":return P(n,u.ELSEIF);case"else":return P(n,u.ELSE);default:throw new Error("Unknown block type "+n.curr().value)}},U=function(n){return x(n)},x=function(n){var e=G(n);X(n);var t=n.curr(),r=t.type;if(!(r===o.AND||r===o.OR||r==o.PLUS||r===o.MINUS||r===o.STAR||r===o.BACKSLASH||r===o.DOUBLE_EQUALS||r===o.TRIPPLE_EQUELS||r===o.GREATER_THAN||r===o.LESS_THAN||r===o.LESS_THAN_OR_EQUAL||r===o.GREATER_THAN_OR_EQUAL))return e;n.next(),X(n);var a=x(n);return{type:u.OPERATION,left:e,right:a,operator:t.value,location:A(e.location.start,a.location.end,n.source)}},G=function(n){switch(n.curr().type){case o.BANG:return k(n);case o.PAREN_OPEN:return w(n);case o.TEXT:return V(n);case o.RESERVED_KEYWORD:return M(n);default:throw new Error("Unknown block type "+n.curr().value)}},w=function(n){var e=n.curr();n.next();var t=U(n);return n.next(),{type:u.GROUP,value:t,location:A(e,n.curr(),n.source)}},M=function(n){var e=n.curr();return n.next(),{type:u.RESERVED_KEYWORD,value:e.value,location:A(e,n.curr(),n.source)}},I=function(n){var e=n.curr();return n.next(),n.next(),{type:u.ECHO,value:U(n),location:A(e,n.curr(),n.source)}},P=function(n,e){var t=n.curr();return n.next(),n.next(),{type:e,condition:U(n),location:A(t,n.curr(),n.source)}},B=function(n){var e=n.curr();n.next();var t=V(n);n.next();var r,o=V(n);return","===n.curr().value&&(n.next(),r=V(n)),{type:u.REPEAT,location:A(e,n.curr(),n.source),each:t,asKey:r,asValue:o}},V=function(n){X(n);var e=n.curr();return n.next(),X(n),{type:u.REFERENCE,value:e.value,location:A(e,n.curr(),n.source)}},k=function(n){var e=n.curr();return n.next(),{type:u.NOT,value:G(n),location:A(e,n.curr(),n.source)}},D=function(n){var e,t=n.curr(),u="";for(n.next();!n.ended()&&(e=n.curr(),n.next(),e.type!==o.COMMENT_END);)u+=e.value;return{type:r.COMMENT,value:u,location:A(t,n.curr(),n.source)}},K=function(n){return n.curr().type===o.BRACKET_OPEN&&n.peek(1).type===o.BRACKET_OPEN},H=function(n){var e=n.curr(),t=n.next();return n.next(),n.next(),{type:r.END_TAG,name:t.value,location:A(e,n.curr(),n.source)}},F=function(n){var e=n.curr();n.next();for(var t=q(n),u=[],a=[];!n.ended();){X(n);var i=n.curr();if(i.type===o.BACKSLASH||i.type==o.GREATER_THAN)break;K(n)?a.push(C(n)):u.push(j(n))}if(n.curr().type===o.BACKSLASH)return n.next(),n.next(),{type:r.SELF_CLOSING_ELEMENT,name:t,attributes:u,modifiers:a,location:A(e,n.curr(),n.source)};n.next();var c=n.curr(),s=Q(t,n),l=s[0],E=s[1];return{type:r.ELEMENT,startTag:{name:t,type:r.START_TAG,location:A(e,c,n.source),modifiers:a,attributes:u},childNodes:l,location:A(e,n.curr(),n.source),endTag:E}},Q=function(n,e){for(var t,u=[];!e.ended();){var o=m(e);if(o.type===r.END_TAG){t=o;break}u.push(o)}return[u,t]},j=function(n){var e,t=n.curr(),u=q(n);return n.curr().type===o.EQUALS&&(n.next(),e=m(n)),{type:r.ATTRIBUTE,name:u,value:e,location:A(t,n.curr(),n.source)}},W=function(n){var e=n.curr(),t=[],u=!1;for(n.next();!n.ended();){var o=n.curr();if(o.type===e.type)break;K(n)?(u=!0,t.push(C(n))):(n.next(),t.push({type:r.STRING,value:o.value,location:A(o.pos,n.curr(),n.source)}))}n.next();var a=A(e,n.curr(),n.source);return u?{type:r.STRING_BLOCK,location:a,values:t}:{type:r.STRING,location:a,value:t.map(function(n){return n.value}).join("")}},Y=function(n){var e=n.curr();n.next();for(var t=e.value;!n.ended();){var u=n.curr();if(u.type===o.LESS_THAN||u.type==o.CLOSE_TAG||K(n))break;n.next(),t+=u.value}return{type:r.TEXT_NODE,value:t,location:A(e,n.curr(),n.source)}},X=function(n){for(;n.curr().type===o.WHITESPACE;)n.next()},q=function(n){for(var e="";n.curr().type!==o.WHITESPACE&&n.curr().type!==o.GREATER_THAN&&n.curr().type!==o.EQUALS;)e+=n.curr().value,n.next();return e};!function(n){n.TANDEM="TANDEM",n.WEB="WEB"}(n.PaperclipTargetType||(n.PaperclipTargetType={}));var J=Symbol(),z=function(n){if(n[J]&&n[J][0]===n)return n[J][1];var e=Z(n);return n[J]=[n,e],e},Z=function(n){for(var e=n.type===r.FRAGMENT?n.childNodes:[n],t=[],u=[],o=[],c=[],l=0,E=e.length;l<E;l++){var p=e[l];if(p.type===r.SELF_CLOSING_ELEMENT||p.type===r.ELEMENT){var f=p,d=i(f),T=a(f),v=s(f);if("component"===d){u.push(nn(v,T));continue}if("link"===d){t.push(tn(v));continue}if("style"===d){o.push(rn(v,T));continue}}c.push(p)}return{source:n,imports:t,components:u,globalStyles:o,unhandledExpressions:c}},nn=function(n,e){for(var t,u,o,l=[],E=0,p=n.length;E<p;E++){var f=n[E];"id"===f.name&&(t=c(f))}for(var E=0,p=e.length;E<p;E++){var d=e[E];if(d.type===r.SELF_CLOSING_ELEMENT||d.type===r.ELEMENT){var T=d,v=i(T),N=s(T),h=a(T);"style"===v?u=rn(N,h):"template"===v&&(o=en(N,h))}}return{id:t,style:u,properties:l,template:o}},en=function(n,e){return{content:e}},tn=function(n){for(var e,t,r=0,u=n.length;r<u;r++){var o=n[r];"href"===o.name?e=c(o):"type"===o.name&&(t=c(o))}return{type:t,href:e}},rn=function(n,e){return{content:e[0].value}},un=function(n,e){return t(void 0,void 0,void 0,function(){var t,r,u;return __generator(this,function(o){switch(o.label){case 0:return t={},r=sn,u=[n],[4,an(n,e)];case 1:return[2,(t.code=r.apply(void 0,u.concat([o.sent()])),t)]}})})},on=function(n){switch(n.type){case u.NOT:return"!"+on(n.value);case u.REFERENCE:return n.value;case u.GROUP:return"("+on(n.value)+")";case u.RESERVED_KEYWORD:return n.value;case u.OPERATION:var e=n,t=e.left,r=e.operator,o=e.right;return on(t)+" "+r+" "+on(o);default:throw new Error("Unable to transpile BK block "+n.type)}},an=function(n,e,r){return void 0===r&&(r={}),t(void 0,void 0,void 0,function(){var t,u,o;return __generator(this,function(a){switch(a.label){case 0:return u=z,o=$,[4,e.io.readFile(n)];case 1:return t=u.apply(void 0,[o.apply(void 0,[a.sent()])]),r[n]=t,[2,r]}})})},cn=function(n){return n.replace(/[\d-]+/g,"_")},sn=function(n,e){var t="((window) => {";t+="\n\n    const document = window.document;\n\n    const $$each = (object, iterator) => {\n      if (Array.isArray(object)) {\n        object.forEach(iterator);\n      } else {\n        for (const key in object) {\n          iterator(object[key], key);\n        }\n      }\n    };\n\n    const $$count = (object) => {\n      return Array.isArray(object) ? object.length : Object.keys(object).length;\n    }\n\n    const $$defineModule = (deps, run) => {\n      let exports;\n      return () => {\n        if (exports) return exports;\n\n        // guard from recursive dependencies\n        exports = {};\n        return exports = run((dep) => $$modules[deps[dep]]());\n      }\n    };\n\n    let updating = false;\n    let toUpdate = [];\n    \n    const $$requestUpdate = (object) => {\n      if (toUpdate.indexOf(object) === -1) {\n        toUpdate.push(object);\n      }\n      if (updating) {\n        return;\n      }\n\n      updating = true;\n      requestAnimationFrame(function() {\n        for(let i = 0; i < toUpdate.length; i++) {\n          const target = toUpdate[i];\n          target.update();\n        }\n        toUpdate = [];\n        updating = false;\n      });\n    }\n  ",t+="$$modules = {};\n";for(var r in e)t+='$$modules["'+r+'"] = '+ln(e[r])+";\n";return t+=' return {\n    entryPath: "'+n+'",\n    modules: $$modules\n  };\n  ',t+="})(window)"},ln=function(n){var e=n.source,t=(n.imports,n.globalStyles,n.components),r=n.unhandledExpressions,u={varCount:0,root:e},o="$$defineModule({}, (require) => {\n";o+="$$strays = [];\n";for(var a=Ln(r,u),i=0,c=a.length;i<c;i++){var s=a[i];o+=s.content,o+=s.bindings.map(En).join("\n"),o+="if ("+s.varName+".nodeType != null) {\n",o+="  $$strays.push("+s.varName+");\n",o+="}\n;"}for(var i=0,c=t.length;i<c;i++)o+=fn(t[i],u).content;return o+="return {\n    strays: $$strays\n  };",o+="})"},En=function(n){return"(() => {"+n+"} )();\n"},pn=function(n){return"() => { const binding = () => { "+n+" }; binding(); return binding; })()"},fn=function(n,e){var t=n.id,r=(n.style,n.template),u=n.properties,o=gn(cn(t),e);return{varName:o,bindings:[],content:"\n    class "+o+" extends HTMLElement {\n      constructor() {\n        super();\n        this.$$bidings = [];\n      }\n\n      connectedCallback() {\n        this.render();\n      }\n\n      "+u.map(function(n){var e=n.name;return"\n            get "+e+"() {\n              return this.$$"+e+";\n            }\n            set "+e+"(value) {\n              if (this.$$"+e+" === value) {\n                return;\n              }\n              const oldValue = this.$"+e+";\n              this.$$"+e+' = value;\n              this.propertyChangedCallback("'+e+'", oldValue, value);\n              if (this._rendered) {\n                $$requestUpdate(this);\n              }\n            }\n          '}).join("\n")+'\n\n      propertyChangedCallback(name, oldValue, newValue) {\n\n      }\n\n      render() {\n        if (this._rendered) {\n          return;\n        }\n        this._rendered = true;\n        const shadow = this.attachShadow({ mode: "open" });\n        '+u.map(function(n){var e=n.name,t=n.defaultValue;return"\n              if (this.$$"+e+" == null) {\n                this.$$"+e+" = "+(t||'this.getAttribute("'+e+'");')+"\n              }\n            "}).join("\n")+"\n\n        let $$bindings = [];\n        "+(r?r.content.map(function(n){var t=dn(n,e);return n?"\n            "+t.content+"\n            "+(t.bindings.length?"$$bindings = $$bindings.concat("+t.bindings.map(pn)+");":"")+"\n            shadow.appendChild("+t.varName+");\n          ":""}):"")+"\n\n        this.$$bindings = [];\n      }\n\n      cloneShallow() {\n        const clone = super.cloneShallow();\n\n        // for tandem only\n        clone._rendered = true;\n        return clone;\n      }\n\n      static get observedAttributes() {\n        return "+JSON.stringify(u.map(function(n){return n.name}))+";\n      }\n\n      attributeChangedCallback(name, oldValue, newValue) {\n        if (super.attributeChangedCallback) {\n          super.attributeChangedCallback(name, oldValue, newValue);\n        }\n        this[name] = newValue;\n      }\n\n      update() {\n        if (!this._rendered) {\n          return;\n        }\n        \n        let bindings = this.$$bindings || [];\n        "+Rn("bindings")+'\n\n        this.didUpdate();\n      }\n    }\n\n    customElements.define("'+t+'", '+o+");\n  "}},dn=function(n,e){switch(n.type){case r.FRAGMENT:return Tn(n,e);case r.TEXT_NODE:return vn(n,e);case r.BLOCK:return Nn(n,e);case r.ELEMENT:return yn(n,e);case r.SELF_CLOSING_ELEMENT:return hn(n,e)}return null},Tn=function(n,e){return mn('document.createDocumentFragment("")',e)},vn=function(n,e){return mn("document.createTextNode("+JSON.stringify(n.value.replace(/[\s\r\n\t]+/g," "))+")",e)},Nn=function(n,e){var t=mn('document.createTextNode("")',e),r=t.varName+"$$currentValue";return t.content+="let "+r+";",t.bindings.push(Sn(r,on(n.value.value),function(n){return t.varName+".nodeValue = "+n},e)),t},hn=function(n,e){return _n(n,An(n,e),e)},_n=function(n,e,t){if(!n.modifiers.length)return e;for(var o,a,i,c,s=n.modifiers,l=e,E=0,p=s.length;E<p;E++){var T=s[E].value;T.type===u.IF?o=T:T.type===u.ELSE?a=T:T.type===u.ELSEIF?i=T:T.type===u.REPEAT&&(c=T)}if(c){var N=c.each.value,h=c.asKey,_=(void 0===h?{value:"index"}:h).value,A=c.asValue.value,S=Cn(t),R=S.fragment,y=S.start,L=S.end,O=(l=R).varName+"$$currentValue",$=l.varName+"$$childBindings";l.content+="\n      let "+O+" = [];\n      let "+$+" = [];\n    ",l.bindings.push("\n      let $$newValue = ("+N+") || [];\n      if ($$newValue === "+O+") {\n        return;\n      }\n      const $$oldValue = "+O+";\n      "+O+" = $$newValue;\n\n      const $$parent = "+y.varName+".parentNode;\n      const $$startIndex = Array.prototype.indexOf.call($$parent.childNodes, "+y.varName+");\n\n      // insert\n      const $$newValueCount = $$count($$newValue);\n      const $$oldValueCount = $$count($$oldValue);\n\n      if ($$newValueCount > $$oldValueCount) {\n        for (let $$i = $$newValueCount - $$oldValueCount; $$i--;) {\n          "+e.content+"\n          $$parent.insertBefore("+e.varName+", "+L.varName+");\n          const $$bindings = ["+e.bindings.map(function(n){return"("+A+", "+_+") => {\n            "+n+"\n          }"}).join(",")+"];\n\n          "+$+".push(($$newValue, $$newKey) => {\n            "+Rn("$$bindings","$$newValue, $$newKey")+"\n          });\n        }\n\n      // delete\n      } else if ($$oldValue.length < $$newValue.length) {\n        // TODO\n      }\n\n      let i = 0;\n      // update\n      $$each($$newValue, (value, k) => {\n        "+$+"[i++](value, k);\n      });\n    "),e=l}if(o||i||a){for(var g=(o||i||a).condition,m=t.root===n||t.root.startTag===n?[t.root]:v(t.root,n).childNodes,C=m.findIndex(function(e){return e===n||n.type===r.START_TAG&&e.type===r.ELEMENT&&e.startTag===n}),b=void 0,E=C+1;E--;){var U=m[E];if(f(U,u.IF)){b="condition_"+d(U,t.root).join("");break}}var x=Cn(t),R=x.fragment,y=x.start,L=x.end,G=(l=R).varName+"$$bindings",O=l.varName+"$$currentValue";R.content+="\n      let "+G+" = [];\n      let "+O+" = false;\n\n    ",o&&(R.content+="\n        let "+b+" = Infinity;\n      "),l.bindings.push("\n      const newValue = Boolean("+(g?on(g):"true")+") && "+b+" >= "+C+";\n\n      if (newValue) {\n        "+b+" = "+C+";\n\n      // give it up for other conditions\n      } else if ("+b+" === "+C+") {\n        "+b+" = Infinity;\n      }\n        \n      if (newValue && newValue === "+O+") {\n        if ("+O+") {\n          "+Rn(G)+"\n        }\n        return;\n      }\n\n      "+O+" = newValue;\n      "+G+" = [];\n\n      if (newValue) {\n        const elementFragment = document.createDocumentFragment();\n        "+e.content+"\n        "+(e.bindings.length?G+" = "+G+".concat("+e.bindings.map(pn)+")":"")+"\n        elementFragment.appendChild("+e.varName+");\n        "+L.varName+".parentNode.insertBefore(elementFragment, "+L.varName+");\n      } else {\n        let curr = "+y.varName+".nextSibling;\n        while(curr !== "+L.varName+") {\n          curr.parentNode.removeChild(curr);\n          curr = "+y.varName+".nextSibling;\n        }\n      }\n    ")}return l},An=function(n,e){for(var t=mn('document.createElement("'+n.name+'")',e),u=0,o=n.attributes.length;u<o;u++)!function(u,o){var a=n.attributes[u],i=a.name,c=a.value,s=cn(i);if(c){if(c.type===r.STRING){var l=c;t.content+=t.varName+'.setAttribute("'+i+'", '+JSON.stringify(l.value)+");\n"}else if(c.type===r.STRING_BLOCK||c.type===r.BLOCK){var E=t.varName+"$$"+s+"$$currentValue";t.content+="let "+E+";\n";var p=void 0;p=c.type===r.STRING_BLOCK?Sn(E,c.values.map(function(n){return n.type===r.BLOCK?on(n.value.value):JSON.stringify(n.value)}).join(" + "),function(n){return t.varName+'.setAttribute("'+i+'", '+n+")"},e):Sn(E,on(c.value.value),function(n){return t.varName+"."+s+" = "+n},e),t.bindings.push(p)}}else t.content+=t.varName+"."+i+" = true;\n"}(u);return t},Sn=function(n,e,t,r){return"\n    let $$newValue = "+e+";\n    if ($$newValue !== "+n+") {\n      "+t(n+" = $$newValue")+"\n    }\n  "},Rn=function(n,e){return void 0===e&&(e=""),"\n  for (let i = 0, n = "+n+".length; i < n; i++) {\n    "+n+"[i]("+e+");\n  }\n"},yn=function(n,e){switch(n.startTag.name){case"component":return null;default:return _n(n.startTag,On(n,e),e)}},Ln=function(n,e){for(var t=[],u=0,o=n.length;u<o;u++){var a=n[u];if(a.type===r.TEXT_NODE&&/^[[\s\r\n\t]$/.test(a.value)&&u>0&&u<o-1){var i=n[u-1],c=n[u+1];if(l(i)&&l(c))continue}var s=dn(a,e);s&&t.push(s)}return t},On=function(n,e){for(var t=An(n.startTag,e),r=Ln(n.childNodes,e),u=0,o=r.length;u<o;u++){var a=r[u];t.content+=a.content,t.content+=t.varName+".appendChild("+a.varName+");\n",(i=t.bindings).push.apply(i,a.bindings)}return t;var i},$n=function(n,e,t){var r=gn(n,t);return{varName:r,bindings:[],content:e?"let "+r+" = "+e+";\n":"let "+r+";\n"}},gn=function(n,e){return n+"_"+e.varCount++},mn=function(n,e){return $n("node",n,e)},Cn=function(n){var e=mn('document.createDocumentFragment("")',n),t=mn('document.createTextNode("")',n),r=mn('document.createTextNode("")',n);return e.content+="\n  "+t.content+"\n  "+r.content+"\n  "+e.varName+".appendChild("+t.varName+");\n  "+e.varName+".appendChild("+r.varName+");\n  ",{fragment:e,start:t,end:r}};return n.parseModule=$,n.transpileToVanilla=un,n.transpileBlockExpression=on,n.loadAST=z,n}({});
