!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.paperclip={})}(this,function(e){"use strict";function n(e,n){function r(){this.constructor=e}for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,n){return n={exports:{}},e(n,n.exports),n.exports}const o=Object.assign||function(e){for(var n,r=1;r<arguments.length;r++){n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e};!function(e){e[e.STRING=0]="STRING",e[e.BLOCK=1]="BLOCK",e[e.STRING_BLOCK=2]="STRING_BLOCK",e[e.ELEMENT=3]="ELEMENT",e[e.SELF_CLOSING_ELEMENT=4]="SELF_CLOSING_ELEMENT",e[e.TEXT_NODE=5]="TEXT_NODE",e[e.COMMENT=6]="COMMENT",e[e.ATTRIBUTE=7]="ATTRIBUTE",e[e.START_TAG=8]="START_TAG",e[e.BLOCK_STRING=9]="BLOCK_STRING",e[e.FRAGMENT=10]="FRAGMENT",e[e.END_TAG=11]="END_TAG"}(e.PCExpressionType||(e.PCExpressionType={})),function(e){e.TYPE="TYPE",e.BIND="BIND",e.IF="IF",e.STRING="STRING",e.OBJECT="OBJECT",e.ARRAY="ARRAY",e.KEY_VALUE_PAIR="KEY_VALUE_PAIR",e.NUMBER="NUMBER",e.PROPERTY="PROPERTY",e.RESERVED_KEYWORD="RESERVED_KEYWORD",e.ELSEIF="ELSEIF",e.NOT="NOT",e.OPERATION="OPERATION",e.GROUP="GROUP",e.VAR_REFERENCE="VAR_REFERENCE",e.PROP_REFERENCE="PROP_REFERENCE",e.ELSE="ELSE",e.REPEAT="REPEAT"}(e.BKExpressionType||(e.BKExpressionType={})),function(e){e[e.SHEET=0]="SHEET",e[e.DECLARATION_PROPERTY=1]="DECLARATION_PROPERTY",e[e.STYLE_RULE=2]="STYLE_RULE",e[e.AT_RULE=3]="AT_RULE",e[e.IMPORT=4]="IMPORT",e[e.CHARSET=5]="CHARSET"}(e.CSSExpressionType||(e.CSSExpressionType={})),function(e){e.COLOR="COLOR",e.CALL="CALL",e.MEASUREMENT="MEASUREMENT",e.SPACED_LIST="SPACED_LIST",e.COMMA_LIST="COMMA_LIST",e.KEYWORD="KEYWORD",e.LIST="LIST"}(e.DcExpressionType||(e.DcExpressionType={}));var i,a=function(n){return n.type==e.PCExpressionType.SELF_CLOSING_ELEMENT?[]:n.childNodes},u=function(n){return n.type==e.PCExpressionType.SELF_CLOSING_ELEMENT?n.name:n.startTag.name},s=function(e){return e.value.value},c=function(e){return N(e).attributes},E=function(e){return N(e).modifiers},p=function(n){return n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.START_TAG||n.type===e.PCExpressionType.END_TAG||n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT},l=function(n,r){return h(n,function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT?r(n):n.type===e.PCExpressionType.ELEMENT&&r(n.startTag)})},T=function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||n.type==e.PCExpressionType.START_TAG?n:n.startTag},f=function(e,n){if(d(e,n)){var r=T(e).attributes.find(function(e){return e.name===n});return r&&r.value&&r.value.value}},d=function(n,r){return(n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||n.type===e.PCExpressionType.START_TAG)&&Boolean(T(n).attributes.find(function(e){return e.name===r}))},_=function(n){return h(n,function(n){return n.type===e.PCExpressionType.ELEMENT&&"style"===n.startTag.name})},v=function(n){return h(n,function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT&&"link"===n.name&&"stylesheet"===f(n,"rel")})},y=function(e){return _(e).concat(v(e))},S=function(e){return L(e,"meta")},R=function(e){var n=S(e).find(function(e){return Boolean(f(e,"name"))});return n&&f(n,"content")},C=function(e,n,r){if(void 0===r&&(r=[]),!1===n(e,r))return!1;if(e.childNodes)for(var t=e,o=0,i=t.childNodes.length;o<i;o++){var a=t.childNodes[o];if(!1===C(a,n,r.concat(["childNodes",o])))return!1}},N=function(n){return n.type===e.PCExpressionType.ELEMENT?n.startTag:n},A=function(e,n){return N(e).modifiers.find(function(e){return e.value.type===n})},O=function(e,n){var r;return C(n,function(n,t){if(n===e)return r=t,!1}),r},h=function(e,n){var r=[];return C(e,function(e){n(e)&&r.push(e)}),r},L=function(e,n){return l(e,function(e){return e.name===n})},m=function(n,r){return h(n,function(n){return n.childNodes&&n.childNodes.find(function(n){return n===r||r.type===e.PCExpressionType.START_TAG&&n.type===e.PCExpressionType.ELEMENT&&n.startTag===r})})[0]},x=function(e){var n=[];return C(e,function(e){p(e)&&-1===n.indexOf(N(e).name)&&n.push(N(e).name)}),n},P=function(e,n,r){return{type:e,pos:n,value:r}},g={},I=function(e){if(g[e])return g[e];var n=1,r=0,t={};return(e+" ").split("").forEach(function(e,o){t[o]=[r,n],"\n"===e&&(r=0,n++),r++}),g[e]=t},M=function(e,n){var r="number"==typeof e?e:e.pos,t=I(n)[r];return{column:t[0],line:t[1],pos:r}},U=function(e,n,r){return{start:e.line?e:M(e,r),end:n&&n.line?n:M(n||r.length,r)}},D=function(e,n){return U(e,e.pos+e.value.length,n)},B=function(){function e(e){this._target=e,this.pos=0,this.length=e.length}return e.prototype.curr=function(){return this._target[this.pos]},e.prototype.shift=function(){var e=this._target[this.pos];return this.next(),e},e.prototype.hasNext=function(){return this.pos<this.length-1},e.prototype.next=function(){return this._target[Math.min(this.pos=this.pos+1,this.length)]},e.prototype.prev=function(){return this._target[Math.max(this.pos=this.pos-1,0)]},e.prototype.ended=function(){return this.pos>=this.length},e}(),b=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.prototype.scan=function(e){for(var n="";this.pos<this.length;){var r=this._target[this.pos];if(!r.match(e))break;n+=r,this.pos++}return n},r.prototype.match=function(e){var n=this._target.substr(this.pos),r=n.match(e);if(r){var t=r[0];return this.pos+=n.indexOf(t)+t.length,t}return null},r.prototype.peek=function(e){return this._target.substr(this.pos,e)},r.prototype.take=function(e){var n=this._target.substr(this.pos,e);return this.pos+=e,n},r}(B),$=function(e){function r(n,r){var t=e.call(this,r)||this;return t.source=n,t}return n(r,e),r.prototype.peek=function(e){return void 0===e&&(e=1),this._target[this.pos+e]},r.prototype.peekUntil=function(e){for(var n=this.pos;n<this.length-1;)if(e(this._target[++n]))return this._target[n]},r.prototype.curr=function(){return e.prototype.curr.call(this)},r.prototype.next=function(){return e.prototype.next.call(this)},r}(B);!function(e){e[e.LESS_THAN=0]="LESS_THAN",e[e.LESS_THAN_OR_EQUAL=1]="LESS_THAN_OR_EQUAL",e[e.CLOSE_TAG=2]="CLOSE_TAG",e[e.COMMA=3]="COMMA",e[e.GREATER_THAN=4]="GREATER_THAN",e[e.GREATER_THAN_OR_EQUAL=5]="GREATER_THAN_OR_EQUAL",e[e.COMMENT=6]="COMMENT",e[e.BACKSLASH=7]="BACKSLASH",e[e.PERIOD=8]="PERIOD",e[e.BANG=9]="BANG",e[e.AND=10]="AND",e[e.OR=11]="OR",e[e.PLUS=12]="PLUS",e[e.COLON=13]="COLON",e[e.SEMICOLON=14]="SEMICOLON",e[e.MINUS=15]="MINUS",e[e.NUMBER=16]="NUMBER",e[e.AT=17]="AT",e[e.STAR=18]="STAR",e[e.PERCENT=19]="PERCENT",e[e.PAREN_OPEN=20]="PAREN_OPEN",e[e.PAREN_CLOSE=21]="PAREN_CLOSE",e[e.DOUBLE_EQUALS=22]="DOUBLE_EQUALS",e[e.TRIPPLE_EQUELS=23]="TRIPPLE_EQUELS",e[e.NOT_EQUALS=24]="NOT_EQUALS",e[e.NOT_DOUBLE_EQUALS=25]="NOT_DOUBLE_EQUALS",e[e.BRACKET_OPEN=26]="BRACKET_OPEN",e[e.BRACKET_CLOSE=27]="BRACKET_CLOSE",e[e.CURLY_BRACKET_OPEN=28]="CURLY_BRACKET_OPEN",e[e.CURLY_BRACKET_CLOSE=29]="CURLY_BRACKET_CLOSE",e[e.EQUALS=30]="EQUALS",e[e.SINGLE_QUOTE=31]="SINGLE_QUOTE",e[e.HASH=32]="HASH",e[e.DOUBLE_QUOTE=33]="DOUBLE_QUOTE",e[e.TEXT=34]="TEXT",e[e.RESERVED_KEYWORD=35]="RESERVED_KEYWORD",e[e.WHITESPACE=36]="WHITESPACE"}(i||(i={}));var K=function(e){for(var n=new b(e),r=[];!n.ended();){var t=n.curr(),o=void 0;if("<"===t)if("</"===n.peek(2))o=P(i.CLOSE_TAG,n.pos,n.take(2));else if("\x3c!--"===n.peek(4)){for(var a=n.take(4);!n.ended();){var u=n.curr();if("-"===u&&"--\x3e"===n.peek(3)){a+=n.take(3);break}n.next(),a+=u}o=P(i.COMMENT,n.pos,a)}else o="<="===n.peek(2)?P(i.LESS_THAN_OR_EQUAL,n.pos,n.take(2)):P(i.LESS_THAN,n.pos,n.shift());else if("&"===t&&"&&"===n.peek(2))o=P(i.AND,n.pos,n.take(2));else if("|"===t&&"||"===n.peek(2))o=P(i.OR,n.pos,n.take(2));else if(">"===t)o=">="===n.peek(2)?P(i.GREATER_THAN_OR_EQUAL,n.pos,n.take(2)):P(i.GREATER_THAN,n.pos,n.shift());else if("="===t)o="==="===n.peek(3)?P(i.TRIPPLE_EQUELS,n.pos,n.take(3)):"=="===n.peek(2)?P(i.DOUBLE_EQUALS,n.pos,n.take(2)):P(i.EQUALS,n.pos,n.shift());else if(":"===t)o=P(i.COLON,n.pos,n.shift());else if(";"===t)o=P(i.SEMICOLON,n.pos,n.shift());else if("@"===t)o=P(i.AT,n.pos,n.shift());else if(","===t)o=P(i.COMMA,n.pos,n.shift());else if("'"===t)o=P(i.SINGLE_QUOTE,n.pos,n.shift());else if("#"===t)o=P(i.HASH,n.pos,n.shift());else if("!"===t)o="!=="===n.peek(3)?P(i.NOT_DOUBLE_EQUALS,n.pos,n.take(3)):"!="===n.peek(2)?P(i.NOT_EQUALS,n.pos,n.take(2)):P(i.BANG,n.pos,n.shift());else if("/"===t){if("/*"===n.peek(2)){n.match(/.*?\*\//);continue}o=P(i.BACKSLASH,n.pos,n.shift())}else if("."===t)o=/\.\d/.test(n.peek(2))?Y(n):P(i.PERIOD,n.pos,n.shift());else if('"'===t)o=P(i.DOUBLE_QUOTE,n.pos,n.shift());else if("+"===t)o=P(i.PLUS,n.pos,n.shift());else if("-"===t)o=/\-\d/.test(n.peek(2))?Y(n):P(i.MINUS,n.pos,n.shift());else if("*"===t)o=P(i.STAR,n.pos,n.shift());else if("%"===t)o=P(i.PERCENT,n.pos,n.shift());else if("["===t)o=P(i.BRACKET_OPEN,n.pos,n.shift());else if("]"===t)o=P(i.BRACKET_CLOSE,n.pos,n.shift());else if("("===t)o=P(i.PAREN_OPEN,n.pos,n.shift());else if(")"===t)o=P(i.PAREN_CLOSE,n.pos,n.shift());else if("{"===t)o=P(i.CURLY_BRACKET_OPEN,n.pos,n.shift());else if("}"===t)o=P(i.CURLY_BRACKET_CLOSE,n.pos,n.shift());else if(/\d/.test(t))o=Y(n);else if(/[\s\r\n\t]/.test(t))o=P(i.WHITESPACE,n.pos,n.scan(/[\s\r\n\t]/));else{var s=n.pos,c=n.scan(/[^-<>,='":@;\.\/\\(){}\[\]\s\r\n\t]/)||n.shift();o=P("undefined"===c?i.RESERVED_KEYWORD:i.TEXT,s,c)}r.push(o)}return new $(e,r)},Y=function(e){return P(i.NUMBER,e.pos,e.match(/^\-?(\d+(\.\d+)?|\.\d+)/))},V={},w=function(e,n){if(V[e])return V[e];var r={source:e,filePath:n,scanner:K(e),diagnostics:[]},t=H(r);return V[e]={root:t,diagnostics:r.diagnostics}},G=function(e,n){if(V[e])return V[e];var r={source:e,scanner:K(e),filePath:n,diagnostics:[]},t=fe(r);return V[e]={root:t,diagnostics:r.diagnostics}},H=function(n){for(var r=n.scanner,t=[];!r.ended();){var o=k(n);if(!o)return null;t.push(o)}return 1===t.length?t[0]:{type:e.PCExpressionType.FRAGMENT,location:U(0,r.source.length,r.source),childNodes:t}},k=function(e){if(!ge(e))return null;var n=e.scanner;switch(n.curr().type){case i.WHITESPACE:return he(e);case i.LESS_THAN:return Se(e);case i.CLOSE_TAG:return ye(e);case i.COMMENT:return le(e);default:return Te(n)?F(e,Q):he(e)}},F=function(n,r){var t=n.scanner,o=t.curr();t.next(),t.next(),Le(n);var a=r(n);return a?(Le(n),Ie(n,[i.BRACKET_CLOSE],null,U(o,t.curr(),n.source))?(t.next(),Ie(n,[i.BRACKET_CLOSE],"Missing closing ] character.",D(o,n.source))?(t.next(),{type:e.PCExpressionType.BLOCK,location:U(o,t.curr(),t.source),value:a}):null):null):null},j=function(n){var r=n.scanner;switch(r.curr().value){case"bind":return ie(n);case"repeat":return se(n);case"if":return ue(n,e.BKExpressionType.IF);case"elseif":return ue(n,e.BKExpressionType.ELSEIF);case"else":return ue(n,e.BKExpressionType.ELSE);case"property":return ae(n,e.BKExpressionType.PROPERTY);default:return Pe(n,"Unexpected block type "+r.curr().value+"."),null}},Q=function(e){var n=e.scanner;switch(n.curr().value){case"bind":return ie(e);case"elseif":case"else":case"if":return Pe(e,"Condition blocks can only be added to elements, for example: <div [[if condition]]></div>."),null;case"repeat":return Pe(e,"Repeat blocks can only be added to elements, for example: <div [[repeat items in item, i]]></div>."),null;default:return Pe(e,"Unexpected block type "+n.curr().value+"."),null}},X=function(e){var n=e.scanner;switch(n.curr().value){case"bind":return ie(e);case"elseif":case"else":case"if":return Pe(e,"Condition blocks cannot be assigned to attributes."),null;case"repeat":return Pe(e,"Repeat blocks cannot be assigned to attributes."),null;default:return Pe(e,"Unexpected block type "+n.curr().value+"."),null}},W=function(e){return J(e)},J=function(n){if(!ge(n))return null;var r=n.scanner,t=q(n);Le(n);var o=r.curr(),a=o?o.type:-1;if(!(a===i.AND||a===i.OR||a==i.PLUS||a===i.MINUS||a===i.STAR||a===i.BACKSLASH||a===i.DOUBLE_EQUALS||a===i.TRIPPLE_EQUELS||a===i.GREATER_THAN||a===i.LESS_THAN||a===i.LESS_THAN_OR_EQUAL||a===i.GREATER_THAN_OR_EQUAL||a===i.NOT_EQUALS||a===i.NOT_DOUBLE_EQUALS))return t;r.next(),Le(n);var u=J(n);return u?{type:e.BKExpressionType.OPERATION,left:t,right:u,operator:o.value,location:U(t.location.start,u.location.end,r.source)}:null},q=function(e){var n=e.scanner;switch(Le(e),n.curr().type){case i.BANG:return pe(e);case i.SINGLE_QUOTE:case i.DOUBLE_QUOTE:return z(e);case i.NUMBER:return Z(e);case i.CURLY_BRACKET_OPEN:return ee(e);case i.BRACKET_OPEN:return ne(e);case i.PAREN_OPEN:return te(e);case i.TEXT:return ce(e);case i.RESERVED_KEYWORD:return oe(e);default:return Pe(e),null}},z=function(n){var r=n.scanner,t=r.curr();r.next();for(var o="";!r.ended();){var i=r.curr();if(i.value===t.value)break;"\\"!==i.value?(o+=i.value,r.next()):(o+=r.next().value,r.next())}return Ae(n,t)?(r.next(),{type:e.BKExpressionType.STRING,location:U(t,r.curr(),r.source),value:o}):null},Z=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.NUMBER,value:t.value,location:U(t,r.curr(),r.source)}},ee=function(n){var r=n.scanner,t=r.curr();r.next();for(var o=[];!r.ended()&&(Le(n),r.curr().type!==i.CURLY_BRACKET_CLOSE);){var a=re(n);if(!a)return null;o.push(a),Le(n);var u=r.curr();if(u.type!==i.CURLY_BRACKET_CLOSE){if(u.type!==i.COMMA&&u)return Pe(n),null;r.next()}}return r.next(),{type:e.BKExpressionType.OBJECT,location:U(t,r.curr(),r.source),properties:o}},ne=function(n){var r=n.scanner,t=r.curr();r.next(),Le(n);var o=[];if(r.curr().type!==i.BRACKET_CLOSE)for(;;){if(o.push(q(n)),Le(n),r.curr().type===i.BRACKET_CLOSE)break;if(!Ie(n,[i.COMMA],"Missing , delimiter in array.",U(t,r.curr(),n.source)))return null;r.next()}return r.next(),{type:e.BKExpressionType.ARRAY,location:U(t,r.curr(),r.source),values:o}},re=function(n){var r,t=n.scanner;switch(t.curr().type){case i.SINGLE_QUOTE:case i.DOUBLE_QUOTE:r=z(n);break;default:r=Ee(n)}if(Le(n),!Ie(n,[i.COLON],"Missing : for object."))return null;t.next(),Le(n);var o=W(n);return{type:e.BKExpressionType.KEY_VALUE_PAIR,location:U(r.location.start,o.location.end,t.source),key:r.name,value:o}},te=function(n){var r=n.scanner,t=r.curr();r.next();var o=W(n);return r.next(),{type:e.BKExpressionType.GROUP,value:o,location:U(t,r.curr(),r.source)}},oe=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.RESERVED_KEYWORD,value:t.value,location:U(t,r.curr(),r.source)}},ie=function(n){var r=n.scanner,t=r.curr();r.next(),r.next();var o=W(n);return o?{type:e.BKExpressionType.BIND,value:o,location:U(t,r.curr(),r.source)}:null},ae=function(e,n){var r=e.scanner,t=r.curr();return r.next(),r.next(),{type:n,name:Ee(e).name,location:U(t,r.curr(),r.source)}},ue=function(e,n){var r=e.scanner,t=r.curr();return r.next(),Le(e),{type:n,condition:r.curr().type!==i.BRACKET_CLOSE?W(e):null,location:U(t,r.curr(),r.source)}},se=function(n){var r=n.scanner,t=r.curr();if(r.next(),Le(n),!Ie(n,[i.TEXT],"Repeat block missing collection parameter.",D(t,n.source)))return null;var o=W(n);if(Le(n),!Ie(n,[i.TEXT],null,U(t,r.curr(),n.source)))return null;if("as"!==r.curr().value)return Pe(n,'Repeat block missing "as" keyword.',U(t,r.curr(),n.source)),null;if(r.next(),Le(n),!Ie(n,[i.TEXT],null,U(t,r.curr(),n.source)))return null;var a,u=Ee(n);if(Le(n),","===r.curr().value){if(r.next(),Le(n),!Ie(n,[i.TEXT],"Unexpected token. Repeat index parameter should only contain characters a-zA-Z.",U(t,r.curr(),n.source)))return null;a=Ee(n)}return{type:e.BKExpressionType.REPEAT,location:U(t,r.curr(),r.source),each:o,asKey:a,asValue:u}},ce=function(n){for(var r=n.scanner,t=Ee(n),o=[t];!r.ended()&&r.curr().type===i.PERIOD;){if(r.next(),!Ie(n,[i.TEXT]))return null;o.push(Ee(n))}return 1===o.length?o[0]:{type:e.BKExpressionType.PROP_REFERENCE,path:o,location:U(t.location.start,r.curr(),r.source)}},Ee=function(n){var r=n.scanner;Le(n);var t=r.curr();return r.next(),{type:e.BKExpressionType.VAR_REFERENCE,name:t.value,location:U(t,r.curr(),r.source)}},pe=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.NOT,value:q(n),location:U(t,r.curr(),r.source)}},le=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.PCExpressionType.COMMENT,value:t.value.substr(4,t.value.length-7),location:U(t,r.curr(),r.source)}},Te=function(e){return e.curr().type===i.BRACKET_OPEN&&e.peek(1).type===i.BRACKET_OPEN},fe=function(n){for(var r=n.scanner,t=r.curr(),o=[];;){if(Le(n),r.ended()||r.curr().type===i.CLOSE_TAG)break;var a=de(n);if(!a)return null;o.push(a)}return{type:e.CSSExpressionType.SHEET,children:o,location:U(t,r.curr(),r.source)}},de=function(e){switch(e.scanner.curr().type){case i.AT:return _e(e);default:return ve(e)}},_e=function(n){var r=n.scanner,t=r.curr();r.next();for(var o="";r.curr().type!==i.WHITESPACE&&r.curr().type!==i.CURLY_BRACKET_OPEN;)o+=r.curr().value,r.next();r.next();var a=[],u=[];for(Le(n);!r.ended()&&(Le(n),r.curr().type!==i.CURLY_BRACKET_OPEN&&r.curr().type!==i.SEMICOLON);)r.curr().type===i.SINGLE_QUOTE||r.curr().type===i.DOUBLE_QUOTE?a.push(z(n).value):(a.push(r.curr().value),r.next());var s=r.curr();if(r.next(),s.type===i.CURLY_BRACKET_OPEN){for(;!r.ended()&&(Le(n),r.curr().type!==i.CURLY_BRACKET_CLOSE);){var c=de(n);if(!c)return null;u.push(c)}if(!Ie(n,[i.CURLY_BRACKET_CLOSE],"Missing closing } character.",D(t,n.source)))return null;r.next()}return{type:e.CSSExpressionType.AT_RULE,name:o,params:a,children:u,location:U(t,r.curr(),r.source)}},ve=function(n){for(var r=n.scanner,t=r.curr(),o="";!r.ended();){var a=r.curr();if(a.type==i.CURLY_BRACKET_OPEN||a.type===i.SEMICOLON||a.type===i.CURLY_BRACKET_CLOSE||a.type===i.CLOSE_TAG)break;a.type===i.SINGLE_QUOTE||a.type===i.DOUBLE_QUOTE?o+=a.value+z(n).value+a.value:(o+=a.value,r.next())}if(!Ie(n,[i.SEMICOLON,i.CURLY_BRACKET_OPEN,i.CURLY_BRACKET_CLOSE]))return null;if(r.curr().type===i.SEMICOLON||r.curr().type===i.CURLY_BRACKET_CLOSE){var u=o.match(/(.+?):(.+)/),s=(u[0],u[1]),c=u[2];return r.curr().type===i.SEMICOLON&&r.next(),{type:e.CSSExpressionType.DECLARATION_PROPERTY,location:U(t,r.curr(),r.source),name:s,value:c}}r.next();var E=[];for(Le(n);!r.ended()&&r.curr().type!==i.CURLY_BRACKET_CLOSE;){var p=ve(n);if(!p)return null;E.push(p),Le(n)}return Ie(n,[i.CURLY_BRACKET_CLOSE],"Missing closing } character.",D(t,n.source))?(r.next(),o=o.trim(),{type:e.CSSExpressionType.STYLE_RULE,children:E,selectorText:o,location:U(t,r.curr(),r.source)}):null},ye=function(n){var r=n.scanner,t=r.curr();r.next();var o=me(n);return o?Ie(n,[i.GREATER_THAN],"Missing > character.",U(t,r.curr(),n.source))?(r.next(),{type:e.PCExpressionType.END_TAG,name:o,location:U(t,r.curr(),r.source)}):null:(Pe(n,"Missing close tag name.",D(t,n.source)),null)},Se=function(n){var r=n.scanner,t=r.curr();r.next();var o=me(n);if(!o)return Pe(n,"Missing open tag name.",D(t,n.source)),null;if(!r.ended()&&!Ie(n,[i.WHITESPACE,i.GREATER_THAN],'Tag name contains a character where " " or > is expected.',D(t,n.source)))return null;for(var a=[],u=[];!r.ended();){Le(n);var s=r.curr();if(s.type===i.BACKSLASH||s.type==i.GREATER_THAN)break;if(Te(r)){var c=F(n,j);if(!c)return null;u.push(c)}else{if(s.type!==i.TEXT)return Pe(n),null;var E=Ce(n);if(!E)return null;a.push(E)}}if(!ge(n))return null;if(r.curr().type===i.BACKSLASH)return r.next(),r.next(),{type:e.PCExpressionType.SELF_CLOSING_ELEMENT,name:o,attributes:a,modifiers:u,location:U(t,r.curr(),r.source)};r.next();var p=r.curr(),l=Re(o,n);if(!l)return null;var T=l[0],f=l[1];return f?{type:e.PCExpressionType.ELEMENT,startTag:{name:o,type:e.PCExpressionType.START_TAG,location:U(t,p,r.source),modifiers:u,attributes:a},childNodes:T,location:U(t,r.curr(),r.source),endTag:f}:(Pe(n,"Close tag is missing.",U(t,p,n.source)),null)},Re=function(n,r){var t=r.scanner,o=[];if("style"===n){var a=fe(r);if(!a)return null;if(Le(r),!Ie(r,[i.CLOSE_TAG]))return null;var u=ye(r);return u?[[a],u]:null}if("style"===n||"script"===n){for(var s="",c=t.curr();!t.ended()&&t.curr().type!==i.CLOSE_TAG;)s+=t.curr().value,t.next();return[[{type:e.PCExpressionType.TEXT_NODE,value:s,location:U(c,t.curr(),t.source)}],k(r)]}for(var E;!t.ended();){var p=k(r);if(!p)return null;if(p.type===e.PCExpressionType.END_TAG){E=p;break}o.push(p)}return[o,E]},Ce=function(n){var r,t=n.scanner,o=t.curr(),a=me(n);return t.curr().type!==i.EQUALS||(t.next(),r=Ne(n))?{type:e.PCExpressionType.ATTRIBUTE,name:a,value:r,location:U(o,t.curr(),t.source)}:null},Ne=function(e){if(!ge(e))return null;var n=e.scanner;switch(n.curr().type){case i.SINGLE_QUOTE:case i.DOUBLE_QUOTE:return Oe(e);default:return Te(n)?F(e,X):(Pe(e),null)}},Ae=function(e,n){return Ie(e,[n.type],"Missing closing "+n.value+" character.",D(n,e.source))},Oe=function(n){var r=n.scanner,t=r.curr(),o=[],i=!1;for(r.next();!r.ended();){var a=r.curr();if(a.type===t.type)break;if(Te(r)){i=!0;var u=F(n,X);if(!u)return null;o.push(u)}else r.next(),o.push({type:e.PCExpressionType.STRING,value:a.value,location:U(a.pos,r.curr(),r.source)})}if(!Ae(n,t))return null;r.next();var s=U(t,r.curr(),r.source);return i?{type:e.PCExpressionType.STRING_BLOCK,location:s,values:o}:{type:e.PCExpressionType.STRING,location:s,value:o.map(function(e){return e.value}).join("")}},he=function(n){var r=n.scanner,t=r.curr();r.next();for(var o=t.value;!r.ended();){var a=r.curr();if(a.type===i.COMMENT||a.type===i.LESS_THAN||a.type==i.CLOSE_TAG||Te(r))break;r.next(),o+=a.value}return{type:e.PCExpressionType.TEXT_NODE,value:o,location:U(t,r.curr(),r.source)}},Le=function(e){for(var n=e.scanner;!n.ended()&&n.curr().type===i.WHITESPACE;)n.next()},me=function(e){for(var n=e.scanner,r="";!n.ended()&&/[a-zA-Z-][a-zA-Z0-9-]*/.test(n.curr().value);)r+=n.curr().value,n.next();return r||null},xe=function(e,n){if(!n)throw new Error("Unexpected end of file (missing closing expression).");var r=M(n,e);throw new Error('Unexpected token "'+n.value+'" at '+r.line+":"+r.column)},Pe=function(e,n,r){var t=e.scanner.curr(),o=r||{start:M(t||e.scanner.source.length-1,e.scanner.source),end:M(t?t.pos+t.value.length:e.scanner.source.length,e.scanner.source)};return e.diagnostics.push({location:o,message:n||(t?"Unexpected token.":"Unexpected end of file."),source:e.source,filePath:e.filePath}),!0},ge=function(e,n,r){return!!e.scanner.curr()||(Pe(e,n,r),!1)},Ie=function(e,n,r,t){var o=e.scanner.curr();return!(!o||-1===n.indexOf(o.type))||(Pe(e,r,t),!1)};!function(e){e.TANDEM="TANDEM",e.WEB="WEB"}(e.PaperclipTargetType||(e.PaperclipTargetType={}));var Me=Symbol(),Ue=function(e,n){if(e[Me]&&e[Me][0]===e)return e[Me][1];var r=Ge(e,n);return e[Me]=[e,r],r},De=function(e,n){var r=n.split("/");r.pop();var t=(e=e.replace("./","")).split("../"),o=t.pop();return r.splice(r.length-t.length,r.length),r.join("/")+"/"+o},Be=function(e,n){var r={};return x(e).forEach(function(e){var t=Ve(e,n);t&&(r[e]=t)}),r},be=function(e,n){var r={};return e.module.components.forEach(function(e){Object.assign(r,Be(e.template,n))}),r},$e=function(e,n){return n.components.find(function(n){return n.id===e})},Ke=function(e,n){var r=[],t=(be(e,n),be(e,n));for(var o in t){var i=t[o];-1===r.indexOf(i)&&r.push(i)}return r},Ye=function(e,n){var r=e.resolvedImportUris,t=[];for(var o in r)t.push(n[r[o]]);return t},Ve=function(e,n){for(var r in n)for(var t=n[r],o=0,i=t.module.components.length;o<i;o++)if(t.module.components[o].id===e)return t},we=function(e,n,r){var t=n.readFile,o=n.resolveFile,i=void 0===o?De:o;return void 0===r&&(r={}),r[e]?Promise.resolve(r):Promise.resolve(t(e)).then(w).then(function(n){return n.diagnostics.length&&console.log(n.diagnostics),Ue(n.root,e)}).then(function(n){var o={};return r[e]={module:n,resolvedImportUris:o},n.imports.length?Promise.all(n.imports.map(function(n){return Promise.resolve(i(n.href,e)).then(function(e){return o[n.href]=e,we(e,{readFile:t,resolveFile:i},r)})})).then(function(){return r}):Promise.resolve(r)}).catch(function(n){throw console.error("Error in "+e),n})},Ge=function(n,r){for(var t=n.type===e.PCExpressionType.FRAGMENT?n.childNodes:[n],o=[],i=[],s=[],p=[],l=0,T=t.length;l<T;l++){var f=t[l];if(f.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||f.type===e.PCExpressionType.ELEMENT){var d=f,_=u(d),v=a(d),y=c(d),S=E(d);if("component"===_&&d.type===e.PCExpressionType.ELEMENT){i.push(je(d,S,y,v));continue}if("link"===_){o.push(Qe(y));continue}if("style"===_){s.push(d);continue}}p.push(f)}return{source:n,uri:r,imports:o,components:i,globalStyles:s,unhandledExpressions:p}},He=function(e){for(var n={},r=0,t=e.split(/,\s+/g);r<t.length;r++){var o=t[r].split("="),i=o[0],a=o[1];n[i]=a}return n},ke=function(e,n){return e.metadata.filter(function(e){return e.name===n})},Fe=function(e,n){return ke(e,n).shift()},je=function(n,r,t,o){for(var i,E,p,l=[],T=r.map(function(e){return e.value}).filter(function(n){return n.type===e.BKExpressionType.PROPERTY}),d=0,_=t.length;d<_;d++){var v=t[d];"id"===v.name&&(i=s(v))}for(var d=0,_=o.length;d<_;d++){var y=o[d];if(y.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||y.type===e.PCExpressionType.ELEMENT){var S=y,R=u(S);c(S),a(S);"style"===R?E=S:"template"===R?p=S:"meta"===R&&l.push({name:f(S,"name"),params:He(f(S,"content")||"")})}}return{source:n,id:i,style:E,metadata:l,properties:T,template:p}},Qe=function(e){for(var n,r,t=0,o=e.length;t<o;t++){var i=e[t];"href"===i.name?n=s(i):"type"===i.name&&(r=s(i))}return{type:r,href:n}},Xe=function(e,n){return we(e,n.io).then(function(n){return{code:qe(e,n),graph:n,entryDependency:n[e]}})},We=function(n){switch(n.type){case e.BKExpressionType.NOT:return"!"+We(n.value);case e.BKExpressionType.PROP_REFERENCE:return(t=n).path.map(We).join(".");case e.BKExpressionType.STRING:var r=n;return JSON.stringify(r.value);case e.BKExpressionType.NUMBER:return n.value;case e.BKExpressionType.VAR_REFERENCE:var t=n;return t.name;case e.BKExpressionType.ARRAY:return"["+n.values.map(We)+"]";case e.BKExpressionType.OBJECT:for(var o=n,i="{",a=0,u=o.properties.length;a<u;a++){var s=o.properties[a];i+=s.key+":"+We(s.value)+", "}return i+="}";case e.BKExpressionType.GROUP:return"("+We(n.value)+")";case e.BKExpressionType.RESERVED_KEYWORD:return n.value;case e.BKExpressionType.OPERATION:var c=n,E=c.left,p=c.operator,l=c.right;return We(E)+" "+p+" "+We(l);default:throw new Error("Unable to transpile BK block "+n.type)}},Je=function(e){return e.replace(/[\d-]+/g,"_")},qe=function(e,n){var r="((window) => {";r+='var document = window.document;const $$each = (object, iterator) => {if (Array.isArray(object)) {object.forEach(iterator);} else {for (const key in object) {iterator(object[key], key);}}};const $$count = (object) => {return Array.isArray(object) ? object.length : Object.keys(object).length;};const $$defineModule = (run) => {let exports;return () => {if (exports) return exports;exports = {};return exports = run((dep) => {return $$modules[dep]()});}};const $$setElementProperty = (element, property, value) => {if (property === "style" && typeof value !== "string") {\nelement.style = "";\nObject.assign(element.style, value);\n} else {\nelement[property] = value;}\n};let updating = false;let toUpdate = [];const $$requestUpdate = (object) => {if (toUpdate.indexOf(object) === -1) {toUpdate.push(object);}if (updating) {return;}updating = true;requestAnimationFrame(function() {for(let i = 0; i < toUpdate.length; i++) {const target = toUpdate[i];target.update();}toUpdate = [];updating = false;});};',r+="$$modules = {};";for(var t in n)r+='$$modules["'+t+'"] = '+ze(n[t].module,n[t].resolvedImportUris)+";";return r+='const entry = $$modules["'+e+'"]();',r+="return {entry,modules: $$modules};})(window)"},ze=function(e,n){for(var r=e.source,t=e.imports,o=e.globalStyles,i=e.components,a=(e.unhandledExpressions,{uri:e.uri,varCount:0,root:r}),u="$$defineModule((require) => {",s=gn(o,a),c=0,E=s.length;c<E;c++)u+=(l=s[c]).content,u+="document.body.appendChild("+l.varName+");";for(var c=0,E=t.length;c<E;c++){var p=t[c],l=Mn("import","require("+JSON.stringify(n[p.href])+")",a);u+=l.content}for(var c=0,E=i.length;c<E;c++)u+=en(i[c],a).content;return u+="return {};",u+="})"},Ze=function(e){return"(() => { const binding = () => { "+e+" }; binding(); return binding; })()"},en=function(e,n){var r=e.id,t=e.style,i=e.template,a=e.properties,u=Un(Je(r),n),s=o({},n,{varCount:0,contextName:"this"}),c=t&&ln(t,s);return{varName:u,bindings:[],content:"class "+u+" extends HTMLElement {constructor() {super();this.$$bindings = [];}connectedCallback() {this.render();}"+a.map(function(e){var n=e.name;return"get "+n+"() {return this.$$"+n+";}set "+n+"(value) {if (this.$$"+n+" === value || String(this.$$"+n+") === String(value)) {return;}const oldValue = this.$"+n+";this.$$"+n+' = value;if (typeof value !== "object") {this.setAttribute('+JSON.stringify(n)+", value);}if (this._rendered) {$$requestUpdate(this);}}"}).join("\n")+'render() {if (this._rendered) {return;}this._rendered = true;const shadow = this.attachShadow({ mode: "open" });'+(c?c.content+"shadow.appendChild("+c.varName+");":"")+a.map(function(e){var n=e.name,r=e.defaultValue;return"if (this.$$"+n+" == null) {this.$$"+n+" = "+(r||'this.getAttribute("'+n+'");')+"}"}).join("\n")+"let $$bindings = [];"+(i?i.childNodes.map(function(e){var n=nn(e,s);return e&&n?n.content+(n.bindings.length?"$$bindings = $$bindings.concat("+n.bindings.map(function(e){return"(() => {const $$binding = () => {const { "+a.map(function(e){return e.name}).join(",")+" } = this;"+e+"};$$binding();return $$binding;})()"})+");":"")+"shadow.appendChild("+n.varName+");":""}).join(""):"")+"this.$$bindings = $$bindings;}cloneShallow() {const clone = super.cloneShallow();clone._rendered = true;return clone;}static get observedAttributes() {return "+JSON.stringify(a.map(function(e){return e.name}))+";}attributeChangedCallback(name, oldValue, newValue) {if (super.attributeChangedCallback) {super.attributeChangedCallback(name, oldValue, newValue);}this[name] = newValue;}update() {if (!this._rendered) {return;}let bindings = this.$$bindings || [];"+En("bindings")+'}}if (!customElements.get("'+r+'")) {customElements.define("'+r+'", '+u+');} else {console.error("Custom element \\"'+r+'\\" is already defined, ignoring");}'}},nn=function(n,r){switch(n.type){case e.PCExpressionType.FRAGMENT:return rn(n,r);case e.PCExpressionType.TEXT_NODE:return tn(n,r);case e.PCExpressionType.BLOCK:return on(n,r);case e.PCExpressionType.ELEMENT:return pn(n,r);case e.PCExpressionType.SELF_CLOSING_ELEMENT:return an(n,r)}return null},rn=function(e,n){return Dn('document.createDocumentFragment("")',n)},tn=function(e,n){return $n(Dn("document.createTextNode("+JSON.stringify(e.value.replace(/[\s\r\n\t]+/g," "))+")",n),e,n)},on=function(e,n){var r=Dn('document.createTextNode("")',n),t=(r=$n(r,e,n)).varName+"$$currentValue";return r.content+="let "+t+";",r.bindings.push(cn(t,We(e.value.value),function(e){return r.varName+".nodeValue = "+e},n)),r},an=function(e,n){return un(e,$n(sn(e,n),e,n),n)},un=function(n,r,t){if(!n.modifiers.length)return r;for(var o,i,a,u,s,c=n.modifiers,E=r,l=0,T=c.length;l<T;l++)(M=c[l].value).type===e.BKExpressionType.IF?o=M:M.type===e.BKExpressionType.ELSE?i=M:M.type===e.BKExpressionType.ELSEIF?a=M:M.type===e.BKExpressionType.REPEAT?u=M:M.type===e.BKExpressionType.BIND&&(s=M);if(s){var f=s.value,d=(E={varName:r.varName,content:r.content,bindings:r.bindings.slice()}).varName+"$$spreadValue",_=We(f);E.content+="let "+d+";",E.bindings.push(cn(d,_,function(e){return"for (const $$key in "+d+") {$$setElementProperty("+r.varName+", $$key, "+d+"[$$key]);}"},t)),r=E}if(u){var v=u.each,y=u.asKey,S=u.asValue,R=We(v),C=y?We(y):"index",N=We(S),h=bn(t),L=h.fragment,x=h.start,P=h.end,g=(E=L).varName+"$$currentValue",I=E.varName+"$$childBindings";E.content+="let "+g+" = [];let "+I+" = [];",E.bindings.push("let $$newValue = ("+R+") || [];if ($$newValue === "+g+") {return;}const $$oldValue = "+g+";"+g+" = $$newValue;const $$parent = "+x.varName+".parentNode;const $$startIndex = Array.prototype.indexOf.call($$parent.childNodes, "+x.varName+"); const $$newValueCount = $$count($$newValue);const $$oldValueCount = $$count($$oldValue);if ($$newValueCount > $$oldValueCount) {for (let $$i = $$newValueCount - $$oldValueCount; $$i--;) {"+r.content+"$$parent.insertBefore("+r.varName+", "+P.varName+");const $$bindings = ["+r.bindings.map(function(e){return"("+N+", "+C+") => { "+e+"}"}).join(",")+"];"+I+".push(($$newValue, $$newKey) => {"+En("$$bindings","$$newValue, $$newKey")+"});}} else if ($$oldValue.length < $$newValue.length) {}let i = 0;$$each($$newValue, (value, k) => {"+I+"[i++](value, k);});"),r=E}if(o||a||i){for(var M=o||a||i,U=M.condition,D=t.root===n||t.root.startTag===n?[t.root]:m(t.root,n).childNodes,B=D.findIndex(function(r){return r===n||n.type===e.PCExpressionType.START_TAG&&r.type===e.PCExpressionType.ELEMENT&&r.startTag===n}),b=void 0,l=B+1;l--;){var $=D[l];if(p($)&&A($,e.BKExpressionType.IF)){b="condition_"+O($,t.root).join("");break}}if(!b)throw new Error("Element condition "+e.BKExpressionType[M.type]+" defined without an IF block.");var K=bn(t),L=K.fragment,x=K.start,P=K.end,Y=(E=L).varName+"$$bindings",g=E.varName+"$$currentValue";L.content+="let "+Y+" = [];let "+g+" = false;",o&&(L.content+="let "+b+" = Infinity;"),E.bindings.push("const newValue = Boolean("+(U?We(U):"true")+") && "+b+" >= "+B+";if (newValue) {"+b+" = "+B+";} else if ("+b+" === "+B+") {"+b+" = Infinity;}if (newValue && newValue === "+g+") {if ("+g+") {"+En(Y)+"}return;}"+g+" = newValue;"+Y+" = [];if (newValue) {const elementFragment = document.createDocumentFragment();"+r.content+(r.bindings.length?Y+" = "+Y+".concat("+r.bindings.map(Ze)+");":"")+"elementFragment.appendChild("+r.varName+");"+P.varName+".parentNode.insertBefore(elementFragment, "+P.varName+");} else {let curr = "+x.varName+".nextSibling;while(curr !== "+P.varName+") {curr.parentNode.removeChild(curr);curr = "+x.varName+".nextSibling;}}")}return E},sn=function(n,r){for(var t=Dn('document.createElement("'+n.name+'")',r),o=0,i=n.attributes.length;o<i;o++)!function(o,i){var a=n.attributes[o],u=a.name,s=a.value,c=Je(u);if(s){if(s.type===e.PCExpressionType.STRING){var E=s;t.content+=t.varName+'.setAttribute("'+u+'", '+JSON.stringify(E.value)+");\n"}else if(s.type===e.PCExpressionType.STRING_BLOCK||s.type===e.PCExpressionType.BLOCK){var p=t.varName+"$$"+c+"$$currentValue";t.content+="let "+p+";\n";var l=void 0;l=s.type===e.PCExpressionType.STRING_BLOCK?cn(p,s.values.map(function(n){return n.type===e.PCExpressionType.BLOCK?We(n.value.value):JSON.stringify(n.value)}).join(" + "),function(e){return t.varName+'.setAttribute("'+u+'", '+e+")"},r):cn(p,We(s.value.value),function(e){return"$$setElementProperty("+t.varName+', "'+c+'", '+e+")"},r),t.bindings.push(l)}}else t.content+=t.varName+'.setAttribute("'+u+'", "true");'}(o);return t},cn=function(e,n,r,t){return"let $$newValue = "+n+";if ($$newValue !== "+e+") {"+e+" = $$newValue;"+r(e)+"}"},En=function(e,n){return void 0===n&&(n=""),"for (let i = 0, n = "+e+".length; i < n; i++) {"+e+"[i]("+n+");}"},pn=function(e,n){switch(e.startTag.name){case"style":return ln(e,n);default:return un(e.startTag,In(e,n),n)}},ln=function(e,n){var r=Dn('document.createElement("style")',n);(r=$n(r,e,n)).content+="if (window.$synthetic) {";var t=Tn(e.childNodes[0],n);return r.content+=t.content+(r.varName+".$$setSheet(")+t.varName+");",r.content+="} else {"+r.varName+".textContent = "+JSON.stringify(xn(e.childNodes[0]))+";}",r},Tn=function(e,n){var r=fn(e.children,n),t=Bn("new CSSStyleSheet(["+r.map(function(e){return e.varName}).join(",")+"])",n);return t=$n(t,e,n),t.content=r.map(function(e){return e.content}).join("\n")+t.content,t},fn=function(e,n){return e.map(function(e){return dn(e,n)}).filter(Boolean)},dn=function(n,r){switch(n.type){case e.CSSExpressionType.AT_RULE:return _n(n,r);case e.CSSExpressionType.STYLE_RULE:return Ln(n,r)}throw new Error("Unexpected rule "+n.type)},_n=function(e,n){switch(e.name){case"media":return vn(e,n);case"keyframes":return Rn(e,n);case"font-face":return yn(e,n);case"import":return An(e,n);case"charset":return On(e,n)}},vn=function(e,n){return Cn(e,n,"CSSMediaRule",Ln)},yn=function(e,n){return $n(Bn("new CSSFontFaceRule("+mn(Sn(e),n)+")",n),e,n)},Sn=function(n){return n.children.filter(function(n){return n.type===e.CSSExpressionType.DECLARATION_PROPERTY})},Rn=function(e,n){return Cn(e,n,"CSSKeyframesRule",Nn)},Cn=function(e,n,r,t){var o=e.children.map(function(e){return t(e,n)}).filter(Boolean),i=Bn("new "+r+"("+JSON.stringify(e.params.join(" "))+", ["+o.map(function(e){return e.varName}).join(",")+"])",n);return i.content=o.map(function(e){return e.content}).join("\n")+i.content,i},Nn=function(e,n){return hn(e,"CSSKeyframeRule",n)},An=function(e,n){return null},On=function(e,n){return null},hn=function(e,n,r){return Bn("new "+n+"("+JSON.stringify(e.selectorText)+", "+mn(Sn(e),r)+")",r)},Ln=function(e,n){return hn(e,"CSSStyleRule",n)},mn=function(e,n){for(var r="{",t=0,o=e;t<o.length;t++){var i=o[t];r+='"'+i.name+'": "'+i.value.replace(/"/g,'\\"').replace(/[\s\r\n\t]+/g," ")+'", '}return"CSSStyleDeclaration.fromObject("+(r+="}")+")"},xn=function(e,n){return void 0===n&&(n=function(e){return e}),e.children.map(function(e){return Pn(e,n)}).filter(Boolean).join(" ")},Pn=function(n,r){switch(n.type){case e.CSSExpressionType.AT_RULE:var t=n;if("charset"===t.name||"import"===t.name)return null;a="@"+t.name+" "+t.params+" {";return a+=t.children.map(function(e){return Pn(e,r)}).filter(Boolean).join(" "),a+="}";case e.CSSExpressionType.DECLARATION_PROPERTY:var o=n;return o.name+": "+o.value+";";case e.CSSExpressionType.STYLE_RULE:var i=n,a=r(i.selectorText,i)+" {";return a+=i.children.map(function(e){return Pn(e,r)}).filter(Boolean).join(""),a+="}"}},gn=function(n,r){for(var t=[],o=0,i=n.length;o<i;o++){var a=n[o];if(a.type===e.PCExpressionType.TEXT_NODE&&/^[\s\r\n\t]+$/.test(a.value)){var u=n[o-1],s=n[o+1];if((!u||p(u))&&(!s||p(s)))continue}var c=nn(a,r);c&&t.push(c)}return t},In=function(e,n){var r=sn(e.startTag,n);r=$n(r,e,n);for(var t=gn(e.childNodes,n),o=0,i=t.length;o<i;o++){var a=t[o];r.content+=a.content,r.content+=r.varName+".appendChild("+a.varName+");\n",(u=r.bindings).push.apply(u,a.bindings)}return r;var u},Mn=function(e,n,r){var t=Un(e,r);return{varName:t,bindings:[],content:n?"let "+t+" = "+n+";\n":"let "+t+";\n"}},Un=function(e,n){return e+"_"+n.varCount++},Dn=function(e,n){return Mn("node",e,n)},Bn=function(e,n){return Mn("rule",e,n)},bn=function(e){var n=Dn('document.createDocumentFragment("")',e),r=Dn('document.createTextNode("")',e),t=Dn('document.createTextNode("")',e);return n.content+=r.content+""+t.content+n.varName+".appendChild("+r.varName+");"+n.varName+".appendChild("+t.varName+");",{fragment:n,start:r,end:t}},$n=function(e,n,r){var t=o({uri:r.uri,type:n.type},n.location);return e.content+=e.varName+".source = "+JSON.stringify(t)+";",e};!function(e){e[e.OBJECT=1]="OBJECT",e[e.ARRAY=2]="ARRAY",e[e.STRING=4]="STRING",e[e.BOOLEAN=8]="BOOLEAN",e[e.NUMBER=16]="NUMBER",e[e.OPTIONAL=32]="OPTIONAL",e[e.EXTENDABLE=64]="EXTENDABLE",e[e.OBJECT_OR_ARRAY=3]="OBJECT_OR_ARRAY",e[e.ANY_PRIMITIVE=28]="ANY_PRIMITIVE",e[e.EXTENDABLE_OBJECT=65]="EXTENDABLE_OBJECT",e[e.ANY=95]="ANY",e[e.STRING_OR_NUMBER=20]="STRING_OR_NUMBER"}(e.InferredTypeKind||(e.InferredTypeKind={}));var Kn={a:{href:e.InferredTypeKind.STRING}},Yn={},Vn=function(e,n){var r=n.currentScope[e[0]];return r&&(e=r.concat(e)),e},wn=function(e,n){Vn(e,n);for(var r=n.context,t=0,o=e.length;t<o;t++){var i=e[t];if(!r[1]||!r[1][i])return;r=r[1][i]}return r},Gn=function(e,n,r){return o({},r,{currentScope:o({},r.currentScope,(t={},t[e]=n,t))});var t},Hn=function(e,n){return o({},n,{currentScope:o({},n.currentScope,(r={},r[e]=void 0,r))});var r},kn=function(e,n,r){if(!e)return r;var t=jn(r.context,e,n);return Fn(t,r)},Fn=function(e,n){return o({},n,{context:e})},jn=function(n,r,t,i){void 0===i&&(i=0);var a=r[i];if(i===r.length)return t.slice();var u=n.slice();n[0]===e.InferredTypeKind.ANY?u=[e.InferredTypeKind.OBJECT,{}]:n[0]&e.InferredTypeKind.ARRAY||(n[0],e.InferredTypeKind.OBJECT);var s=u[1]||{};return u=[u[0],o({},s,(c={},c[a]=jn(s[a]||[e.InferredTypeKind.OBJECT,s],r,t,i+1),c))];var c},Qn=function(e,n){for(var r=0,t=e;r<t.length;r++){var o=t[r];n=kn(o[0],o[1],n)}return n},Xn=function(e,n){return[e,n]},Wn=function(e,n){return void 0===n&&(n=null),[e,n]},Jn=function(n){return void 0===n&&(n=Wn(e.InferredTypeKind.OBJECT,{})),{context:n,currentScope:{}}},qn=function(e){return e[0]},zn=function(e){return e[1]},Zn=function(e){return er(e,Jn()).context},er=function(n,r){switch(void 0===r&&(r=Jn()),n.type){case e.PCExpressionType.TEXT_NODE:return r;case e.PCExpressionType.BLOCK:return rr(n,r);case e.PCExpressionType.FRAGMENT:return Er(n.childNodes,r);case e.PCExpressionType.ELEMENT:case e.PCExpressionType.SELF_CLOSING_ELEMENT:return nr(n,r)}return r},nr=function(n,r){return r=ur(n,r),A(n,e.BKExpressionType.REPEAT)||(r=Er(a(n),r)),r},rr=function(e,n){return r=ar(e.value,n),r[0],n=r[1];var r},tr=function(e,n,r){return or(e.map(function(e){var r=e[0],t=e[1],o=t[0],i=t[1];return r&&Xn(r,Wn(o&n,i))}),r)},or=function(e,n){for(var r=[],t=0,o=e.length;t<o;t++){var i=e[t];n=kn(i[0],i[1],n),r.push(i)}return[r,n]},ir=function(e,n,r){return or(e.map(function(e){var r=e[0],t=e[1];t[0],t[1];return Xn(r,n)}),r)},ar=function(n,r){switch(n.type){case e.BKExpressionType.OPERATION:var t=n,o=t.left,i=t.operator,a=t.right,u=void 0,s=void 0;u=(P=ar(o,r))[0],r=P[1],s=(g=ar(a,r))[0],r=g[1];var c=u.concat(s);if(/^[\*\/\-%]$/.test(i))for(var E=0,p=c.length;E<p;E++){var l=c[E],T=l[0],f=l[1][0];r=kn(T,[f&e.InferredTypeKind.NUMBER,null],r)}else{if("+"===i)return ir(c,Wn(e.InferredTypeKind.ANY),r);if("==="===i||"!=="===i){var d=c.reduce(function(e,n){return e&zn(n)[0]},e.InferredTypeKind.ANY);return ir(c,Wn(d),r)}}return[c,r];case e.BKExpressionType.STRING:return[[Xn(null,Wn(e.InferredTypeKind.STRING))],r];case e.BKExpressionType.NUMBER:return[[Xn(null,Wn(e.InferredTypeKind.NUMBER))],r];case e.BKExpressionType.VAR_REFERENCE:case e.BKExpressionType.PROP_REFERENCE:var T=n.type===e.BKExpressionType.VAR_REFERENCE?[n.name]:n.path.map(function(e){return e.name}),_=Vn(T,r),v=wn(_,r);return v||(r=kn(_,v=[e.InferredTypeKind.ANY,null],r)),[[Xn(_,v)],r];case e.BKExpressionType.BIND:return ar((x=n).value,r);case e.BKExpressionType.OBJECT:for(var y,S=[],R=0,C=(x=n).properties;R<C.length;R++){var N=C[R];y=(I=ar(N.value,r))[0],r=I[1],S.push.apply(S,y)}return[S,r];case e.BKExpressionType.ARRAY:for(var A,S=[],O=0,h=(x=n).values;O<h.length;O++){var L=h[O];A=(M=ar(L,r))[0],r=M[1],S.push.apply(S,A)}return[S,r];case e.BKExpressionType.NOT:var m;return U=ar(n.value,r),m=U[0],r=U[1],[m,r];case e.BKExpressionType.IF:case e.BKExpressionType.ELSEIF:return ar((x=n).condition,r);case e.BKExpressionType.GROUP:var x=n;return ar(x.value,r);default:throw new Error("Unexpected expression "+n.type)}var P,g,I,M,U},ur=function(n,r){for(var t,o,i,u=0,s=N(n).modifiers;u<s.length;u++){var c=s[u];c.value.type===e.BKExpressionType.IF?t=c.value:c.value.type===e.BKExpressionType.ELSEIF?o=c.value:c.value.type===e.BKExpressionType.ELSE?c.value:c.value.type===e.BKExpressionType.REPEAT&&(i=c.value)}if(t||o){var E=(t||o).condition;(v=ar(E,r))[0],r=v[1]}if(i){var p=i.each,l=(i.asKey,i.asValue),T=void 0,f=void 0;f=(y=ar(p,r))[0],r=y[1],f=(S=tr(f,e.InferredTypeKind.OBJECT_OR_ARRAY,r))[0],r=S[1],T=ar(l,r)[0];var d=qn(f[0]),_=qn(T[0])[0];r=Gn(_,d,r),r=sr(n,r)[1],r=cr(n,r)[1],r=Er(a(n),r),r=Hn(_,r)}else r=sr(n,r)[1],r=cr(n,r)[1];return r;var v,y,S},sr=function(n,r){void 0===r&&(r=Jn());for(var t=N(n),o=c(n),i=[],a=Kn[t.name]||Yn,u=0,s=o.length;u<s;u++){var E=[],p=o[u],l=p.value,T=p.name;if(l){if(l.type===e.PCExpressionType.BLOCK){E=(d=ar(l.value.value,r))[0],r=d[1];var f=a[T];f&&(E=(_=tr(E,f,r))[0],r=_[1])}i.push.apply(i,E)}}return[i,r];var d,_},cr=function(n,r){void 0===r&&(r=Jn());N(n);for(var t=E(n),o=[],i=0,a=t.length;i<a;i++){var u=t[i],s=[];if(u.value.type===e.BKExpressionType.BIND){s=(y=ar(u.value.value,r))[0],r=y[1];for(var c=[],p=0,l=s;p<l.length;p++){var T=l[p],f=T[0],d=T[1],_=(d[0],d[1]),v=[f,[e.InferredTypeKind.EXTENDABLE_OBJECT,_]];c.push(v),r=kn(v[0],v[1],r)}s=c}o.push.apply(o,s)}return[o,r];var y},Er=function(e,n){for(var r=0,t=e;r<t.length;r++){var o=t[r];n=er(o,n)}return n},pr=function(e){},lr={},Tr=function(e,n){if(lr[e])return lr[e];var r={filePath:n,source:e,diagnostics:[],scanner:K(e)};return lr[e]={root:fr(r),diagnostics:r.diagnostics}},fr=function(n){for(var r,t=n.scanner,o=t.curr(),a=[];!t.ended();)if(a.push(dr(n)),!r){if((r=t.curr())&&r.type!==i.WHITESPACE&&r.type!==i.COMMA&&!Ie(n,[i.COMMA]))return null;t.next()}return 1===a.length?a[0]:{type:r.type===i.WHITESPACE?e.DcExpressionType.SPACED_LIST:e.DcExpressionType.COMMA_LIST,items:a,location:U(o,t.curr(),t.source)}},dr=function(e){var n=e.scanner;switch(Le(e),n.curr().type){case i.SINGLE_QUOTE:case i.DOUBLE_QUOTE:return z(e);case i.HASH:return _r(e);case i.NUMBER:return vr(e);case i.MINUS:return n.hasNext()&&n.peek(1).type===i.NUMBER?vr(e):Sr(e);case i.TEXT:return Sr(e);default:xe(n.source,n.curr())}},_r=function(n){for(var r=n.scanner,t=r.curr(),o="";!r.ended()&&r.curr().type!==i.WHITESPACE;)o+=r.curr().value,r.next();return{type:e.DcExpressionType.COLOR,value:o,location:U(t,r.curr(),r.source)}},vr=function(n){var r=n.scanner,t=r.curr(),o=yr(n),a="";return r.ended()||r.curr().type===i.WHITESPACE||r.curr().type===i.COMMA||r.curr().type===i.PAREN_CLOSE||(a=r.curr().value,r.next()),{type:e.DcExpressionType.MEASUREMENT,value:o,unit:a,location:U(t,r.curr(),r.source)}},yr=function(e){var n=e.scanner,r=n.curr().value;return"-"===r&&(r+=n.next().value),n.next(),r},Sr=function(n){var r=n.scanner,t=r.curr(),o=Cr(n);return r.ended()||r.curr().type!==i.PAREN_OPEN?{type:e.DcExpressionType.KEYWORD,name:o}:{type:e.DcExpressionType.CALL,name:o,params:Rr(n),location:U(t,r.curr(),r.source)}},Rr=function(e){for(var n=e.scanner,r=[];!n.ended()&&n.curr().type!==i.PAREN_CLOSE;)n.next(),Le(e),r.push(dr(e));return Ie(e,[i.PAREN_CLOSE])?(n.next(),r):null},Cr=function(e){for(var n=e.scanner,r="";!n.ended()&&n.curr().type!==i.WHITESPACE&&n.curr().type!==i.PAREN_OPEN&&n.curr().type!==i.PAREN_CLOSE;)r+=n.curr().value,n.next();return r},Nr=function(n){switch(n.type){case e.DcExpressionType.SPACED_LIST:return(r=n).items.map(Nr).join(" ");case e.DcExpressionType.COMMA_LIST:var r=n;return r.items.map(Nr).join(", ");case e.DcExpressionType.KEYWORD:return n.name;case e.DcExpressionType.CALL:var t=n;return t.name+"("+t.params.map(Nr).join(", ")+")";case e.DcExpressionType.COLOR:return n.value;case e.BKExpressionType.STRING:return JSON.stringify(n.value);case e.DcExpressionType.MEASUREMENT:var o=n;return""+o.value+o.unit;default:throw new Error("Unable to stringify CSS declaration value type "+n.type)}},Ar=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MUTATED="MUTATED",n.SET_VALUE_MUTATION="SET_VALUE_MUTATION",n.INSERT_CHILD_MUTATION="INSERT_CHILD_MUTATION",n.REMOVE_CHILD_MUTATION="REMOVE_CHILD_MUTATION",n.SET_PROPERTY_MUTATION="SET_PROPERTY_MUTATION",n.REMOVE_MUTATION="REMOVE_MUTATION",n.createMutationEvent=function(e){return{type:n.MUTATED,mutation:e}},n.createSetValueMutation=function(e,n,r){return{type:e,target:n,newValue:r}},n.createInsertChildMutation=function(e,n,r,t,o){return void 0===t&&(t=Number.MAX_SAFE_INTEGER),{type:e,target:n,child:r,index:t,clone:o}},n.createRemoveChildMutation=function(e,n,r,t){return{type:e,target:n,child:r,index:t}},n.createMoveChildMutation=function(e,n,r,t,o){return{type:e,target:n,child:r,index:t,oldIndex:o}},n.createPropertyMutation=function(e,n,r,t,o,i,a){return{type:e,target:n,name:r,newValue:t,oldValue:o,oldName:i,index:a}},n.createRemoveMutation=function(e,n,r,t,o,i){return{type:e,target:n}}});r(Ar);Ar.MUTATED,Ar.SET_VALUE_MUTATION,Ar.INSERT_CHILD_MUTATION,Ar.REMOVE_CHILD_MUTATION,Ar.SET_PROPERTY_MUTATION,Ar.REMOVE_MUTATION,Ar.createMutationEvent,Ar.createSetValueMutation,Ar.createInsertChildMutation,Ar.createRemoveChildMutation,Ar.createMoveChildMutation,Ar.createPropertyMutation,Ar.createRemoveMutation;var Or=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.STRING_REPLACE="STRING_REPLACE",n.createStringMutation=function(e,r,t){return void 0===t&&(t=""),{startIndex:e,endIndex:r,value:t,type:n.STRING_REPLACE}},n.editString=function(e,n,r){void 0===r&&(r=[]);for(var t=e,o=r.length,i=r.concat(n),a=0,u=n.length;a<u;a++){for(var s=n[a],c=s.startIndex,E=s.endIndex,p=s.value,l=c,T=E,f=!1,d=c===E,_=a+o,v=0;v<_;v++){var y=i[v],S=y.startIndex,R=y.endIndex,C=y.value,N=S===R,A=c===S,O=E===R,h=A&&d,L=O&&d,m=A&&N,x=O&&N,P=h||L||m||x;if(S<E&&S>c&&(T-=E-S),R>c&&R<E&&(l+=R-c),(c>=S&&E<=R||c<S&&E>=R)&&!P){f=!0;break}if(S<=c&&E>S){var g=C.length-(R-S);l=Math.max(0,l+g),T=Math.max(0,T+g)}}f||(t=t.substr(0,l)+p+t.substr(T))}return t}});r(Or);Or.STRING_REPLACE,Or.createStringMutation,Or.editString;var hr=t(function(e,n){function r(e,r,t){for(var o=[].concat(e),i=[].concat(e),a=[].concat(r),u=[],s=[],c=0,E=i.length;c<E;c++){for(var p=i[c],l=void 0,T=1/0,f=0,d=a.length;f<d;f++){var _=t(p,S=a[f]);if(~_&&_<T&&(l=S,T=_),0===T)break}null!=l&&(i.splice(c--,1),E--,a.splice(a.indexOf(l),1),s[r.indexOf(l)]=[p,l])}for(c=i.length;c--;){var p=i[c],v=e.indexOf(p);u.push(n.createArrayDeleteMutation(p,v)),o.splice(v,1)}for(var c=0,E=a.length;c<E;c++){S=a[c];s[v=r.indexOf(S)]=[void 0,S]}for(var c=0,E=s.length;c<E;c++)if(null!=s[c]){var y=s[c],p=y[0],S=y[1],R=c;if(null==p)u.push(n.createArrayInsertMutation(R,S)),o.splice(R,0,S);else{var C=o.indexOf(p);u.push(n.createArrayUpdateMutation(e.indexOf(p),C,S,R)),C!==R&&(o.splice(C,1),o.splice(R,0,p))}}return n.createArrayMutation(u)}function t(e,r,t,o){void 0===t&&(t=function(e,n){return n}),void 0===o&&(o=function(e){return e});var i=e.slice();return n.eachArrayValueMutation(r,{insert:function(e){var n=e.index,r=e.value;i.splice(n,0,o(r))},delete:function(e){var n=e.index;i.splice(n,1)},update:function(e){var n=e.patchedOldIndex,r=e.newValue,o=e.index,a=i[n],u=t(a,r);u===a&&n===o||(n!==o&&i.splice(n,1),i.splice(o,0,u))}}),i}Object.defineProperty(n,"__esModule",{value:!0}),n.ARRAY_DIFF="ARRAY_DIFF",n.ARRAY_INSERT="ARRAY_INSERT",n.ARRAY_UPDATE="ARRAY_UPDATE",n.ARRAY_DELETE="ARRAY_DELETE",n.createArrayInsertMutation=function(e,r){return{type:n.ARRAY_INSERT,index:e,value:r}},n.createArrayUpdateMutation=function(e,r,t,o){return{type:n.ARRAY_UPDATE,index:o,newValue:t,originalOldIndex:e,patchedOldIndex:r}},n.createArrayDeleteMutation=function(e,r){return{type:n.ARRAY_DELETE,value:e,index:r}},n.createArrayMutation=function(e){return{type:n.ARRAY_DIFF,mutations:e}},n.diffArray=r,n.eachArrayValueMutation=function(e,r){e.mutations.forEach(function(e){switch(e.type){case n.ARRAY_INSERT:return r.insert(e);case n.ARRAY_DELETE:return r.delete(e);case n.ARRAY_UPDATE:return r.update(e)}})},n.patchArray=t});r(hr);hr.ARRAY_DIFF,hr.ARRAY_INSERT,hr.ARRAY_UPDATE,hr.ARRAY_DELETE,hr.createArrayInsertMutation,hr.createArrayUpdateMutation,hr.createArrayDeleteMutation,hr.createArrayMutation,hr.diffArray,hr.eachArrayValueMutation,hr.patchArray;var Lr=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(Ar),r(Or),r(hr)});r(Lr);var mr=Lr.createStringMutation,xr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});!function(e){e.PX="PX",e.PERC="%",e.VW="vw",e.VH="vh",e.CM="cm",e.EM="em",e.EX="ex",e.IN="in",e.MM="mm",e.PC="pc",e.PT="pt",e.VMIN="vmin"}(n.CSSMeasurementTypes||(n.CSSMeasurementTypes={}));!function(e){e.HORIZONTAL="HORIZONTAL",e.VERTICAL="VERTICAL"}(n.Axis||(n.Axis={}));!function(e){e[e.azimuth=0]="azimuth",e[e.borderCollapse=1]="borderCollapse",e[e.borderSpacing=2]="borderSpacing",e[e.captionSide=3]="captionSide",e[e.color=4]="color",e[e.cursor=5]="cursor",e[e.direction=6]="direction",e[e.elevation=7]="elevation",e[e.emptyCells=8]="emptyCells",e[e.fontFamily=9]="fontFamily",e[e.fontSize=10]="fontSize",e[e.fontStyle=11]="fontStyle",e[e.fontVariant=12]="fontVariant",e[e.fontWeight=13]="fontWeight",e[e.font=14]="font",e[e.letterSpacing=15]="letterSpacing",e[e.lineHeight=16]="lineHeight",e[e.listStyleImage=17]="listStyleImage",e[e.listStylePosition=18]="listStylePosition",e[e.listStyleType=19]="listStyleType",e[e.listStyle=20]="listStyle",e[e.orphans=21]="orphans",e[e.pitchRange=22]="pitchRange",e[e.pitch=23]="pitch",e[e.quotes=24]="quotes",e[e.richness=25]="richness",e[e.speakHeader=26]="speakHeader",e[e.speakNumeral=27]="speakNumeral",e[e.speakPunctuation=28]="speakPunctuation",e[e.speak=29]="speak",e[e.speechRate=30]="speechRate",e[e.stress=31]="stress",e[e.textAlign=32]="textAlign",e[e.textIndent=33]="textIndent",e[e.textDecoration=34]="textDecoration",e[e.textTransform=35]="textTransform",e[e.visibility=36]="visibility",e[e.voiceFamily=37]="voiceFamily",e[e.volume=38]="volume",e[e.whiteSpace=39]="whiteSpace",e[e.widows=40]="widows",e[e.wordSpacing=41]="wordSpacing"}(n.INHERITED_CSS_STYLE_PROPERTIES||(n.INHERITED_CSS_STYLE_PROPERTIES={}))});r(xr);xr.CSSMeasurementTypes,xr.Axis,xr.INHERITED_CSS_STYLE_PROPERTIES;var Pr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CSS_STYLE_RULE_SET_SELECTOR_TEXT="CSS_STYLE_RULE_SET_SELECTOR_TEXT",n.CSS_STYLE_RULE_SET_STYLE="CSS_STYLE_RULE_SET_STYLE",n.CSS_STYLE_RULE_SET_STYLE_PROPERTY="CSS_STYLE_RULE_SET_STYLE_PROPERTY",n.CSS_PARENT_INSERT_RULE="CSS_PARENT_INSERT_RULE",n.CSS_PARENT_DELETE_RULE="CSS_PARENT_DELETE_RULE",n.CSS_PARENT_MOVE_RULE="CSS_PARENT_MOVE_RULE",n.CSS_INSERT_CSS_RULE_TEXT="CSS_INSERT_CSS_RULE_TEXT"});r(Pr);Pr.CSS_STYLE_RULE_SET_SELECTOR_TEXT,Pr.CSS_STYLE_RULE_SET_STYLE,Pr.CSS_STYLE_RULE_SET_STYLE_PROPERTY,Pr.CSS_PARENT_INSERT_RULE,Pr.CSS_PARENT_DELETE_RULE,Pr.CSS_PARENT_MOVE_RULE,Pr.CSS_INSERT_CSS_RULE_TEXT;var gr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SET_ELEMENT_ATTRIBUTE_EDIT="setElementAttributeEdit",n.ATTACH_SHADOW_ROOT_EDIT="attachShadowRootEdit",n.SET_TEXT_CONTENT="setTextContent",n.INSERT_HTML_EDIT="INSERT_HTML_EDIT",n.INSERT_CHILD_NODE_EDIT="INSERT_CHILD_NODE_EDIT",n.REMOVE_CHILD_NODE_EDIT="REMOVE_CHILD_NODE_EDIT",n.MOVE_CHILD_NODE_EDIT="MOVE_CHILD_NODE_EDIT",n.UPDATE_VALUE_NODE="UPDATE_VALUE_NODE"});r(gr);gr.SET_ELEMENT_ATTRIBUTE_EDIT,gr.ATTACH_SHADOW_ROOT_EDIT,gr.SET_TEXT_CONTENT,gr.INSERT_HTML_EDIT,gr.INSERT_CHILD_NODE_EDIT,gr.REMOVE_CHILD_NODE_EDIT,gr.MOVE_CHILD_NODE_EDIT,gr.UPDATE_VALUE_NODE;var Ir=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(xr),r(Pr),r(gr)});r(Ir);var Mr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}(Ir)});r(Mr);var Ur=Mr,Dr=Ur.UPDATE_VALUE_NODE,Br=Ur.SET_ELEMENT_ATTRIBUTE_EDIT,br=Ur.INSERT_CHILD_NODE_EDIT,$r=Ur.REMOVE_CHILD_NODE_EDIT,Kr=Ur.INSERT_HTML_EDIT,Yr=(Ur.CSS_INSERT_CSS_RULE_TEXT,Ur.CSS_PARENT_DELETE_RULE,Ur.CSS_STYLE_RULE_SET_SELECTOR_TEXT,Ur.CSS_STYLE_RULE_SET_STYLE_PROPERTY,t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createInsertHTMLMutation=function(e,n,r){return{type:gr.INSERT_HTML_EDIT,html:r,childIndex:n,target:e}}}));r(Yr);Yr.createInsertHTMLMutation;var Vr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.insertCSSRuleText=function(e,n,r){return{type:Pr.CSS_INSERT_CSS_RULE_TEXT,target:e,childIndex:n,cssText:r}}});r(Vr);Vr.insertCSSRuleText;var wr=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(Yr),r(Vr)});r(wr);var Gr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}(wr)});r(Gr);var Hr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}(Gr)});r(Hr);var kr=Hr.createInsertHTMLMutation,Fr=function(e,n){return{type:"PC_REMOVE_CHILD_NODE",index:n,target:e}},jr=function(e){return{type:"PC_REMOVE_NODE",target:e}},Qr=function(e,n){var r=w(e),t=Wr(r.root,n.target.location||n.target.source);if(n.target.source&&console.warn("Mutation target does not match expected type."),!t)return[mr(0,0,"")];switch(n.type){case Dr:return nt(t,n);case Br:return rt(t,n);case $r:return Jr(t,n.index);case br:return zr(t,n,e);case Kr:return Zr(t,n,e);case"PC_REMOVE_CHILD_NODE":return Jr(t,n.index);case"PC_REMOVE_NODE":return qr(t)}return[mr(0,0,"")]},Xr=function(e,n){return e.location.start.line===n.start.line&&e.location.start.column===n.start.column&&e.location.end.line===n.end.line&&e.location.end.column===n.end.column},Wr=function(n,r){if(Xr(n,r))return n;if(n.type===e.PCExpressionType.FRAGMENT||n.type===e.PCExpressionType.ELEMENT)for(var t=0,o=n.childNodes;t<o.length;t++){var i=o[t],a=Wr(i,r);if(a)return a}},Jr=function(e,n){var r=e.childNodes[n];return qr(r)},qr=function(e){return[mr(e.location.start.pos,e.location.end.pos,"")]},zr=function(e,n,r){var t=n.target,o=n.index,i=n.child;return Zr(e,kr(t,o,i.nodeValue||i.outerHTML),r)},Zr=function(n,r,t){var o=r.childIndex,i=r.html;if(n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT)return[mr(et((u=n).location.end.pos-2,t),u.location.end.pos,">"+i+"</"+u.name+">")];var a=n.childNodes[o];if(!a){var u=n;return[mr(u.startTag.location.end.pos,u.startTag.location.end.pos,i)]}return[mr(a.location.start.pos,a.location.start.pos,i)]},et=function(e,n){var r=n.substr(0,e).split("").reverse().join("").match(/^([\s\r\n\t]+)/)||["",""];return e-r[1].length},nt=function(e,n){var r=n.newValue;return[mr(e.location.start.pos,e.location.end.pos,r)]},rt=function(n,r){var t;n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT?t=n:n.type===e.PCExpressionType.ELEMENT&&(t=n.startTag);for(var o,i=r.name,a=r.newValue&&'"'+r.newValue+'"',u=0,s=t.attributes;u<s.length;u++){var c=s[u];if(c.name===i)return o=!0,a?[mr(c.value.location.start.pos,c.value.location.end.pos,a)]:[mr(c.location.start.pos-1,c.location.end.pos,"")]}if(!o){var E=t.location.start.pos+t.name.length+1;return[mr(E,E,!0===r.newValue?i:" "+i+"="+a)]}};e.getElementChildNodes=a,e.getElementTagName=u,e.getAttributeStringValue=s,e.getElementAttributes=c,e.getElementModifiers=E,e.isTag=p,e.filterPCElementsByStartTag=l,e.getElementStartTag=T,e.getPCStartTagAttribute=f,e.hasPCStartTagAttribute=d,e.getPCStyleElements=_,e.getPCLinkStyleElements=v,e.getPCCSSElements=y,e.getPCMetaTags=S,e.getPCMetaName=R,e.traversePCAST=C,e.getStartTag=N,e.getPCElementModifier=A,e.getExpressionPath=O,e.filterPCASTTree=h,e.getPCASTElementsByTagName=L,e.getPCParent=m,e.getAllChildElementNames=x,e.parseModuleSource=w,e.parseStyleSource=G,e.createString=z,e.eatWhitespace=Le,e.throwUnexpectedToken=xe,e.addUnexpectedToken=Pe,e.testCurrTokenExists=ge,e.testCurrTokenType=Ie,e.bundleVanilla=Xe,e.transpileBlockExpression=We,e.transpileStyleElement=ln,e.transpileCSSSheet=xn,e.loadModuleAST=Ue,e.defaultResolveModulePath=De,e.getChildComponentInfo=Be,e.getDependencyChildComponentInfo=be,e.getModuleComponent=$e,e.getUsedDependencies=Ke,e.getImportDependencies=Ye,e.getComponentDependency=Ve,e.loadModuleDependencyGraph=we,e.parseMetaContent=He,e.getComponentMetadataItems=ke,e.getComponentMetadataItem=Fe,e.setSymbolTableEntries=Qn,e.inferredType=Wn,e.symbolTable=Jn,e.inferRootNodeTypes=Zn,e.inferNodeTypes=er,e.inferElementAttributeTypes=sr,e.inferElementSpreadTypes=cr,e.loadComponentTypes=pr,e.parseDeclaration=Tr,e.stringifyDeclarationAST=Nr,e.editPaperclipSource=Qr,e.PC_REMOVE_CHILD_NODE="PC_REMOVE_CHILD_NODE",e.PC_REMOVE_NODE="PC_REMOVE_NODE",e.createPCRemoveChildNodeMutation=Fr,e.createPCRemoveNodeMutation=jr,Object.defineProperty(e,"__esModule",{value:!0})});
