!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.paperclip={})}(this,function(e){"use strict";function n(e,n){function r(){this.constructor=e}for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,n){return n={exports:{}},e(n,n.exports),n.exports}const i=Object.assign||function(e){for(var n,r=1;r<arguments.length;r++){n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e};!function(e){e[e.STRING=0]="STRING",e[e.BLOCK=1]="BLOCK",e[e.STRING_BLOCK=2]="STRING_BLOCK",e[e.ELEMENT=3]="ELEMENT",e[e.SELF_CLOSING_ELEMENT=4]="SELF_CLOSING_ELEMENT",e[e.TEXT_NODE=5]="TEXT_NODE",e[e.COMMENT=6]="COMMENT",e[e.ATTRIBUTE=7]="ATTRIBUTE",e[e.START_TAG=8]="START_TAG",e[e.BLOCK_STRING=9]="BLOCK_STRING",e[e.FRAGMENT=10]="FRAGMENT",e[e.END_TAG=11]="END_TAG"}(e.PCExpressionType||(e.PCExpressionType={})),function(e){e.TYPE="TYPE",e.BIND="BIND",e.IF="IF",e.STRING="STRING",e.OBJECT="OBJECT",e.ARRAY="ARRAY",e.KEY_VALUE_PAIR="KEY_VALUE_PAIR",e.NUMBER="NUMBER",e.PROPERTY="PROPERTY",e.RESERVED_KEYWORD="RESERVED_KEYWORD",e.ELSEIF="ELSEIF",e.NOT="NOT",e.OPERATION="OPERATION",e.GROUP="GROUP",e.VAR_REFERENCE="VAR_REFERENCE",e.PROP_REFERENCE="PROP_REFERENCE",e.ELSE="ELSE",e.REPEAT="REPEAT"}(e.BKExpressionType||(e.BKExpressionType={})),function(e){e[e.SHEET=0]="SHEET",e[e.DECLARATION_PROPERTY=1]="DECLARATION_PROPERTY",e[e.STYLE_RULE=2]="STYLE_RULE",e[e.AT_RULE=3]="AT_RULE",e[e.IMPORT=4]="IMPORT",e[e.CHARSET=5]="CHARSET"}(e.CSSExpressionType||(e.CSSExpressionType={})),function(e){e.COLOR="COLOR",e.CALL="CALL",e.MEASUREMENT="MEASUREMENT",e.SPACED_LIST="SPACED_LIST",e.COMMA_LIST="COMMA_LIST",e.KEYWORD="KEYWORD",e.LIST="LIST"}(e.DcExpressionType||(e.DcExpressionType={}));var o=function(n){return n.type==e.PCExpressionType.SELF_CLOSING_ELEMENT?[]:n.childNodes},a=function(n){return n.type==e.PCExpressionType.SELF_CLOSING_ELEMENT?n.name:n.startTag.name},u=function(e){return e.value.value},s=function(e){return N(e).attributes},c=function(e){return N(e).modifiers},E=function(n){return n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.START_TAG||n.type===e.PCExpressionType.END_TAG||n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT},p=function(n,r){return A(n,function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT?r(n):n.type===e.PCExpressionType.ELEMENT&&r(n.startTag)})},l=function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||n.type==e.PCExpressionType.START_TAG?n:n.startTag},T=function(e,n){if(f(e,n)){var r=l(e).attributes.find(function(e){return e.name===n});return r&&r.value&&r.value.value}},f=function(n,r){return(n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||n.type===e.PCExpressionType.START_TAG)&&Boolean(l(n).attributes.find(function(e){return e.name===r}))},_=function(n){return A(n,function(n){return n.type===e.PCExpressionType.ELEMENT&&"style"===n.startTag.name})},y=function(n){return A(n,function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT&&"link"===n.name&&"stylesheet"===T(n,"rel")})},d=function(e){return _(e).concat(y(e))},v=function(e){return O(e,"meta")},R=function(e){var n=v(e).find(function(e){return Boolean(T(e,"name"))});return n&&T(n,"content")},S=function(e,n,r){if(void 0===r&&(r=[]),!1===n(e,r))return!1;if(e.childNodes)for(var t=e,i=0,o=t.childNodes.length;i<o;i++){var a=t.childNodes[i];if(!1===S(a,n,r.concat(["childNodes",i])))return!1}},N=function(n){return n.type===e.PCExpressionType.ELEMENT?n.startTag:n},C=function(e,n){return N(e).modifiers.find(function(e){return e.value.type===n})},h=function(e,n){var r;return S(n,function(n,t){if(n===e)return r=t,!1}),r},A=function(e,n){var r=[];return S(e,function(e){n(e)&&r.push(e)}),r},O=function(e,n){return p(e,function(e){return e.name===n})},L=function(n,r){return A(n,function(n){return n.childNodes&&n.childNodes.find(function(n){return n===r||r.type===e.PCExpressionType.START_TAG&&n.type===e.PCExpressionType.ELEMENT&&n.startTag===r})})[0]},m=function(e){var n=[];return S(e,function(e){E(e)&&-1===n.indexOf(N(e).name)&&n.push(N(e).name)}),n};!function(e){e.WARNING="WARNING",e.ERROR="ERROR"}(e.DiagnosticType||(e.DiagnosticType={}));var g,x=function(e,n){for(var r=e.location,t=e.filePath,i=void 0===t?"":t,o=e.message+"\n\n",a=n[i].module.source.input.split("\n").slice(r.start.line-1,r.end.line+1).map(function(e){return e+"\n"}),u=["[90m"+a[0].substr(0,r.start.column)+"[0m[31m"+a[0].substr(r.start.column)+"[0m"].concat(a.slice(1,r.end.line-r.start.line).map(function(e){return"[31m"+e+"[0m"}),["[31m"+a[a.length-1].substr(0,r.end.column)+"[0m[90m"+a[a.length-1].substr(r.end.column)+"[0m"]),s=0,c=u.length;s<c;s++)o+=r.start.line+s+"| "+u[s];return o},I=function(e,n,r){return{type:e,pos:n,value:r}},P={},M=function(e){if(P[e])return P[e];var n=1,r=0,t={};return(e+" ").split("").forEach(function(e,i){t[i]=[r,n],"\n"===e&&(r=0,n++),r++}),P[e]=t},U=function(e,n){var r="number"==typeof e?e:e.pos,t=M(n)[r];return{column:t[0],line:t[1],pos:r}},B=function(e,n,r){return{start:e.line?e:U(e,r),end:n&&n.line?n:U(n||r.length,r)}},D=function(e,n){return B(e,e.pos+e.value.length,n)},b=function(){function e(e){this._target=e,this.pos=0,this.length=e.length}return e.prototype.curr=function(){return this._target[this.pos]},e.prototype.shift=function(){var e=this._target[this.pos];return this.next(),e},e.prototype.hasNext=function(){return this.pos<this.length-1},e.prototype.next=function(){return this._target[Math.min(this.pos=this.pos+1,this.length)]},e.prototype.prev=function(){return this._target[Math.max(this.pos=this.pos-1,0)]},e.prototype.ended=function(){return this.pos>=this.length},e}(),K=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.prototype.scan=function(e){for(var n="";this.pos<this.length;){var r=this._target[this.pos];if(!r.match(e))break;n+=r,this.pos++}return n},r.prototype.match=function(e){var n=this._target.substr(this.pos),r=n.match(e);if(r){var t=r[0];return this.pos+=n.indexOf(t)+t.length,t}return null},r.prototype.peek=function(e){return this._target.substr(this.pos,e)},r.prototype.take=function(e){var n=this._target.substr(this.pos,e);return this.pos+=e,n},r}(b),w=function(e){function r(n,r){var t=e.call(this,r)||this;return t.source=n,t}return n(r,e),r.prototype.peek=function(e){return void 0===e&&(e=1),this._target[this.pos+e]},r.prototype.peekUntil=function(e){for(var n=this.pos;n<this.length-1;)if(e(this._target[++n]))return this._target[n]},r.prototype.curr=function(){return e.prototype.curr.call(this)},r.prototype.next=function(){return e.prototype.next.call(this)},r}(b);!function(e){e[e.LESS_THAN=0]="LESS_THAN",e[e.LESS_THAN_OR_EQUAL=1]="LESS_THAN_OR_EQUAL",e[e.CLOSE_TAG=2]="CLOSE_TAG",e[e.COMMA=3]="COMMA",e[e.GREATER_THAN=4]="GREATER_THAN",e[e.GREATER_THAN_OR_EQUAL=5]="GREATER_THAN_OR_EQUAL",e[e.COMMENT=6]="COMMENT",e[e.BACKSLASH=7]="BACKSLASH",e[e.PERIOD=8]="PERIOD",e[e.BANG=9]="BANG",e[e.AND=10]="AND",e[e.OR=11]="OR",e[e.PLUS=12]="PLUS",e[e.COLON=13]="COLON",e[e.SEMICOLON=14]="SEMICOLON",e[e.MINUS=15]="MINUS",e[e.NUMBER=16]="NUMBER",e[e.AT=17]="AT",e[e.STAR=18]="STAR",e[e.PERCENT=19]="PERCENT",e[e.PAREN_OPEN=20]="PAREN_OPEN",e[e.PAREN_CLOSE=21]="PAREN_CLOSE",e[e.DOUBLE_EQUALS=22]="DOUBLE_EQUALS",e[e.TRIPPLE_EQUELS=23]="TRIPPLE_EQUELS",e[e.NOT_EQUALS=24]="NOT_EQUALS",e[e.NOT_DOUBLE_EQUALS=25]="NOT_DOUBLE_EQUALS",e[e.BRACKET_OPEN=26]="BRACKET_OPEN",e[e.BRACKET_CLOSE=27]="BRACKET_CLOSE",e[e.CURLY_BRACKET_OPEN=28]="CURLY_BRACKET_OPEN",e[e.CURLY_BRACKET_CLOSE=29]="CURLY_BRACKET_CLOSE",e[e.EQUALS=30]="EQUALS",e[e.SINGLE_QUOTE=31]="SINGLE_QUOTE",e[e.HASH=32]="HASH",e[e.DOUBLE_QUOTE=33]="DOUBLE_QUOTE",e[e.TEXT=34]="TEXT",e[e.RESERVED_KEYWORD=35]="RESERVED_KEYWORD",e[e.WHITESPACE=36]="WHITESPACE"}(g||(g={}));var Y=function(e){for(var n=new K(e),r=[];!n.ended();){var t=n.curr(),i=void 0;if("<"===t)if("</"===n.peek(2))i=I(g.CLOSE_TAG,n.pos,n.take(2));else if("\x3c!--"===n.peek(4)){for(var o=n.take(4);!n.ended();){var a=n.curr();if("-"===a&&"--\x3e"===n.peek(3)){o+=n.take(3);break}n.next(),o+=a}i=I(g.COMMENT,n.pos,o)}else i="<="===n.peek(2)?I(g.LESS_THAN_OR_EQUAL,n.pos,n.take(2)):I(g.LESS_THAN,n.pos,n.shift());else if("&"===t&&"&&"===n.peek(2))i=I(g.AND,n.pos,n.take(2));else if("|"===t&&"||"===n.peek(2))i=I(g.OR,n.pos,n.take(2));else if(">"===t)i=">="===n.peek(2)?I(g.GREATER_THAN_OR_EQUAL,n.pos,n.take(2)):I(g.GREATER_THAN,n.pos,n.shift());else if("="===t)i="==="===n.peek(3)?I(g.TRIPPLE_EQUELS,n.pos,n.take(3)):"=="===n.peek(2)?I(g.DOUBLE_EQUALS,n.pos,n.take(2)):I(g.EQUALS,n.pos,n.shift());else if(":"===t)i=I(g.COLON,n.pos,n.shift());else if(";"===t)i=I(g.SEMICOLON,n.pos,n.shift());else if("@"===t)i=I(g.AT,n.pos,n.shift());else if(","===t)i=I(g.COMMA,n.pos,n.shift());else if("'"===t)i=I(g.SINGLE_QUOTE,n.pos,n.shift());else if("#"===t)i=I(g.HASH,n.pos,n.shift());else if("!"===t)i="!=="===n.peek(3)?I(g.NOT_DOUBLE_EQUALS,n.pos,n.take(3)):"!="===n.peek(2)?I(g.NOT_EQUALS,n.pos,n.take(2)):I(g.BANG,n.pos,n.shift());else if("/"===t){if("/*"===n.peek(2)){n.match(/.*?\*\//);continue}i=I(g.BACKSLASH,n.pos,n.shift())}else if("."===t)i=/\.\d/.test(n.peek(2))?V(n):I(g.PERIOD,n.pos,n.shift());else if('"'===t)i=I(g.DOUBLE_QUOTE,n.pos,n.shift());else if("+"===t)i=I(g.PLUS,n.pos,n.shift());else if("-"===t)i=/\-\d/.test(n.peek(2))?V(n):I(g.MINUS,n.pos,n.shift());else if("*"===t)i=I(g.STAR,n.pos,n.shift());else if("%"===t)i=I(g.PERCENT,n.pos,n.shift());else if("["===t)i=I(g.BRACKET_OPEN,n.pos,n.shift());else if("]"===t)i=I(g.BRACKET_CLOSE,n.pos,n.shift());else if("("===t)i=I(g.PAREN_OPEN,n.pos,n.shift());else if(")"===t)i=I(g.PAREN_CLOSE,n.pos,n.shift());else if("{"===t)i=I(g.CURLY_BRACKET_OPEN,n.pos,n.shift());else if("}"===t)i=I(g.CURLY_BRACKET_CLOSE,n.pos,n.shift());else if(/\d/.test(t))i=V(n);else if(/[\s\r\n\t]/.test(t))i=I(g.WHITESPACE,n.pos,n.scan(/[\s\r\n\t]/));else{var u=n.pos,s=n.scan(/[^-<>,='":@;\.\/\\(){}\[\]\s\r\n\t]/)||n.shift();i=I("undefined"===s||"null"===s||"true"===s||"false"===s?g.RESERVED_KEYWORD:g.TEXT,u,s)}r.push(i)}return new w(e,r)},V=function(e){return I(g.NUMBER,e.pos,e.match(/^\-?(\d+(\.\d+)?|\.\d+)/))},G="undefined"!=typeof window&&window.cache?window.cache.parseModuleSource||(window.cache.parseModuleSource={}):{},k=function(e,n){if(G[e])return G[e];var r={source:e,filePath:n,scanner:Y(e),diagnostics:[]},t=$(r);return G[e]={root:i({},t,{input:e}),diagnostics:r.diagnostics}},H=function(e,n){if(G[e])return G[e];var r={source:e,scanner:Y(e),filePath:n,diagnostics:[]},t=_e(r);return G[e]={root:t,diagnostics:r.diagnostics}},$=function(n){for(var r=n.scanner,t=[];!r.ended();){var i=F(n);if(!i)return null;t.push(i)}return 1===t.length?t[0]:{type:e.PCExpressionType.FRAGMENT,location:B(0,r.source.length,r.source),childNodes:t}},F=function(e){if(!Pe(e))return null;var n=e.scanner;switch(n.curr().type){case g.WHITESPACE:return Le(e);case g.LESS_THAN:return Se(e);case g.CLOSE_TAG:return Re(e);case g.COMMENT:return Te(e);default:return fe(n)?j(e,W):Le(e)}},j=function(n,r){var t=n.scanner,i=t.curr();t.next(),t.next(),me(n);var o=r(n);return o?(me(n),Me(n,[g.BRACKET_CLOSE],null,B(i,t.curr(),n.source))?(t.next(),Me(n,[g.BRACKET_CLOSE],"Missing closing ] character.",D(i,n.source))?(t.next(),{type:e.PCExpressionType.BLOCK,location:B(i,t.curr(),t.source),value:o}):null):null):null},Q=function(n){var r=n.scanner;switch(r.curr().value){case"bind":return ae(n);case"repeat":return ce(n);case"if":return se(n,e.BKExpressionType.IF);case"elseif":return se(n,e.BKExpressionType.ELSEIF);case"else":return se(n,e.BKExpressionType.ELSE);case"property":return ue(n,e.BKExpressionType.PROPERTY);default:return Ie(n,"Unexpected block type "+r.curr().value+"."),null}},W=function(e){var n=e.scanner;switch(n.curr().value){case"bind":return ae(e);case"elseif":case"else":case"if":return Ie(e,"Condition blocks can only be added to elements, for example: <div [[if condition]]></div>."),null;case"repeat":return Ie(e,"Repeat blocks can only be added to elements, for example: <div [[repeat items in item, i]]></div>."),null;default:return Ie(e,"Unexpected block type "+n.curr().value+"."),null}},X=function(e){var n=e.scanner;switch(n.curr().value){case"bind":return ae(e);case"elseif":case"else":case"if":return Ie(e,"Condition blocks cannot be assigned to attributes."),null;case"repeat":return Ie(e,"Repeat blocks cannot be assigned to attributes."),null;default:return Ie(e,"Unexpected block type "+n.curr().value+"."),null}},J=function(e){return q(e)},q=function(n){if(!Pe(n))return null;var r=n.scanner,t=z(n);me(n);var i=r.curr(),o=i?i.type:-1;if(!(o===g.AND||o===g.OR||o==g.PLUS||o===g.MINUS||o===g.STAR||o===g.BACKSLASH||o===g.DOUBLE_EQUALS||o===g.TRIPPLE_EQUELS||o===g.GREATER_THAN||o===g.LESS_THAN||o===g.LESS_THAN_OR_EQUAL||o===g.GREATER_THAN_OR_EQUAL||o===g.NOT_EQUALS||o===g.NOT_DOUBLE_EQUALS))return t;r.next(),me(n);var a=q(n);return a?{type:e.BKExpressionType.OPERATION,left:t,right:a,operator:i.value,location:B(t.location.start,a.location.end,r.source)}:null},z=function(e){var n=e.scanner;switch(me(e),n.curr().type){case g.BANG:return le(e);case g.SINGLE_QUOTE:case g.DOUBLE_QUOTE:return Z(e);case g.NUMBER:return ee(e);case g.CURLY_BRACKET_OPEN:return ne(e);case g.BRACKET_OPEN:return re(e);case g.PAREN_OPEN:return ie(e);case g.TEXT:return Ee(e);case g.RESERVED_KEYWORD:return oe(e);default:return Ie(e),null}},Z=function(n){var r=n.scanner,t=r.curr();r.next();for(var i="";!r.ended();){var o=r.curr();if(o.value===t.value)break;"\\"!==o.value?(i+=o.value,r.next()):(i+=r.next().value,r.next())}return Ae(n,t)?(r.next(),{type:e.BKExpressionType.STRING,location:B(t,r.curr(),r.source),value:i}):null},ee=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.NUMBER,value:t.value,location:B(t,r.curr(),r.source)}},ne=function(n){var r=n.scanner,t=r.curr();r.next();for(var i=[];!r.ended()&&(me(n),r.curr().type!==g.CURLY_BRACKET_CLOSE);){var o=te(n);if(!o)return null;i.push(o),me(n);var a=r.curr();if(a.type!==g.CURLY_BRACKET_CLOSE){if(a.type!==g.COMMA&&a)return Ie(n),null;r.next()}}return r.next(),{type:e.BKExpressionType.OBJECT,location:B(t,r.curr(),r.source),properties:i}},re=function(n){var r=n.scanner,t=r.curr();r.next(),me(n);var i=[];if(r.curr().type!==g.BRACKET_CLOSE)for(;;){if(i.push(z(n)),me(n),r.curr().type===g.BRACKET_CLOSE)break;if(!Me(n,[g.COMMA],"Missing , delimiter in array.",B(t,r.curr(),n.source)))return null;r.next()}return r.next(),{type:e.BKExpressionType.ARRAY,location:B(t,r.curr(),r.source),values:i}},te=function(n){var r,t=n.scanner;switch(t.curr().type){case g.SINGLE_QUOTE:case g.DOUBLE_QUOTE:r=Z(n);break;default:r=pe(n)}if(me(n),!Me(n,[g.COLON],"Missing : for object."))return null;t.next(),me(n);var i=J(n);return{type:e.BKExpressionType.KEY_VALUE_PAIR,location:B(r.location.start,i.location.end,t.source),key:r.name,value:i}},ie=function(n){var r=n.scanner,t=r.curr();r.next();var i=J(n);return r.next(),{type:e.BKExpressionType.GROUP,value:i,location:B(t,r.curr(),r.source)}},oe=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.RESERVED_KEYWORD,value:t.value,location:B(t,r.curr(),r.source)}},ae=function(n){var r=n.scanner,t=r.curr();r.next(),r.next(),n.startToken=t;var i=J(n);return n.startToken=void 0,i?{type:e.BKExpressionType.BIND,value:i,location:B(t,r.curr(),r.source)}:null},ue=function(e,n){var r=e.scanner,t=r.curr();return r.next(),r.next(),{type:n,name:pe(e).name,location:B(t,r.curr(),r.source)}},se=function(e,n){var r=e.scanner,t=r.curr();return r.next(),me(e),{type:n,condition:r.curr().type!==g.BRACKET_CLOSE?J(e):null,location:B(t,r.curr(),r.source)}},ce=function(n){var r=n.scanner,t=r.curr();if(r.next(),me(n),!Me(n,[g.TEXT],"Repeat block missing collection parameter.",D(t,n.source)))return null;var i=J(n);if(me(n),!Me(n,[g.TEXT],null,B(t,r.curr(),n.source)))return null;if("as"!==r.curr().value)return Ie(n,'Repeat block missing "as" keyword.',B(t,r.curr(),n.source)),null;if(r.next(),me(n),!Me(n,[g.TEXT],null,B(t,r.curr(),n.source)))return null;var o,a=pe(n);if(me(n),","===r.curr().value){if(r.next(),me(n),!Me(n,[g.TEXT],"Unexpected token. Repeat index parameter should only contain characters a-zA-Z.",B(t,r.curr(),n.source)))return null;o=pe(n)}return{type:e.BKExpressionType.REPEAT,location:B(t,r.curr(),r.source),each:i,asKey:o,asValue:a}},Ee=function(n){for(var r=n.scanner,t=pe(n),i=[t];!r.ended()&&r.curr().type===g.PERIOD;){if(r.next(),!Me(n,[g.TEXT]))return null;i.push(pe(n))}return 1===i.length?i[0]:{type:e.BKExpressionType.PROP_REFERENCE,path:i,location:B(t.location.start,r.curr(),r.source)}},pe=function(n){var r=n.scanner;me(n);var t=r.curr();return r.next(),{type:e.BKExpressionType.VAR_REFERENCE,name:t.value,location:B(t,r.curr(),r.source)}},le=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.NOT,value:z(n),location:B(t,r.curr(),r.source)}},Te=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.PCExpressionType.COMMENT,value:t.value.substr(4,t.value.length-7),location:B(t,r.curr(),r.source)}},fe=function(e){return e.curr().type===g.BRACKET_OPEN&&e.peek(1).type===g.BRACKET_OPEN},_e=function(n){for(var r=n.scanner,t=r.curr(),i=[];;){if(me(n),r.ended()||r.curr().type===g.CLOSE_TAG)break;var o=ye(n);if(!o)return null;i.push(o)}return{type:e.CSSExpressionType.SHEET,children:i,location:B(t,r.curr(),r.source)}},ye=function(e){switch(e.scanner.curr().type){case g.AT:return de(e);default:return ve(e)}},de=function(n){var r=n.scanner,t=r.curr();r.next();for(var i="";r.curr().type!==g.WHITESPACE&&r.curr().type!==g.CURLY_BRACKET_OPEN;)i+=r.curr().value,r.next();r.next();var o=[],a=[];for(me(n);!r.ended()&&(me(n),r.curr().type!==g.CURLY_BRACKET_OPEN&&r.curr().type!==g.SEMICOLON);)r.curr().type===g.SINGLE_QUOTE||r.curr().type===g.DOUBLE_QUOTE?o.push(Z(n).value):(o.push(r.curr().value),r.next());var u=r.curr();if(r.next(),u.type===g.CURLY_BRACKET_OPEN){for(;!r.ended()&&(me(n),r.curr().type!==g.CURLY_BRACKET_CLOSE);){var s=ye(n);if(!s)return null;a.push(s)}if(!Me(n,[g.CURLY_BRACKET_CLOSE],"Missing closing } character.",D(t,n.source)))return null;r.next()}return{type:e.CSSExpressionType.AT_RULE,name:i,params:o,children:a,location:B(t,r.curr(),r.source)}},ve=function(n){for(var r=n.scanner,t=r.curr(),i="";!r.ended();){var o=r.curr();if(o.type==g.CURLY_BRACKET_OPEN||o.type===g.SEMICOLON||o.type===g.CURLY_BRACKET_CLOSE||o.type===g.CLOSE_TAG)break;o.type===g.SINGLE_QUOTE||o.type===g.DOUBLE_QUOTE?i+=o.value+Z(n).value+o.value:(i+=o.value,r.next())}if(!Me(n,[g.SEMICOLON,g.CURLY_BRACKET_OPEN,g.CURLY_BRACKET_CLOSE]))return null;if(r.curr().type===g.SEMICOLON||r.curr().type===g.CURLY_BRACKET_CLOSE){var a=i.match(/(.+?):(.+)/),u=(a[0],a[1]),s=a[2];return r.curr().type===g.SEMICOLON&&r.next(),{type:e.CSSExpressionType.DECLARATION_PROPERTY,location:B(t,r.curr(),r.source),name:u,value:s}}r.next();var c=[];for(me(n);!r.ended()&&r.curr().type!==g.CURLY_BRACKET_CLOSE;){var E=ve(n);if(!E)return null;c.push(E),me(n)}return Me(n,[g.CURLY_BRACKET_CLOSE],"Missing closing } character.",D(t,n.source))?(r.next(),i=i.trim(),{type:e.CSSExpressionType.STYLE_RULE,children:c,selectorText:i,location:B(t,r.curr(),r.source)}):null},Re=function(n){var r=n.scanner,t=r.curr();r.next();var i=ge(n);return i?Me(n,[g.GREATER_THAN],"Missing > character.",B(t,r.curr(),n.source))?(r.next(),{type:e.PCExpressionType.END_TAG,name:i,location:B(t,r.curr(),r.source)}):null:(Ie(n,"Missing close tag name.",D(t,n.source)),null)},Se=function(n){var r=n.scanner,t=r.curr();r.next();var i=ge(n);if(!i)return Ie(n,"Missing open tag name.",D(t,n.source)),null;if(!r.ended()&&!Me(n,[g.WHITESPACE,g.GREATER_THAN],'Tag name contains a character where " " or > is expected.',D(t,n.source)))return null;for(var o=[],a=[];!r.ended();){me(n);var u=r.curr();if(u.type===g.BACKSLASH||u.type==g.GREATER_THAN)break;if(fe(r)){var s=j(n,Q);if(!s)return null;a.push(s)}else{if(u.type!==g.TEXT)return Ie(n),null;var c=Ce(n);if(!c)return null;o.push(c)}}if(!Pe(n))return null;if(r.curr().type===g.BACKSLASH)return r.next(),r.next(),{type:e.PCExpressionType.SELF_CLOSING_ELEMENT,name:i,attributes:o,modifiers:a,location:B(t,r.curr(),r.source)};r.next();var E=r.curr(),p=Ne(i,n);if(!p)return null;var l=p[0],T=p[1];return T?{type:e.PCExpressionType.ELEMENT,startTag:{name:i,type:e.PCExpressionType.START_TAG,location:B(t,E,r.source),modifiers:a,attributes:o},childNodes:l,location:B(t,r.curr(),r.source),endTag:T}:(Ie(n,"Close tag is missing.",B(t,E,n.source)),null)},Ne=function(n,r){var t=r.scanner,i=[];if("style"===n){var o=_e(r);if(!o)return null;if(me(r),!Me(r,[g.CLOSE_TAG]))return null;var a=Re(r);return a?[[o],a]:null}if("style"===n||"script"===n){for(var u="",s=t.curr();!t.ended()&&t.curr().type!==g.CLOSE_TAG;)u+=t.curr().value,t.next();return[[{type:e.PCExpressionType.TEXT_NODE,value:u,location:B(s,t.curr(),t.source)}],F(r)]}for(var c;!t.ended();){var E=F(r);if(!E)return null;if(E.type===e.PCExpressionType.END_TAG){c=E;break}i.push(E)}return[i,c]},Ce=function(n){var r,t=n.scanner,i=t.curr(),o=ge(n);return t.curr().type!==g.EQUALS||(t.next(),r=he(n))?{type:e.PCExpressionType.ATTRIBUTE,name:o,value:r,location:B(i,t.curr(),t.source)}:null},he=function(e){if(!Pe(e))return null;var n=e.scanner;switch(n.curr().type){case g.SINGLE_QUOTE:case g.DOUBLE_QUOTE:return Oe(e);default:return fe(n)?j(e,X):(Ie(e),null)}},Ae=function(e,n){return Me(e,[n.type],"Missing closing "+n.value+" character.",D(n,e.source))},Oe=function(n){var r=n.scanner,t=r.curr(),i=[],o=!1;for(r.next();!r.ended();){var a=r.curr();if(a.type===t.type)break;if(fe(r)){o=!0;var u=j(n,X);if(!u)return null;i.push(u)}else r.next(),i.push({type:e.PCExpressionType.STRING,value:a.value,location:B(a.pos,r.curr(),r.source)})}if(!Ae(n,t))return null;r.next();var s=B(t,r.curr(),r.source);return o?{type:e.PCExpressionType.STRING_BLOCK,location:s,values:i}:{type:e.PCExpressionType.STRING,location:s,value:i.map(function(e){return e.value}).join("")}},Le=function(n){var r=n.scanner,t=r.curr();r.next();for(var i=t.value;!r.ended();){var o=r.curr();if(o.type===g.COMMENT||o.type===g.LESS_THAN||o.type==g.CLOSE_TAG||fe(r))break;r.next(),i+=o.value}return{type:e.PCExpressionType.TEXT_NODE,value:i,location:B(t,r.curr(),r.source)}},me=function(e){for(var n=e.scanner;!n.ended()&&n.curr().type===g.WHITESPACE;)n.next()},ge=function(e){for(var n=e.scanner,r="";!n.ended()&&/[a-zA-Z-][a-zA-Z0-9-]*/.test(n.curr().value);)r+=n.curr().value,n.next();return r||null},xe=function(e,n){if(!n)throw new Error("Unexpected end of file (missing closing expression).");var r=U(n,e);throw new Error('Unexpected token "'+n.value+'" at '+r.line+":"+r.column)},Ie=function(n,r,t){var i=n.scanner.curr(),o=t||(n.startToken?B(n.startToken,n.scanner.curr(),n.source):{start:U(i||n.scanner.source.length-1,n.scanner.source),end:U(i?i.pos+i.value.length:n.scanner.source.length,n.scanner.source)});return n.diagnostics.push({type:e.DiagnosticType.ERROR,location:o,message:r||(i?"Unexpected token.":"Unexpected end of file."),filePath:n.filePath}),!0},Pe=function(e,n,r){return!!e.scanner.curr()||(Ie(e,n,r),!1)},Me=function(e,n,r,t){var i=e.scanner.curr();return!(!i||-1===n.indexOf(i.type))||(Ie(e,r,t),!1)};!function(e){e.TANDEM="TANDEM",e.WEB="WEB"}(e.PaperclipTargetType||(e.PaperclipTargetType={}));var Ue=Symbol(),Be=function(e,n){if(e[Ue]&&e[Ue][0]===e)return e[Ue][1];var r=$e(e,n);return e[Ue]=[e,r],r},De=function(e,n){var r=n.split("/");r.pop();var t=(e=e.replace("./","")).split("../"),i=t.pop();return r.splice(r.length-t.length,r.length),r.join("/")+"/"+i},be=function(e,n){var r={};return m(e).forEach(function(e){var t=ke(e,n);t&&(r[e]=t)}),r},Ke=function(e){var n={};for(var r in e)for(var t=0,i=e[r].module.components;t<i.length;t++){var o=i[t];n[o.id]={filePath:r,expression:o.source}}return n},we=function(e,n){var r={};return e.module.components.forEach(function(e){Object.assign(r,be(e.template,n))}),r},Ye=function(e,n){return n.components.find(function(n){return n.id===e})},Ve=function(e,n){var r=[],t=(we(e,n),we(e,n));for(var i in t){var o=t[i];-1===r.indexOf(o)&&r.push(o)}return r},Ge=function(e,n){var r=e.resolvedImportUris,t=[];for(var i in r)t.push(n[r[i]]);return t},ke=function(e,n){for(var r in n)for(var t=n[r],i=0,o=t.module.components.length;i<o;i++)if(t.module.components[i].id===e)return t},He=function(e,n,r,t){var i=n.readFile,o=n.resolveFile,a=void 0===o?De:o;return void 0===r&&(r={}),void 0===t&&(t=[]),r[e]?Promise.resolve({diagnostics:t,graph:r}):Promise.resolve(i(e)).then(k).then(function(n){return t.push.apply(t,n.diagnostics),Be(n.root,e)}).then(function(n){var o={};return r[e]={module:n,resolvedImportUris:o},n.imports.length?Promise.all(n.imports.map(function(n){return Promise.resolve(a(n.href,e)).then(function(e){return o[n.href]=e,He(e,{readFile:i,resolveFile:a},r,t)})})):Promise.resolve(r)}).then(function(){return{graph:r,diagnostics:t}})},$e=function(n,r){for(var t=n.type===e.PCExpressionType.FRAGMENT?n.childNodes:[n],i=[],u=[],E=[],p=[],l=0,T=t.length;l<T;l++){var f=t[l];if(f.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||f.type===e.PCExpressionType.ELEMENT){var _=f,y=a(_),d=o(_),v=s(_),R=c(_);if("component"===y&&_.type===e.PCExpressionType.ELEMENT){u.push(We(_,R,v,d));continue}if("link"===y){i.push(Xe(v));continue}if("style"===y){E.push(_);continue}}p.push(f)}return{source:n,uri:r,imports:i,components:u,globalStyles:E,unhandledExpressions:p}},Fe=function(e){for(var n={},r=0,t=e.split(/,\s+/g);r<t.length;r++){var i=t[r].split("="),o=i[0],a=i[1];n[o]=a}return n},je=function(e,n){return e.metadata.filter(function(e){return e.name===n})},Qe=function(e,n){return je(e,n).shift()},We=function(n,r,t,i){for(var c,E,p,l=[],f=[],_=0,y=t.length;_<y;_++){var d=t[_];"id"===d.name&&(c=u(d))}for(var _=0,y=i.length;_<y;_++){var v=i[_];if(v.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||v.type===e.PCExpressionType.ELEMENT){var R=v,S=a(R);s(R),o(R);"style"===S?E=R:"template"===S?p=R:"preview"===S&&v.type===e.PCExpressionType.ELEMENT?l.push(R):"meta"===S&&f.push({name:T(R,"name"),params:Fe(T(R,"content")||"")})}}return{source:n,id:c,style:E,metadata:f,template:p,previews:l}},Xe=function(e){for(var n,r,t=0,i=e.length;t<i;t++){var o=e[t];"href"===o.name?n=u(o):"type"===o.name&&(r=u(o))}return{type:r,href:n}},Je=function(e){var n=Symbol();return function(r){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return r[n]?r[n]:r[n]=e.apply(void 0,[r].concat(t))}};!function(e){e[e.OBJECT=1]="OBJECT",e[e.ARRAY=2]="ARRAY",e[e.STRING=4]="STRING",e[e.NUMBER=8]="NUMBER",e[e.BOOLEAN=16]="BOOLEAN",e[e.PRIMITIVE=28]="PRIMITIVE",e[e.ANY=31]="ANY",e[e.OBJECT_OR_ARRAY=3]="OBJECT_OR_ARRAY"}(e.InferenceType||(e.InferenceType={}));var qe={a:{href:e.InferenceType.STRING},__any:{class:e.InferenceType.STRING}},ze=function(){return{type:e.InferenceType.ANY,properties:{}}},Ze=ze(),en=Je(function(e,n,r){void 0===r&&(r={});var t=rn(e,nn(n,r));return{diagnostics:t.diagnostics,inference:t.inference}}),nn=function(n,r){return{filePath:n,options:r,inference:ze(),diagnostics:[],currentScopes:{},typeLimit:e.InferenceType.ANY}},rn=function(n,r){switch(n.type){case e.PCExpressionType.BLOCK:return ln(n,r);case e.PCExpressionType.FRAGMENT:return En(n,r);case e.PCExpressionType.SELF_CLOSING_ELEMENT:case e.PCExpressionType.ELEMENT:return un(n,r)}return r},tn=function(n,r){for(var t=n.attributes,i=(n.name,n.modifiers),o=0,a=t.length;o<a;o++)r=on(n,t[o],dn(e.InferenceType.ANY,null,r));for(var o=0,a=i.length;o<a;o++){var u=i[o].value;u.type!==e.BKExpressionType.IF&&u.type!==e.BKExpressionType.ELSEIF&&u.type!==e.BKExpressionType.BIND||(r=Tn(u,dn(e.InferenceType.ANY,null,r)))}return r},on=function(e,n,r){n.name;var t=n.value;return t&&(r=an(e,t,r)),r},an=function(n,r,t){switch(r.type){case e.PCExpressionType.STRING:return t;case e.PCExpressionType.STRING_BLOCK:for(var i=0,o=(a=r).values.length;i<o;i++)t=an(n,a.values[i],dn(e.InferenceType.STRING,null,t));return t;case e.PCExpressionType.BLOCK:var a=r;return Tn(a.value,t)}return t},un=function(n,r){var t,i=[];if(n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT)i=[],t=n;else{var o=n;i=o.childNodes,t=o.startTag}if(r.options.ignoreTagNames&&-1!==r.options.ignoreTagNames.indexOf(t.name))return r;for(var a,u=t.modifiers,s=0,c=u.length;s<c;s++){var E=u[s].value;if(E.type===e.BKExpressionType.REPEAT&&sn(E.each)){a=E;break}}return a&&(r=Tn(a,r),r=hn(a.asValue.name,cn(a.each).concat(["$$each"]),r)),r=tn(t,r),r=pn(i,r),a&&(r=On(a.asValue.name,r)),r},sn=function(n){return n.type===e.BKExpressionType.VAR_REFERENCE||n.type===e.BKExpressionType.PROP_REFERENCE},cn=function(n){return n.type===e.BKExpressionType.VAR_REFERENCE?[n.name]:n.path.map(function(e){return e.name})},En=function(e,n){return pn(e.childNodes,n)},pn=function(e,n){for(var r=0,t=e.length;r<t;r++)n=rn(e[r],n);return n},ln=function(n,r){return Tn(n.value,dn(e.InferenceType.ANY,null,r))},Tn=function(n,r){switch(n.type){case e.BKExpressionType.NUMBER:return mn(e.InferenceType.NUMBER,r)?dn(e.InferenceType.NUMBER,null,r):gn(n,e.InferenceType.NUMBER,r);case e.BKExpressionType.STRING:return mn(e.InferenceType.STRING,r)?dn(e.InferenceType.STRING,null,r):gn(n,e.InferenceType.NUMBER,r);case e.BKExpressionType.OPERATION:var t=n,i=t.left,o=t.operator,a=t.right,u=/^[\*\/\-%]$/.test(o)?e.InferenceType.NUMBER:r.typeLimit;return mn(u,r)?(r=Tn(i,dn(u,"The left-hand side of an arithmetic operation must be "+Sn(u),r)),r=Tn(a,"==="!==o?dn(u,"The right-hand side of an arithmetic operation must be "+Sn(r.typeLimit),r):r)):gn(n,u,r);case e.BKExpressionType.GROUP:l=n.value;return Tn(l,r);case e.BKExpressionType.VAR_REFERENCE:case e.BKExpressionType.PROP_REFERENCE:return fn(n,cn(n),r);case e.BKExpressionType.BIND:l=n.value;return Tn(l,r);case e.BKExpressionType.OBJECT:for(var s=n.properties,c=0,E=s.length;c<E;c++){var p=s[c],l=(p.key,p.value);r=Tn(l,dn(e.InferenceType.ANY,null,r))}return dn(e.InferenceType.OBJECT,null,r);case e.BKExpressionType.NOT:l=n.value;return dn(e.InferenceType.BOOLEAN,null,Tn(l,dn(e.InferenceType.ANY,null,r)));case e.BKExpressionType.ELSEIF:case e.BKExpressionType.IF:var T=n.condition;return Tn(T,r);case e.BKExpressionType.REPEAT:var f=n.each;return Tn(f,r);default:return r}},fn=function(e,n,r){var t=yn(n,r)&r.typeLimit;return mn(t,r)?dn(t,r.typeLimitErrorMessage,Cn(e,n,t,r)):xn(e,r)},_n=function(e,n){for(var r=n.inference,t=An(e,n),i=0,o=t.length;i<o;i++)if(!(r=r.properties[t[i]]))return null;return r},yn=function(n,r,t){void 0===t&&(t=e.InferenceType.ANY);var i=_n(n,r);return i?i.type:t},dn=function(e,n,r){return i({},r,{typeLimit:e,typeLimitErrorMessage:n})},vn=function(n,r,t,o){return void 0===o&&(o=-1),o++,o===n.length?i({},t,r):i({},t,{type:t.type&e.InferenceType.OBJECT_OR_ARRAY,properties:i({},t.properties,(a={},a[n[o]]=vn(n,r,t.properties[n[o]]||ze(),o),a))});var a},Rn=function(n){var r=[];return n&e.InferenceType.ARRAY&&r.push("array"),n&e.InferenceType.OBJECT&&r.push("object"),n&e.InferenceType.STRING&&r.push("string"),n&e.InferenceType.NUMBER&&r.push("number"),n&e.InferenceType.BOOLEAN&&r.push("boolean"),r},Sn=function(e){var n=Rn(e);return 1===n.length?"a "+n[0]:"an "+n.slice(0,n.length-1).join(", ")+", or "+n[n.length-1]},Nn=function(n,r,t){for(var i=t.inference,o=0,a=n.length;o<a-1;o++){if(!(i=i.properties[n[o]]))return t;i.type&e.InferenceType.OBJECT_OR_ARRAY||(t=xn(r,dn(t.typeLimit,null,t),'Cannot call property "'+n.slice(o+1).join(".")+'" on primitive "'+n.slice(0,o+1).join(".")+'"'))}return t},Cn=function(e,n,r,t){return t=Nn(n,e,t),Ln(vn(An(n,t),{type:r},t.inference),t)},hn=function(e,n,r){return i({},r,{currentScopes:i({},r.currentScopes,(t={},t[e]=n,t))});var t},An=function(e,n){var r=n.currentScopes[e[0]];return r?An(r,n).concat(e.slice(1)):e},On=function(e,n){return i({},n,{currentScopes:i({},n.currentScopes,(r={},r[e]=null,r))});var r},Ln=function(e,n){return i({},n,{inference:e})},mn=function(e,n){var r=n.typeLimit;return Boolean(e&r)},gn=function(e,n,r){return xn(e,r,"Type mismatch "+n+" to "+r.typeLimit)},xn=function(n,r,t){return In(n,e.DiagnosticType.ERROR,r,t)},In=function(n,r,t,o){return i({},t,{diagnostics:t.diagnostics.concat([{type:e.DiagnosticType.ERROR,location:n.location,message:t.typeLimitErrorMessage||o,filePath:t.filePath}])})},Pn=function(e,n){return He(e,n.io).then(function(n){var r=n.graph;return{code:Bn(e,r),graph:r,entryDependency:r[e]}})},Mn=function(n){switch(n.type){case e.BKExpressionType.NOT:return"!"+Mn(n.value);case e.BKExpressionType.PROP_REFERENCE:return(t=n).path.map(Mn).join(".");case e.BKExpressionType.STRING:var r=n;return JSON.stringify(r.value);case e.BKExpressionType.NUMBER:return n.value;case e.BKExpressionType.VAR_REFERENCE:var t=n;return t.name;case e.BKExpressionType.ARRAY:return"["+n.values.map(Mn)+"]";case e.BKExpressionType.OBJECT:for(var i=n,o="{",a=0,u=i.properties.length;a<u;a++){var s=i.properties[a];o+=s.key+":"+Mn(s.value)+", "}return o+="}";case e.BKExpressionType.GROUP:return"("+Mn(n.value)+")";case e.BKExpressionType.RESERVED_KEYWORD:return n.value;case e.BKExpressionType.OPERATION:var c=n,E=c.left,p=c.operator,l=c.right;return Mn(E)+" "+p+" "+Mn(l);default:throw new Error("Unable to transpile BK block "+n.type)}},Un=function(e){return e.replace(/[\d-]+/g,"_")},Bn=function(e,n){var r="((window) => {";r+='var document = window.document;const __each = (object, iterator) => {if (Array.isArray(object)) {object.forEach(iterator);} else {for (const key in object) {iterator(object[key], key);}}};const __count = (object) => {return Array.isArray(object) ? object.length : Object.keys(object).length;};const __defineModule = (run) => {let exports;return () => {if (exports) return exports;exports = {};return exports = run((dep) => {return $$modules[dep]()});}};const __setElementProperty = (element, property, value) => {if (property === "style" && typeof value !== "string") {\nelement.style = "";\nObject.assign(element.style, value);\n} else {\nelement[property] = value;}\n};let updating = false;let toUpdate = [];const __requestUpdate = (object) => {if (toUpdate.indexOf(object) === -1) {toUpdate.push(object);}if (updating) {return;}updating = true;requestAnimationFrame(function() {for(let __i = 0; i < toUpdate.length; __i++) {const target = toUpdate[__i];target.update();}toUpdate = [];updating = false;});};',r+="$$modules = {};";for(var t in n)r+='$$modules["'+t+'"] = '+Dn(n[t].module,n[t].resolvedImportUris)+";";return r+='const entry = $$modules["'+e+'"]();',r+="return {entry,modules: $$modules};})(window)"},Dn=function(e,n){var r=e.source,t=e.imports,i=e.globalStyles,o=e.components,a=(e.unhandledExpressions,{uri:e.uri,aliases:{},varCount:0,root:r}),u="__defineModule((require) => {";u+="var $$previews = {};";for(var s=lr(i,a),c=0,E=s.length;c<E;c++)u+=(l=s[c]).content,u+="document.body.appendChild("+l.varName+");";for(var c=0,E=t.length;c<E;c++){var p=t[c],l=fr("import","require("+JSON.stringify(n[p.href])+")",a);u+=l.content}for(var c=0,E=o.length;c<E;c++)u+=Kn(o[c],a).content;return u+="return {previews: $$previews};",u+="})"},bn=function(e){return"(() => { const binding = () => { "+e+" }; binding(); return binding; })()"},Kn=function(n,r){var t=n.previews,o=n.source,a=n.id,u=n.style,s=n.template,c=_r(Un(a),r),E=i({},r,{varCount:0,contextName:"this"}),p=Object.keys(en(o).inference.properties),l=u&&Wn(u,E),f="class "+c+" extends HTMLElement {constructor() {super();this.__bindings = [];}connectedCallback() {this.render();}"+p.map(function(e){return"get "+e+"() {return this.__"+e+";}set "+e+"(value) {if (this.__"+e+" === value || String(this.__"+e+") === String(value)) {return;}const oldValue = this.__"+e+";this.__"+e+' = value;if (typeof value !== "object") {this.setAttribute('+JSON.stringify(e)+", value);}if (this._rendered) {__requestUpdate(this);}}"}).join("\n")+'render() {if (this._rendered) {return;}this._rendered = true;const shadow = this.attachShadow({ mode: "open" });'+(l?l.content+"shadow.appendChild("+l.varName+");":"")+p.map(function(e){return"if (this.__"+e+" == null) {this.__"+e+' = this.getAttribute("'+e+'");}'}).join("\n")+"let __bindings = [];"+(s?s.childNodes.map(function(e){var n=wn(e,E);return e&&n?n.content+(n.bindings.length?"__bindings = __bindings.concat("+n.bindings.map(function(e){return"(() => {const __binding = () => {const { "+p.join(",")+" } = this;"+e+"};__binding();return __binding;})()"})+");":"")+"shadow.appendChild("+n.varName+");":""}).join(""):"")+"this.__bindings = __bindings;}cloneShallow() {const clone = super.cloneShallow();clone._rendered = true;return clone;}static get observedAttributes() {return "+JSON.stringify(p)+";}attributeChangedCallback(name, oldValue, newValue) {if (super.attributeChangedCallback) {super.attributeChangedCallback(name, oldValue, newValue);}this[name] = newValue;}update() {if (!this._rendered) {return;}let bindings = this.__bindings || [];"+jn("bindings")+'}}if (!customElements.get("'+a+'")) {customElements.define("'+a+'", '+c+');} else {console.error("Custom element \\"'+a+'\\" is already defined, ignoring");}';return f+='$$previews["'+a+'"] = {};',t.forEach(function(n,t){T(n,"name");var o=n.childNodes.find(function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||n.type===e.PCExpressionType.ELEMENT});if(o){var u=wn(o,i({},r,{aliases:i({},r.aliases,{preview:a})}));f+='$$previews["'+a+'"]["'+t+'"] = () => {'+u.content+"return "+u.varName+";};"}}),{varName:c,bindings:[],content:f}},wn=function(n,r){switch(n.type){case e.PCExpressionType.FRAGMENT:return Yn(n,r);case e.PCExpressionType.TEXT_NODE:return Vn(n,r);case e.PCExpressionType.BLOCK:return Gn(n,r);case e.PCExpressionType.ELEMENT:return Qn(n,r);case e.PCExpressionType.SELF_CLOSING_ELEMENT:return kn(n,r)}return null},Yn=function(e,n){return yr('document.createDocumentFragment("")',n)},Vn=function(e,n){return Rr(yr("document.createTextNode("+JSON.stringify(e.value.replace(/[\s\r\n\t]+/g," "))+")",n),e,n)},Gn=function(e,n){var r=yr('document.createTextNode("")',n),t=(r=Rr(r,e,n)).varName+"$$currentValue";return r.content+="let "+t+";",r.bindings.push(Fn(t,Mn(e.value.value),function(e){return r.varName+".nodeValue = "+e},n)),r},kn=function(e,n){return Hn(e,Rr($n(e,n),e,n),n)},Hn=function(n,r,t){if(!n.modifiers.length)return r;for(var i,o,a,u,s,c=n.modifiers,p=r,l=0,T=c.length;l<T;l++)(M=c[l].value).type===e.BKExpressionType.IF?i=M:M.type===e.BKExpressionType.ELSE?o=M:M.type===e.BKExpressionType.ELSEIF?a=M:M.type===e.BKExpressionType.REPEAT?u=M:M.type===e.BKExpressionType.BIND&&(s=M);if(s){var f=s.value,_=(p={varName:r.varName,content:r.content,bindings:r.bindings.slice()}).varName+"$$spreadValue",y=Mn(f);p.content+="let "+_+";",p.bindings.push(Fn(_,y,function(e){return"for (const __key in "+_+") {__setElementProperty("+r.varName+", __key, "+_+"[__key]);}"},t)),r=p}if(u){var d=u.each,v=u.asKey,R=u.asValue,S=Mn(d),N=v?Mn(v):"index",A=Mn(R),O=vr(t),m=O.fragment,g=O.start,x=O.end,I=(p=m).varName+"$$currentValue",P=p.varName+"$$childBindings";p.content+="let "+I+" = [];let "+P+" = [];",p.bindings.push("let $$newValue = ("+S+") || [];if ($$newValue === "+I+") {return;}const $$oldValue = "+I+";"+I+" = $$newValue;const $$parent = "+g.varName+".parentNode;const $$startIndex = Array.prototype.indexOf.call($$parent.childNodes, "+g.varName+"); const $$newValueCount = __count($$newValue);const $$oldValueCount = __count($$oldValue);if ($$newValueCount > $$oldValueCount) {for (let __i = $$newValueCount - $$oldValueCount; __i--;) {"+r.content+"$$parent.insertBefore("+r.varName+", "+x.varName+");const __bindings = ["+r.bindings.map(function(e){return"("+A+", "+N+") => { "+e+"}"}).join(",")+"];"+P+".push(($$newValue, $$newKey) => {"+jn("__bindings","$$newValue, $$newKey")+"});}} else if ($$oldValue.length < $$newValue.length) {}let __i = 0;__each($$newValue, (value, k) => {"+P+"[__i++](value, k);});"),r=p}if(i||a||o){for(var M=i||a||o,U=M.condition,B=t.root===n||t.root.startTag===n?[t.root]:L(t.root,n).childNodes,D=B.findIndex(function(r){return r===n||n.type===e.PCExpressionType.START_TAG&&r.type===e.PCExpressionType.ELEMENT&&r.startTag===n}),b=void 0,l=D+1;l--;){var K=B[l];if(E(K)&&C(K,e.BKExpressionType.IF)){b="condition_"+h(K,t.root).join("");break}}if(!b)throw new Error("Element condition "+e.BKExpressionType[M.type]+" defined without an IF block.");var w=vr(t),m=w.fragment,g=w.start,x=w.end,Y=(p=m).varName+"__bindings",I=p.varName+"$$currentValue";m.content+="let "+Y+" = [];let "+I+" = false;",i&&(m.content+="let "+b+" = Infinity;"),p.bindings.push("const newValue = Boolean("+(U?Mn(U):"true")+") && "+b+" >= "+D+";if (newValue) {"+b+" = "+D+";} else if ("+b+" === "+D+") {"+b+" = Infinity;}if (newValue && newValue === "+I+") {if ("+I+") {"+jn(Y)+"}return;}"+I+" = newValue;"+Y+" = [];if (newValue) {const elementFragment = document.createDocumentFragment();"+r.content+(r.bindings.length?Y+" = "+Y+".concat("+r.bindings.map(bn)+");":"")+"elementFragment.appendChild("+r.varName+");"+x.varName+".parentNode.insertBefore(elementFragment, "+x.varName+");} else {let curr = "+g.varName+".nextSibling;while(curr !== "+x.varName+") {curr.parentNode.removeChild(curr);curr = "+g.varName+".nextSibling;}}")}return p},$n=function(n,r){for(var t=yr('document.createElement("'+(r.aliases[n.name.toLowerCase()]||n.name)+'")',r),i=0,o=n.attributes.length;i<o;i++)!function(i,o){var a=n.attributes[i],u=a.name,s=a.value,c=Un(u);if(s){if(s.type===e.PCExpressionType.STRING){var E=s;t.content+=t.varName+'.setAttribute("'+u+'", '+JSON.stringify(E.value)+");\n"}else if(s.type===e.PCExpressionType.STRING_BLOCK||s.type===e.PCExpressionType.BLOCK){var p=t.varName+"$$"+c+"$$currentValue";t.content+="let "+p+";\n";var l=void 0;l=s.type===e.PCExpressionType.STRING_BLOCK?Fn(p,s.values.map(function(n){return n.type===e.PCExpressionType.BLOCK?Mn(n.value.value):JSON.stringify(n.value)}).join(" + "),function(e){return t.varName+'.setAttribute("'+u+'", '+e+")"},r):Fn(p,Mn(s.value.value),function(e){return"__setElementProperty("+t.varName+', "'+c+'", '+e+")"},r),t.bindings.push(l)}}else t.content+=t.varName+'.setAttribute("'+u+'", "true");'}(i);return t},Fn=function(e,n,r,t){return"let $$newValue = "+n+";if ($$newValue !== "+e+") {"+e+" = $$newValue;"+r(e)+"}"},jn=function(e,n){return void 0===n&&(n=""),"for (let __i = 0, n = "+e+".length; __i < n; __i++) {"+e+"[__i]("+n+");}"},Qn=function(e,n){switch(e.startTag.name){case"style":return Wn(e,n);default:return Hn(e.startTag,Tr(e,n),n)}},Wn=function(e,n){var r=yr('document.createElement("style")',n);(r=Rr(r,e,n)).content+="if (window.$synthetic) {";var t=Xn(e.childNodes[0],n);return r.content+=t.content+(r.varName+".$$setSheet(")+t.varName+");",r.content+="} else {"+r.varName+".textContent = "+JSON.stringify(Er(e.childNodes[0]))+";}",r},Xn=function(e,n){var r=Jn(e.children,n),t=dr("new CSSStyleSheet(["+r.map(function(e){return e.varName}).join(",")+"])",n);return t=Rr(t,e,n),t.content=r.map(function(e){return e.content}).join("\n")+t.content,t},Jn=function(e,n){return e.map(function(e){return qn(e,n)}).filter(Boolean)},qn=function(n,r){switch(n.type){case e.CSSExpressionType.AT_RULE:return zn(n,r);case e.CSSExpressionType.STYLE_RULE:return sr(n,r)}throw new Error("Unexpected rule "+n.type)},zn=function(e,n){switch(e.name){case"media":return Zn(e,n);case"keyframes":return rr(e,n);case"font-face":return er(e,n);case"import":return or(e,n);case"charset":return ar(e,n)}},Zn=function(e,n){return tr(e,n,"CSSMediaRule",sr)},er=function(e,n){return Rr(dr("new CSSFontFaceRule("+cr(nr(e),n)+")",n),e,n)},nr=function(n){return n.children.filter(function(n){return n.type===e.CSSExpressionType.DECLARATION_PROPERTY})},rr=function(e,n){return tr(e,n,"CSSKeyframesRule",ir)},tr=function(e,n,r,t){var i=e.children.map(function(e){return t(e,n)}).filter(Boolean),o=dr("new "+r+"("+JSON.stringify(e.params.join(" "))+", ["+i.map(function(e){return e.varName}).join(",")+"])",n);return o.content=i.map(function(e){return e.content}).join("\n")+o.content,o},ir=function(e,n){return ur(e,"CSSKeyframeRule",n)},or=function(e,n){return null},ar=function(e,n){return null},ur=function(e,n,r){return dr("new "+n+"("+JSON.stringify(e.selectorText)+", "+cr(nr(e),r)+")",r)},sr=function(e,n){return ur(e,"CSSStyleRule",n)},cr=function(e,n){for(var r="{",t=0,i=e;t<i.length;t++){var o=i[t];r+='"'+o.name+'": "'+o.value.replace(/"/g,'\\"').replace(/[\s\r\n\t]+/g," ")+'", '}return"CSSStyleDeclaration.fromObject("+(r+="}")+")"},Er=function(e,n){return void 0===n&&(n=function(e){return e}),e.children.map(function(e){return pr(e,n)}).filter(Boolean).join(" ")},pr=function(n,r){switch(n.type){case e.CSSExpressionType.AT_RULE:var t=n;if("charset"===t.name||"import"===t.name)return null;a="@"+t.name+" "+t.params+" {";return a+=t.children.map(function(e){return pr(e,r)}).filter(Boolean).join(" "),a+="}";case e.CSSExpressionType.DECLARATION_PROPERTY:var i=n;return i.name+": "+i.value+";";case e.CSSExpressionType.STYLE_RULE:var o=n,a=r(o.selectorText,o)+" {";return a+=o.children.map(function(e){return pr(e,r)}).filter(Boolean).join(""),a+="}"}},lr=function(n,r){for(var t=[],i=0,o=n.length;i<o;i++){var a=n[i];if(a.type===e.PCExpressionType.TEXT_NODE&&/^[\s\r\n\t]+$/.test(a.value)){var u=n[i-1],s=n[i+1];if((!u||E(u))&&(!s||E(s)))continue}var c=wn(a,r);c&&t.push(c)}return t},Tr=function(e,n){var r=$n(e.startTag,n);r=Rr(r,e,n);for(var t=lr(e.childNodes,n),i=0,o=t.length;i<o;i++){var a=t[i];r.content+=a.content,r.content+=r.varName+".appendChild("+a.varName+");\n",(u=r.bindings).push.apply(u,a.bindings)}return r;var u},fr=function(e,n,r){var t=_r(e,r);return{varName:t,bindings:[],content:n?"let "+t+" = "+n+";\n":"let "+t+";\n"}},_r=function(e,n){return e+"_"+n.varCount++},yr=function(e,n){return fr("node",e,n)},dr=function(e,n){return fr("rule",e,n)},vr=function(e){var n=yr('document.createDocumentFragment("")',e),r=yr('document.createTextNode("")',e),t=yr('document.createTextNode("")',e);return n.content+=r.content+""+t.content+n.varName+".appendChild("+r.varName+");"+n.varName+".appendChild("+t.varName+");",{fragment:n,start:r,end:t}},Rr=function(e,n,r){var t=i({uri:r.uri,type:n.type},n.location);return e.content+=e.varName+".source = "+JSON.stringify(t)+";",e},Sr=function(e){},Nr={},Cr=function(e,n){if(Nr[e])return Nr[e];var r={filePath:n,source:e,diagnostics:[],scanner:Y(e)};return Nr[e]={root:hr(r),diagnostics:r.diagnostics}},hr=function(n){for(var r,t=n.scanner,i=t.curr(),o=[];!t.ended();)if(o.push(Ar(n)),!r){if((r=t.curr())&&r.type!==g.WHITESPACE&&r.type!==g.COMMA&&!Me(n,[g.COMMA]))return null;t.next()}return 1===o.length?o[0]:{type:r.type===g.WHITESPACE?e.DcExpressionType.SPACED_LIST:e.DcExpressionType.COMMA_LIST,items:o,location:B(i,t.curr(),t.source)}},Ar=function(e){var n=e.scanner;switch(me(e),n.curr().type){case g.SINGLE_QUOTE:case g.DOUBLE_QUOTE:return Z(e);case g.HASH:return Or(e);case g.NUMBER:return Lr(e);case g.MINUS:return n.hasNext()&&n.peek(1).type===g.NUMBER?Lr(e):gr(e);case g.TEXT:return gr(e);default:xe(n.source,n.curr())}},Or=function(n){for(var r=n.scanner,t=r.curr(),i="";!r.ended()&&r.curr().type!==g.WHITESPACE;)i+=r.curr().value,r.next();return{type:e.DcExpressionType.COLOR,value:i,location:B(t,r.curr(),r.source)}},Lr=function(n){var r=n.scanner,t=r.curr(),i=mr(n),o="";return r.ended()||r.curr().type===g.WHITESPACE||r.curr().type===g.COMMA||r.curr().type===g.PAREN_CLOSE||(o=r.curr().value,r.next()),{type:e.DcExpressionType.MEASUREMENT,value:i,unit:o,location:B(t,r.curr(),r.source)}},mr=function(e){var n=e.scanner,r=n.curr().value;return"-"===r&&(r+=n.next().value),n.next(),r},gr=function(n){var r=n.scanner,t=r.curr(),i=Ir(n);return r.ended()||r.curr().type!==g.PAREN_OPEN?{type:e.DcExpressionType.KEYWORD,name:i}:{type:e.DcExpressionType.CALL,name:i,params:xr(n),location:B(t,r.curr(),r.source)}},xr=function(e){for(var n=e.scanner,r=[];!n.ended()&&n.curr().type!==g.PAREN_CLOSE;)n.next(),me(e),r.push(Ar(e));return Me(e,[g.PAREN_CLOSE])?(n.next(),r):null},Ir=function(e){for(var n=e.scanner,r="";!n.ended()&&n.curr().type!==g.WHITESPACE&&n.curr().type!==g.PAREN_OPEN&&n.curr().type!==g.PAREN_CLOSE;)r+=n.curr().value,n.next();return r},Pr=function(n){switch(n.type){case e.DcExpressionType.SPACED_LIST:return(r=n).items.map(Pr).join(" ");case e.DcExpressionType.COMMA_LIST:var r=n;return r.items.map(Pr).join(", ");case e.DcExpressionType.KEYWORD:return n.name;case e.DcExpressionType.CALL:var t=n;return t.name+"("+t.params.map(Pr).join(", ")+")";case e.DcExpressionType.COLOR:return n.value;case e.BKExpressionType.STRING:return JSON.stringify(n.value);case e.DcExpressionType.MEASUREMENT:var i=n;return""+i.value+i.unit;default:throw new Error("Unable to stringify CSS declaration value type "+n.type)}},Mr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MUTATED="MUTATED",n.SET_VALUE_MUTATION="SET_VALUE_MUTATION",n.INSERT_CHILD_MUTATION="INSERT_CHILD_MUTATION",n.REMOVE_CHILD_MUTATION="REMOVE_CHILD_MUTATION",n.SET_PROPERTY_MUTATION="SET_PROPERTY_MUTATION",n.REMOVE_MUTATION="REMOVE_MUTATION",n.createMutationEvent=function(e){return{type:n.MUTATED,mutation:e}},n.createSetValueMutation=function(e,n,r){return{type:e,target:n,newValue:r}},n.createInsertChildMutation=function(e,n,r,t,i){return void 0===t&&(t=Number.MAX_SAFE_INTEGER),{type:e,target:n,child:r,index:t,clone:i}},n.createRemoveChildMutation=function(e,n,r,t){return{type:e,target:n,child:r,index:t}},n.createMoveChildMutation=function(e,n,r,t,i){return{type:e,target:n,child:r,index:t,oldIndex:i}},n.createPropertyMutation=function(e,n,r,t,i,o,a){return{type:e,target:n,name:r,newValue:t,oldValue:i,oldName:o,index:a}},n.createRemoveMutation=function(e,n,r,t,i,o){return{type:e,target:n}}});r(Mr);Mr.MUTATED,Mr.SET_VALUE_MUTATION,Mr.INSERT_CHILD_MUTATION,Mr.REMOVE_CHILD_MUTATION,Mr.SET_PROPERTY_MUTATION,Mr.REMOVE_MUTATION,Mr.createMutationEvent,Mr.createSetValueMutation,Mr.createInsertChildMutation,Mr.createRemoveChildMutation,Mr.createMoveChildMutation,Mr.createPropertyMutation,Mr.createRemoveMutation;var Ur=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.STRING_REPLACE="STRING_REPLACE",n.createStringMutation=function(e,r,t){return void 0===t&&(t=""),{startIndex:e,endIndex:r,value:t,type:n.STRING_REPLACE}},n.editString=function(e,n,r){void 0===r&&(r=[]);for(var t=e,i=r.length,o=r.concat(n),a=0,u=n.length;a<u;a++){for(var s=n[a],c=s.startIndex,E=s.endIndex,p=s.value,l=c,T=E,f=!1,_=c===E,y=a+i,d=0;d<y;d++){var v=o[d],R=v.startIndex,S=v.endIndex,N=v.value,C=R===S,h=c===R,A=E===S,O=h&&_,L=A&&_,m=h&&C,g=A&&C,x=O||L||m||g;if(R<E&&R>c&&(T-=E-R),S>c&&S<E&&(l+=S-c),(c>=R&&E<=S||c<R&&E>=S)&&!x){f=!0;break}if(R<=c&&E>R){var I=N.length-(S-R);l=Math.max(0,l+I),T=Math.max(0,T+I)}}f||(t=t.substr(0,l)+p+t.substr(T))}return t}});r(Ur);Ur.STRING_REPLACE,Ur.createStringMutation,Ur.editString;var Br=t(function(e,n){function r(e,r,t){for(var i=[].concat(e),o=[].concat(e),a=[].concat(r),u=[],s=[],c=0,E=o.length;c<E;c++){for(var p=o[c],l=void 0,T=1/0,f=0,_=a.length;f<_;f++){var y=t(p,R=a[f]);if(~y&&y<T&&(l=R,T=y),0===T)break}null!=l&&(o.splice(c--,1),E--,a.splice(a.indexOf(l),1),s[r.indexOf(l)]=[p,l])}for(c=o.length;c--;){var p=o[c],d=e.indexOf(p);u.push(n.createArrayDeleteMutation(p,d)),i.splice(d,1)}for(var c=0,E=a.length;c<E;c++){R=a[c];s[d=r.indexOf(R)]=[void 0,R]}for(var c=0,E=s.length;c<E;c++)if(null!=s[c]){var v=s[c],p=v[0],R=v[1],S=c;if(null==p)u.push(n.createArrayInsertMutation(S,R)),i.splice(S,0,R);else{var N=i.indexOf(p);u.push(n.createArrayUpdateMutation(e.indexOf(p),N,R,S)),N!==S&&(i.splice(N,1),i.splice(S,0,p))}}return n.createArrayMutation(u)}function t(e,r,t,i){void 0===t&&(t=function(e,n){return n}),void 0===i&&(i=function(e){return e});var o=e.slice();return n.eachArrayValueMutation(r,{insert:function(e){var n=e.index,r=e.value;o.splice(n,0,i(r))},delete:function(e){var n=e.index;o.splice(n,1)},update:function(e){var n=e.patchedOldIndex,r=e.newValue,i=e.index,a=o[n],u=t(a,r);u===a&&n===i||(n!==i&&o.splice(n,1),o.splice(i,0,u))}}),o}Object.defineProperty(n,"__esModule",{value:!0}),n.ARRAY_DIFF="ARRAY_DIFF",n.ARRAY_INSERT="ARRAY_INSERT",n.ARRAY_UPDATE="ARRAY_UPDATE",n.ARRAY_DELETE="ARRAY_DELETE",n.createArrayInsertMutation=function(e,r){return{type:n.ARRAY_INSERT,index:e,value:r}},n.createArrayUpdateMutation=function(e,r,t,i){return{type:n.ARRAY_UPDATE,index:i,newValue:t,originalOldIndex:e,patchedOldIndex:r}},n.createArrayDeleteMutation=function(e,r){return{type:n.ARRAY_DELETE,value:e,index:r}},n.createArrayMutation=function(e){return{type:n.ARRAY_DIFF,mutations:e}},n.diffArray=r,n.eachArrayValueMutation=function(e,r){e.mutations.forEach(function(e){switch(e.type){case n.ARRAY_INSERT:return r.insert(e);case n.ARRAY_DELETE:return r.delete(e);case n.ARRAY_UPDATE:return r.update(e)}})},n.patchArray=t});r(Br);Br.ARRAY_DIFF,Br.ARRAY_INSERT,Br.ARRAY_UPDATE,Br.ARRAY_DELETE,Br.createArrayInsertMutation,Br.createArrayUpdateMutation,Br.createArrayDeleteMutation,Br.createArrayMutation,Br.diffArray,Br.eachArrayValueMutation,Br.patchArray;var Dr=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(Mr),r(Ur),r(Br)});r(Dr);var br=Dr.createStringMutation,Kr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});!function(e){e.PX="PX",e.PERC="%",e.VW="vw",e.VH="vh",e.CM="cm",e.EM="em",e.EX="ex",e.IN="in",e.MM="mm",e.PC="pc",e.PT="pt",e.VMIN="vmin"}(n.CSSMeasurementTypes||(n.CSSMeasurementTypes={}));!function(e){e.HORIZONTAL="HORIZONTAL",e.VERTICAL="VERTICAL"}(n.Axis||(n.Axis={}));!function(e){e[e.azimuth=0]="azimuth",e[e.borderCollapse=1]="borderCollapse",e[e.borderSpacing=2]="borderSpacing",e[e.captionSide=3]="captionSide",e[e.color=4]="color",e[e.cursor=5]="cursor",e[e.direction=6]="direction",e[e.elevation=7]="elevation",e[e.emptyCells=8]="emptyCells",e[e.fontFamily=9]="fontFamily",e[e.fontSize=10]="fontSize",e[e.fontStyle=11]="fontStyle",e[e.fontVariant=12]="fontVariant",e[e.fontWeight=13]="fontWeight",e[e.font=14]="font",e[e.letterSpacing=15]="letterSpacing",e[e.lineHeight=16]="lineHeight",e[e.listStyleImage=17]="listStyleImage",e[e.listStylePosition=18]="listStylePosition",e[e.listStyleType=19]="listStyleType",e[e.listStyle=20]="listStyle",e[e.orphans=21]="orphans",e[e.pitchRange=22]="pitchRange",e[e.pitch=23]="pitch",e[e.quotes=24]="quotes",e[e.richness=25]="richness",e[e.speakHeader=26]="speakHeader",e[e.speakNumeral=27]="speakNumeral",e[e.speakPunctuation=28]="speakPunctuation",e[e.speak=29]="speak",e[e.speechRate=30]="speechRate",e[e.stress=31]="stress",e[e.textAlign=32]="textAlign",e[e.textIndent=33]="textIndent",e[e.textDecoration=34]="textDecoration",e[e.textTransform=35]="textTransform",e[e.visibility=36]="visibility",e[e.voiceFamily=37]="voiceFamily",e[e.volume=38]="volume",e[e.whiteSpace=39]="whiteSpace",e[e.widows=40]="widows",e[e.wordSpacing=41]="wordSpacing"}(n.INHERITED_CSS_STYLE_PROPERTIES||(n.INHERITED_CSS_STYLE_PROPERTIES={}))});r(Kr);Kr.CSSMeasurementTypes,Kr.Axis,Kr.INHERITED_CSS_STYLE_PROPERTIES;var wr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CSS_STYLE_RULE_SET_SELECTOR_TEXT="CSS_STYLE_RULE_SET_SELECTOR_TEXT",n.CSS_STYLE_RULE_SET_STYLE="CSS_STYLE_RULE_SET_STYLE",n.CSS_STYLE_RULE_SET_STYLE_PROPERTY="CSS_STYLE_RULE_SET_STYLE_PROPERTY",n.CSS_PARENT_INSERT_RULE="CSS_PARENT_INSERT_RULE",n.CSS_PARENT_DELETE_RULE="CSS_PARENT_DELETE_RULE",n.CSS_PARENT_MOVE_RULE="CSS_PARENT_MOVE_RULE",n.CSS_INSERT_CSS_RULE_TEXT="CSS_INSERT_CSS_RULE_TEXT"});r(wr);wr.CSS_STYLE_RULE_SET_SELECTOR_TEXT,wr.CSS_STYLE_RULE_SET_STYLE,wr.CSS_STYLE_RULE_SET_STYLE_PROPERTY,wr.CSS_PARENT_INSERT_RULE,wr.CSS_PARENT_DELETE_RULE,wr.CSS_PARENT_MOVE_RULE,wr.CSS_INSERT_CSS_RULE_TEXT;var Yr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SET_ELEMENT_ATTRIBUTE_EDIT="setElementAttributeEdit",n.ATTACH_SHADOW_ROOT_EDIT="attachShadowRootEdit",n.SET_TEXT_CONTENT="setTextContent",n.INSERT_HTML_EDIT="INSERT_HTML_EDIT",n.INSERT_CHILD_NODE_EDIT="INSERT_CHILD_NODE_EDIT",n.REMOVE_CHILD_NODE_EDIT="REMOVE_CHILD_NODE_EDIT",n.MOVE_CHILD_NODE_EDIT="MOVE_CHILD_NODE_EDIT",n.UPDATE_VALUE_NODE="UPDATE_VALUE_NODE"});r(Yr);Yr.SET_ELEMENT_ATTRIBUTE_EDIT,Yr.ATTACH_SHADOW_ROOT_EDIT,Yr.SET_TEXT_CONTENT,Yr.INSERT_HTML_EDIT,Yr.INSERT_CHILD_NODE_EDIT,Yr.REMOVE_CHILD_NODE_EDIT,Yr.MOVE_CHILD_NODE_EDIT,Yr.UPDATE_VALUE_NODE;var Vr=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(Kr),r(wr),r(Yr)});r(Vr);var Gr=Vr,kr=Gr.UPDATE_VALUE_NODE,Hr=Gr.SET_ELEMENT_ATTRIBUTE_EDIT,$r=Gr.INSERT_CHILD_NODE_EDIT,Fr=Gr.REMOVE_CHILD_NODE_EDIT,jr=Gr.INSERT_HTML_EDIT,Qr=(Gr.CSS_INSERT_CSS_RULE_TEXT,Gr.CSS_PARENT_DELETE_RULE,Gr.CSS_STYLE_RULE_SET_SELECTOR_TEXT,Gr.CSS_STYLE_RULE_SET_STYLE_PROPERTY,t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createInsertHTMLMutation=function(e,n,r){return{type:Yr.INSERT_HTML_EDIT,html:r,childIndex:n,target:e}}}));r(Qr);Qr.createInsertHTMLMutation;var Wr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.insertCSSRuleText=function(e,n,r){return{type:wr.CSS_INSERT_CSS_RULE_TEXT,target:e,childIndex:n,cssText:r}}});r(Wr);Wr.insertCSSRuleText;var Xr=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(Qr),r(Wr)});r(Xr);var Jr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}(Xr)});r(Jr);var qr=Jr.createInsertHTMLMutation,zr=function(e,n){return{type:"PC_REMOVE_CHILD_NODE",index:n,target:e}},Zr=function(e){return{type:"PC_REMOVE_NODE",target:e}},et=function(e,n){var r=k(e),t=rt(r.root,n.target.location||n.target.source);if(n.target.source&&console.warn("Mutation target does not match expected type."),!t)return[br(0,0,"")];switch(n.type){case kr:return st(t,n);case Hr:return ct(t,n);case Fr:return tt(t,n.index);case $r:return ot(t,n,e);case jr:return at(t,n,e);case"PC_REMOVE_CHILD_NODE":return tt(t,n.index);case"PC_REMOVE_NODE":return it(t)}return[br(0,0,"")]},nt=function(e,n){return e.location.start.line===n.start.line&&e.location.start.column===n.start.column&&e.location.end.line===n.end.line&&e.location.end.column===n.end.column},rt=function(n,r){if(nt(n,r))return n;if(n.type===e.PCExpressionType.FRAGMENT||n.type===e.PCExpressionType.ELEMENT)for(var t=0,i=n.childNodes;t<i.length;t++){var o=i[t],a=rt(o,r);if(a)return a}},tt=function(e,n){var r=e.childNodes[n];return it(r)},it=function(e){return[br(e.location.start.pos,e.location.end.pos,"")]},ot=function(e,n,r){var t=n.target,i=n.index,o=n.child;return at(e,qr(t,i,o.nodeValue||o.outerHTML),r)},at=function(n,r,t){var i=r.childIndex,o=r.html;if(n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT)return[br(ut((u=n).location.end.pos-2,t),u.location.end.pos,">"+o+"</"+u.name+">")];var a=n.childNodes[i];if(!a){var u=n;return[br(u.startTag.location.end.pos,u.startTag.location.end.pos,o)]}return[br(a.location.start.pos,a.location.start.pos,o)]},ut=function(e,n){var r=n.substr(0,e).split("").reverse().join("").match(/^([\s\r\n\t]+)/)||["",""];return e-r[1].length},st=function(e,n){var r=n.newValue;return[br(e.location.start.pos,e.location.end.pos,r)]},ct=function(n,r){var t;n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT?t=n:n.type===e.PCExpressionType.ELEMENT&&(t=n.startTag);for(var i,o=r.name,a=r.newValue&&'"'+r.newValue+'"',u=0,s=t.attributes;u<s.length;u++){var c=s[u];if(c.name===o)return i=!0,a?[br(c.value.location.start.pos,c.value.location.end.pos,a)]:[br(c.location.start.pos-1,c.location.end.pos,"")]}if(!i){var E=t.location.start.pos+t.name.length+1;return[br(E,E,!0===r.newValue?o:" "+o+"="+a)]}},Et=Je(function(e,n){void 0===n&&(n={});var r={};for(var t in e)for(var o=0,a=e[t].module.components;o<a.length;o++)r[(E=a[o]).id]={filePath:t,component:E};var u={graph:e,options:n,currentFilePath:null,ignoreTagNames:{},callstack:[],components:r,diagnostics:[]};for(var s in r){var c=r[s],t=c.filePath,E=c.component;u=lt(E,i({},u,{currentFilePath:t}))}return{diagnostics:pt(u.diagnostics)}}),pt=function(e){for(var n=e.map(function(e){return JSON.stringify(e)}),r={},t=[],i=0,o=n.length;i<o;i++){var a=n[i];r[a]||(r[a]=1,t.push(e[i]))}return t},lt=function(e,n){n=ft(e.template,n);for(var r=0,t=e.previews.length;r<t;r++){var i=e.previews[r];n=ft(i,n)}return n},Tt=function(e,n){var r=en(e,n.currentFilePath),t=r.inference,o=r.diagnostics;return n=ht(n.caller.source,[],t,n.caller.props,n),o.length&&(n=i({},n,{diagnostics:n.diagnostics.concat(o)})),n=ft(e,n)},ft=function(n,r){switch(n.type){case e.PCExpressionType.FRAGMENT:return yt(n,r);case e.PCExpressionType.SELF_CLOSING_ELEMENT:case e.PCExpressionType.ELEMENT:return dt(n,r)}return r},_t=function(e,n){for(var r=0,t=e.length;r<t;r++)n=ft(e[r],n);return n},yt=function(e,n){return _t(e.childNodes,n)},dt=function(n,r){var t,i;if(n.type===e.PCExpressionType.ELEMENT)t=(o=n).childNodes,i=o.startTag;else{var o=n;i=o,t=[]}return r.callstack.filter(function(e){return e.source===i}).length>10?At(n,"Maximum callstack exceeded",r):r.ignoreTagNames[i.name.toLowerCase()]?r:(r=Rt(i,r),r=_t(t,r))},vt={},Rt=function(n,r){var t=r.components[n.name.toLowerCase()]||vt,i=t.component;e.InferenceType.ANY;if(!i)return r;for(var o,a,u=0,s=n.modifiers.length;u<s;u++){var c=n.modifiers[u].value;c.type===e.BKExpressionType.IF||c.type===e.BKExpressionType.ELSEIF?o=c:c.type===e.BKExpressionType.REPEAT&&(a=c)}if(o&&!gt(o,r))return r;var E=r.currentFilePath;if(a){var p=a.each,l=a.asValue,T=(a.asKey,l.name);Ut(gt(p,r),function(e,t){r=St(n,Mt(a,E,(i={},i[T]=e,i),r)),r=xt(r);var i})}else r=St(n,r);return r},St=function(n,r){for(var t={},i=r.currentFilePath,o=r.components[n.name.toLowerCase()]||vt,a=o.filePath,u=o.component,s={},c=0,E=n.attributes.length;c<E;c++)s[(l=n.attributes[c]).name]=l;for(var p in s){var l=s[p],T=Lt(l,r);t[p]=T}for(var c=0,E=n.modifiers.length;c<E;c++){var f=n.modifiers[c].value;if(f.type===e.BKExpressionType.BIND){var _=f;Object.assign(t,gt(_,r))}}return r=Tt(u.source,Nt(a,It("preview",Mt(n,a,t,r)))),r=xt(r),Pt("preview",Nt(i,r))},Nt=function(e,n){return i({},n,{currentFilePath:e})},Ct=function(n){if(Array.isArray(n))return e.InferenceType.ARRAY;if(null===n)return e.InferenceType.ANY;switch(typeof n){case"object":return e.InferenceType.OBJECT;case"number":return e.InferenceType.NUMBER;case"boolean":return e.InferenceType.BOOLEAN;case"string":return e.InferenceType.STRING;default:return e.InferenceType.ANY}},ht=function(n,r,t,i,o){if(void 0===i)return o=At(n,'Missing attribute "'+r.join(".")+'"',o);var a=Ct(i);if(t.type&a||(o=At(n,'Type mismatch: attribute "'+r.join(".")+'" expecting '+Sn(t.type)+", "+Rn(a)+" provided.",o)),t.type!==e.InferenceType.ANY&&i)for(var u in t.properties)"$$each"!==u&&(o=ht(n,r.concat([u]),t.properties[u],i[u],o));return o},At=function(n,r,t){return Ot(n,e.DiagnosticType.ERROR,r,t)},Ot=function(n,r,t,o){return i({},o,{diagnostics:o.diagnostics.concat([{type:e.DiagnosticType.ERROR,location:n.location,message:t,filePath:o.currentFilePath}])})},Lt=function(n,r){return!n.value||(n.value.type===e.PCExpressionType.STRING||n.value.type===e.PCExpressionType.STRING_BLOCK?"":gt(n.value.value,r))},mt=function(e,n,r){return void 0===r&&(r=0),null==n?n:r===e.length?n:mt(e,n[e[r]],r+1)},gt=function(n,r){switch(n.type){case e.BKExpressionType.OPERATION:var t=n,i=t.left,o=t.operator,a=t.right,u=gt(i,r),s=gt(a,r);switch(o){case"+":return u+s;case"-":return u-s;case"*":return u*s;case"/":return u/s;case"%":return u%s;case"==":return u==s;case"===":case"!=":case"!==":return u!==s;case"||":return u||s;case"&&":return u&&s;case">=":return u>=s;case"<=":return u<=s}return null;case e.BKExpressionType.PROP_REFERENCE:case e.BKExpressionType.VAR_REFERENCE:return r.caller?mt(cn(n),r.caller.props):null;case e.BKExpressionType.NUMBER:d=n.value;return Number(d);case e.BKExpressionType.STRING:d=n.value;return String(d);case e.BKExpressionType.ARRAY:for(var c=[],E=0,p=n.values;E<p.length;E++){var l=p[E];c.push(gt(l,r))}return c;case e.BKExpressionType.OBJECT:for(var c={},T=0,f=n.properties;T<f.length;T++){var _=f[T],y=_.key,d=_.value;c[y]=gt(d,r)}return c;case e.BKExpressionType.RESERVED_KEYWORD:if("undefined"===(d=n.value))return;if("null"===d)return null;if("true"===d||"false"==d)return"true"===d;case e.BKExpressionType.BIND:return gt((v=n).value,r);case e.BKExpressionType.ELSEIF:case e.BKExpressionType.IF:var v=n;return gt(v.condition,r);case e.BKExpressionType.NOT:return!gt(n,r)}},xt=function(e){return i({},e,{callstack:e.callstack.slice(0,e.callstack.length-1),caller:e.callstack[e.callstack.length-2]})},It=function(e,n){return i({},n,{ignoreTagNames:i({},It,(r={},r[e]=(n.ignoreTagNames[e]||0)+1,r))});var r},Pt=function(e,n){return i({},n,{ignoreTagNames:i({},It,(r={},r[e]=(n.ignoreTagNames[e]||1)-1,r))});var r},Mt=function(e,n,r,t){var o={filePath:n,source:e,props:r};return i({},t,{callstack:t.callstack.concat([o]),caller:o})},Ut=function(e,n){if(Array.isArray(e))e.forEach(n);else for(var r in e)n(e[r],r)};e.getElementChildNodes=o,e.getElementTagName=a,e.getAttributeStringValue=u,e.getElementAttributes=s,e.getElementModifiers=c,e.isTag=E,e.filterPCElementsByStartTag=p,e.getElementStartTag=l,e.getPCStartTagAttribute=T,e.hasPCStartTagAttribute=f,e.getPCStyleElements=_,e.getPCLinkStyleElements=y,e.getPCCSSElements=d,e.getPCMetaTags=v,e.getPCMetaName=R,e.traversePCAST=S,e.getStartTag=N,e.getPCElementModifier=C,e.getExpressionPath=h,e.filterPCASTTree=A,e.getPCASTElementsByTagName=O,e.getPCParent=L,e.getAllChildElementNames=m,e.parseModuleSource=k,e.parseStyleSource=H,e.createString=Z,e.eatWhitespace=me,e.throwUnexpectedToken=xe,e.addUnexpectedToken=Ie,e.testCurrTokenExists=Pe,e.testCurrTokenType=Me,e.bundleVanilla=Pn,e.transpileBlockExpression=Mn,e.transpileStyleElement=Wn,e.transpileCSSSheet=Er,e.loadModuleAST=Be,e.defaultResolveModulePath=De,e.getChildComponentInfo=be,e.getDependencyGraphComponentsExpressions=Ke,e.getDependencyChildComponentInfo=we,e.getModuleComponent=Ye,e.getUsedDependencies=Ve,e.getImportDependencies=Ge,e.getComponentDependency=ke,e.loadModuleDependencyGraph=He,e.parseMetaContent=Fe,e.getComponentMetadataItems=je,e.getComponentMetadataItem=Qe,e.loadComponentTypes=Sr,e.parseDeclaration=Cr,e.stringifyDeclarationAST=Pr,e.editPaperclipSource=et,e.PC_REMOVE_CHILD_NODE="PC_REMOVE_CHILD_NODE",e.PC_REMOVE_NODE="PC_REMOVE_NODE",e.createPCRemoveChildNodeMutation=zr,e.createPCRemoveNodeMutation=Zr,e.generatePrettyErrorMessage=x,e.EACH_KEY="$$each",e.ATTR_TYPE_LIMITS=qe,e.ANY_REFERENCE=Ze,e.inferNodeProps=en,e.getReferenceKeyPath=cn,e.getTypeLabels=Rn,e.getPrettyTypeLabelEnd=Sn,e.isValidReturnType=mn,e.lintDependencyGraph=Et,Object.defineProperty(e,"__esModule",{value:!0})});
