!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.paperclip={})}(this,function(e){"use strict";function n(e,n){function r(){this.constructor=e}for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,n){return n={exports:{}},e(n,n.exports),n.exports}const o=Object.assign||function(e){for(var n,r=1;r<arguments.length;r++){n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e};!function(e){e[e.STRING=0]="STRING",e[e.BLOCK=1]="BLOCK",e[e.STRING_BLOCK=2]="STRING_BLOCK",e[e.ELEMENT=3]="ELEMENT",e[e.SELF_CLOSING_ELEMENT=4]="SELF_CLOSING_ELEMENT",e[e.TEXT_NODE=5]="TEXT_NODE",e[e.COMMENT=6]="COMMENT",e[e.ATTRIBUTE=7]="ATTRIBUTE",e[e.START_TAG=8]="START_TAG",e[e.BLOCK_STRING=9]="BLOCK_STRING",e[e.FRAGMENT=10]="FRAGMENT",e[e.END_TAG=11]="END_TAG"}(e.PCExpressionType||(e.PCExpressionType={})),function(e){e.TYPE="TYPE",e.BIND="BIND",e.IF="IF",e.STRING="STRING",e.OBJECT="OBJECT",e.ARRAY="ARRAY",e.KEY_VALUE_PAIR="KEY_VALUE_PAIR",e.NUMBER="NUMBER",e.PROPERTY="PROPERTY",e.RESERVED_KEYWORD="RESERVED_KEYWORD",e.ELSEIF="ELSEIF",e.NOT="NOT",e.OPERATION="OPERATION",e.GROUP="GROUP",e.VAR_REFERENCE="VAR_REFERENCE",e.PROP_REFERENCE="PROP_REFERENCE",e.ELSE="ELSE",e.REPEAT="REPEAT"}(e.BKExpressionType||(e.BKExpressionType={})),function(e){e[e.SHEET=0]="SHEET",e[e.DECLARATION_PROPERTY=1]="DECLARATION_PROPERTY",e[e.STYLE_RULE=2]="STYLE_RULE",e[e.AT_RULE=3]="AT_RULE",e[e.IMPORT=4]="IMPORT",e[e.CHARSET=5]="CHARSET"}(e.CSSExpressionType||(e.CSSExpressionType={})),function(e){e.COLOR="COLOR",e.CALL="CALL",e.MEASUREMENT="MEASUREMENT",e.SPACED_LIST="SPACED_LIST",e.COMMA_LIST="COMMA_LIST",e.KEYWORD="KEYWORD",e.LIST="LIST"}(e.DcExpressionType||(e.DcExpressionType={}));var i=function(n){return n.type==e.PCExpressionType.SELF_CLOSING_ELEMENT?[]:n.childNodes},a=function(n){return n.type==e.PCExpressionType.SELF_CLOSING_ELEMENT?n.name:n.startTag.name},u=function(e){return e.value.value},s=function(e){return N(e).attributes},c=function(e){return N(e).modifiers},E=function(n){return n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.START_TAG||n.type===e.PCExpressionType.END_TAG||n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT},p=function(n,r){return O(n,function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT?r(n):n.type===e.PCExpressionType.ELEMENT&&r(n.startTag)})},l=function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||n.type==e.PCExpressionType.START_TAG?n:n.startTag},T=function(e,n){if(f(e,n)){var r=l(e).attributes.find(function(e){return e.name===n});return r&&r.value&&r.value.value}},f=function(n,r){return(n.type===e.PCExpressionType.ELEMENT||n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||n.type===e.PCExpressionType.START_TAG)&&Boolean(l(n).attributes.find(function(e){return e.name===r}))},d=function(n){return O(n,function(n){return n.type===e.PCExpressionType.ELEMENT&&"style"===n.startTag.name})},_=function(n){return O(n,function(n){return n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT&&"link"===n.name&&"stylesheet"===T(n,"rel")})},y=function(e){return d(e).concat(_(e))},v=function(e){return h(e,"meta")},S=function(e){var n=v(e).find(function(e){return Boolean(T(e,"name"))});return n&&T(n,"content")},R=function(e,n,r){if(void 0===r&&(r=[]),!1===n(e,r))return!1;if(e.childNodes)for(var t=e,o=0,i=t.childNodes.length;o<i;o++){var a=t.childNodes[o];if(!1===R(a,n,r.concat(["childNodes",o])))return!1}},N=function(n){return n.type===e.PCExpressionType.ELEMENT?n.startTag:n},C=function(e,n){return N(e).modifiers.find(function(e){return e.value.type===n})},A=function(e,n){var r;return R(n,function(n,t){if(n===e)return r=t,!1}),r},O=function(e,n){var r=[];return R(e,function(e){n(e)&&r.push(e)}),r},h=function(e,n){return p(e,function(e){return e.name===n})},L=function(n,r){return O(n,function(n){return n.childNodes&&n.childNodes.find(function(n){return n===r||r.type===e.PCExpressionType.START_TAG&&n.type===e.PCExpressionType.ELEMENT&&n.startTag===r})})[0]},m=function(e){var n=[];return R(e,function(e){E(e)&&-1===n.indexOf(N(e).name)&&n.push(N(e).name)}),n};!function(e){e.WARNING="WARNING",e.ERROR="ERROR"}(e.DiagnosticType||(e.DiagnosticType={}));var x,g=function(e){for(var n=e.location,r=(e.filePath,e.message+"\n\n"),t=e.source.split("\n").slice(n.start.line-1,n.end.line+1).map(function(e){return e+"\n"}),o=["[90m"+t[0].substr(0,n.start.column)+"[0m[31m"+t[0].substr(n.start.column)+"[0m"].concat(t.slice(1,n.end.line-n.start.line).map(function(e){return"[31m"+e+"[0m"}),["[31m"+t[t.length-1].substr(0,n.end.column)+"[0m[90m"+t[t.length-1].substr(n.end.column)+"[0m"]),i=0,a=o.length;i<a;i++)r+=n.start.line+i+"| "+o[i];return r},P=function(e,n,r){return{type:e,pos:n,value:r}},I={},M=function(e){if(I[e])return I[e];var n=1,r=0,t={};return(e+" ").split("").forEach(function(e,o){t[o]=[r,n],"\n"===e&&(r=0,n++),r++}),I[e]=t},U=function(e,n){var r="number"==typeof e?e:e.pos,t=M(n)[r];return{column:t[0],line:t[1],pos:r}},D=function(e,n,r){return{start:e.line?e:U(e,r),end:n&&n.line?n:U(n||r.length,r)}},B=function(e,n){return D(e,e.pos+e.value.length,n)},b=function(){function e(e){this._target=e,this.pos=0,this.length=e.length}return e.prototype.curr=function(){return this._target[this.pos]},e.prototype.shift=function(){var e=this._target[this.pos];return this.next(),e},e.prototype.hasNext=function(){return this.pos<this.length-1},e.prototype.next=function(){return this._target[Math.min(this.pos=this.pos+1,this.length)]},e.prototype.prev=function(){return this._target[Math.max(this.pos=this.pos-1,0)]},e.prototype.ended=function(){return this.pos>=this.length},e}(),$=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.prototype.scan=function(e){for(var n="";this.pos<this.length;){var r=this._target[this.pos];if(!r.match(e))break;n+=r,this.pos++}return n},r.prototype.match=function(e){var n=this._target.substr(this.pos),r=n.match(e);if(r){var t=r[0];return this.pos+=n.indexOf(t)+t.length,t}return null},r.prototype.peek=function(e){return this._target.substr(this.pos,e)},r.prototype.take=function(e){var n=this._target.substr(this.pos,e);return this.pos+=e,n},r}(b),K=function(e){function r(n,r){var t=e.call(this,r)||this;return t.source=n,t}return n(r,e),r.prototype.peek=function(e){return void 0===e&&(e=1),this._target[this.pos+e]},r.prototype.peekUntil=function(e){for(var n=this.pos;n<this.length-1;)if(e(this._target[++n]))return this._target[n]},r.prototype.curr=function(){return e.prototype.curr.call(this)},r.prototype.next=function(){return e.prototype.next.call(this)},r}(b);!function(e){e[e.LESS_THAN=0]="LESS_THAN",e[e.LESS_THAN_OR_EQUAL=1]="LESS_THAN_OR_EQUAL",e[e.CLOSE_TAG=2]="CLOSE_TAG",e[e.COMMA=3]="COMMA",e[e.GREATER_THAN=4]="GREATER_THAN",e[e.GREATER_THAN_OR_EQUAL=5]="GREATER_THAN_OR_EQUAL",e[e.COMMENT=6]="COMMENT",e[e.BACKSLASH=7]="BACKSLASH",e[e.PERIOD=8]="PERIOD",e[e.BANG=9]="BANG",e[e.AND=10]="AND",e[e.OR=11]="OR",e[e.PLUS=12]="PLUS",e[e.COLON=13]="COLON",e[e.SEMICOLON=14]="SEMICOLON",e[e.MINUS=15]="MINUS",e[e.NUMBER=16]="NUMBER",e[e.AT=17]="AT",e[e.STAR=18]="STAR",e[e.PERCENT=19]="PERCENT",e[e.PAREN_OPEN=20]="PAREN_OPEN",e[e.PAREN_CLOSE=21]="PAREN_CLOSE",e[e.DOUBLE_EQUALS=22]="DOUBLE_EQUALS",e[e.TRIPPLE_EQUELS=23]="TRIPPLE_EQUELS",e[e.NOT_EQUALS=24]="NOT_EQUALS",e[e.NOT_DOUBLE_EQUALS=25]="NOT_DOUBLE_EQUALS",e[e.BRACKET_OPEN=26]="BRACKET_OPEN",e[e.BRACKET_CLOSE=27]="BRACKET_CLOSE",e[e.CURLY_BRACKET_OPEN=28]="CURLY_BRACKET_OPEN",e[e.CURLY_BRACKET_CLOSE=29]="CURLY_BRACKET_CLOSE",e[e.EQUALS=30]="EQUALS",e[e.SINGLE_QUOTE=31]="SINGLE_QUOTE",e[e.HASH=32]="HASH",e[e.DOUBLE_QUOTE=33]="DOUBLE_QUOTE",e[e.TEXT=34]="TEXT",e[e.RESERVED_KEYWORD=35]="RESERVED_KEYWORD",e[e.WHITESPACE=36]="WHITESPACE"}(x||(x={}));var w=function(e){for(var n=new $(e),r=[];!n.ended();){var t=n.curr(),o=void 0;if("<"===t)if("</"===n.peek(2))o=P(x.CLOSE_TAG,n.pos,n.take(2));else if("\x3c!--"===n.peek(4)){for(var i=n.take(4);!n.ended();){var a=n.curr();if("-"===a&&"--\x3e"===n.peek(3)){i+=n.take(3);break}n.next(),i+=a}o=P(x.COMMENT,n.pos,i)}else o="<="===n.peek(2)?P(x.LESS_THAN_OR_EQUAL,n.pos,n.take(2)):P(x.LESS_THAN,n.pos,n.shift());else if("&"===t&&"&&"===n.peek(2))o=P(x.AND,n.pos,n.take(2));else if("|"===t&&"||"===n.peek(2))o=P(x.OR,n.pos,n.take(2));else if(">"===t)o=">="===n.peek(2)?P(x.GREATER_THAN_OR_EQUAL,n.pos,n.take(2)):P(x.GREATER_THAN,n.pos,n.shift());else if("="===t)o="==="===n.peek(3)?P(x.TRIPPLE_EQUELS,n.pos,n.take(3)):"=="===n.peek(2)?P(x.DOUBLE_EQUALS,n.pos,n.take(2)):P(x.EQUALS,n.pos,n.shift());else if(":"===t)o=P(x.COLON,n.pos,n.shift());else if(";"===t)o=P(x.SEMICOLON,n.pos,n.shift());else if("@"===t)o=P(x.AT,n.pos,n.shift());else if(","===t)o=P(x.COMMA,n.pos,n.shift());else if("'"===t)o=P(x.SINGLE_QUOTE,n.pos,n.shift());else if("#"===t)o=P(x.HASH,n.pos,n.shift());else if("!"===t)o="!=="===n.peek(3)?P(x.NOT_DOUBLE_EQUALS,n.pos,n.take(3)):"!="===n.peek(2)?P(x.NOT_EQUALS,n.pos,n.take(2)):P(x.BANG,n.pos,n.shift());else if("/"===t){if("/*"===n.peek(2)){n.match(/.*?\*\//);continue}o=P(x.BACKSLASH,n.pos,n.shift())}else if("."===t)o=/\.\d/.test(n.peek(2))?Y(n):P(x.PERIOD,n.pos,n.shift());else if('"'===t)o=P(x.DOUBLE_QUOTE,n.pos,n.shift());else if("+"===t)o=P(x.PLUS,n.pos,n.shift());else if("-"===t)o=/\-\d/.test(n.peek(2))?Y(n):P(x.MINUS,n.pos,n.shift());else if("*"===t)o=P(x.STAR,n.pos,n.shift());else if("%"===t)o=P(x.PERCENT,n.pos,n.shift());else if("["===t)o=P(x.BRACKET_OPEN,n.pos,n.shift());else if("]"===t)o=P(x.BRACKET_CLOSE,n.pos,n.shift());else if("("===t)o=P(x.PAREN_OPEN,n.pos,n.shift());else if(")"===t)o=P(x.PAREN_CLOSE,n.pos,n.shift());else if("{"===t)o=P(x.CURLY_BRACKET_OPEN,n.pos,n.shift());else if("}"===t)o=P(x.CURLY_BRACKET_CLOSE,n.pos,n.shift());else if(/\d/.test(t))o=Y(n);else if(/[\s\r\n\t]/.test(t))o=P(x.WHITESPACE,n.pos,n.scan(/[\s\r\n\t]/));else{var u=n.pos,s=n.scan(/[^-<>,='":@;\.\/\\(){}\[\]\s\r\n\t]/)||n.shift();o=P("undefined"===s?x.RESERVED_KEYWORD:x.TEXT,u,s)}r.push(o)}return new K(e,r)},Y=function(e){return P(x.NUMBER,e.pos,e.match(/^\-?(\d+(\.\d+)?|\.\d+)/))},V="undefined"!=typeof window&&window.cache?window.cache.parseModuleSource||(window.cache.parseModuleSource={}):{},G=function(e,n){if(V[e])return V[e];var r={source:e,filePath:n,scanner:w(e),diagnostics:[]},t=k(r);return V[e]={root:t,diagnostics:r.diagnostics}},H=function(e,n){if(V[e])return V[e];var r={source:e,scanner:w(e),filePath:n,diagnostics:[]},t=de(r);return V[e]={root:t,diagnostics:r.diagnostics}},k=function(n){for(var r=n.scanner,t=[];!r.ended();){var o=F(n);if(!o)return null;t.push(o)}return 1===t.length?t[0]:{type:e.PCExpressionType.FRAGMENT,location:D(0,r.source.length,r.source),childNodes:t}},F=function(e){if(!Ie(e))return null;var n=e.scanner;switch(n.curr().type){case x.WHITESPACE:return Le(e);case x.LESS_THAN:return Re(e);case x.CLOSE_TAG:return Se(e);case x.COMMENT:return Te(e);default:return fe(n)?j(e,X):Le(e)}},j=function(n,r){var t=n.scanner,o=t.curr();t.next(),t.next(),me(n);var i=r(n);return i?(me(n),Me(n,[x.BRACKET_CLOSE],null,D(o,t.curr(),n.source))?(t.next(),Me(n,[x.BRACKET_CLOSE],"Missing closing ] character.",B(o,n.source))?(t.next(),{type:e.PCExpressionType.BLOCK,location:D(o,t.curr(),t.source),value:i}):null):null):null},Q=function(n){var r=n.scanner;switch(r.curr().value){case"bind":return ae(n);case"repeat":return ce(n);case"if":return se(n,e.BKExpressionType.IF);case"elseif":return se(n,e.BKExpressionType.ELSEIF);case"else":return se(n,e.BKExpressionType.ELSE);case"property":return ue(n,e.BKExpressionType.PROPERTY);default:return Pe(n,"Unexpected block type "+r.curr().value+"."),null}},X=function(e){var n=e.scanner;switch(n.curr().value){case"bind":return ae(e);case"elseif":case"else":case"if":return Pe(e,"Condition blocks can only be added to elements, for example: <div [[if condition]]></div>."),null;case"repeat":return Pe(e,"Repeat blocks can only be added to elements, for example: <div [[repeat items in item, i]]></div>."),null;default:return Pe(e,"Unexpected block type "+n.curr().value+"."),null}},W=function(e){var n=e.scanner;switch(n.curr().value){case"bind":return ae(e);case"elseif":case"else":case"if":return Pe(e,"Condition blocks cannot be assigned to attributes."),null;case"repeat":return Pe(e,"Repeat blocks cannot be assigned to attributes."),null;default:return Pe(e,"Unexpected block type "+n.curr().value+"."),null}},J=function(e){return q(e)},q=function(n){if(!Ie(n))return null;var r=n.scanner,t=z(n);me(n);var o=r.curr(),i=o?o.type:-1;if(!(i===x.AND||i===x.OR||i==x.PLUS||i===x.MINUS||i===x.STAR||i===x.BACKSLASH||i===x.DOUBLE_EQUALS||i===x.TRIPPLE_EQUELS||i===x.GREATER_THAN||i===x.LESS_THAN||i===x.LESS_THAN_OR_EQUAL||i===x.GREATER_THAN_OR_EQUAL||i===x.NOT_EQUALS||i===x.NOT_DOUBLE_EQUALS))return t;r.next(),me(n);var a=q(n);return a?{type:e.BKExpressionType.OPERATION,left:t,right:a,operator:o.value,location:D(t.location.start,a.location.end,r.source)}:null},z=function(e){var n=e.scanner;switch(me(e),n.curr().type){case x.BANG:return le(e);case x.SINGLE_QUOTE:case x.DOUBLE_QUOTE:return Z(e);case x.NUMBER:return ee(e);case x.CURLY_BRACKET_OPEN:return ne(e);case x.BRACKET_OPEN:return re(e);case x.PAREN_OPEN:return oe(e);case x.TEXT:return Ee(e);case x.RESERVED_KEYWORD:return ie(e);default:return Pe(e),null}},Z=function(n){var r=n.scanner,t=r.curr();r.next();for(var o="";!r.ended();){var i=r.curr();if(i.value===t.value)break;"\\"!==i.value?(o+=i.value,r.next()):(o+=r.next().value,r.next())}return Oe(n,t)?(r.next(),{type:e.BKExpressionType.STRING,location:D(t,r.curr(),r.source),value:o}):null},ee=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.NUMBER,value:t.value,location:D(t,r.curr(),r.source)}},ne=function(n){var r=n.scanner,t=r.curr();r.next();for(var o=[];!r.ended()&&(me(n),r.curr().type!==x.CURLY_BRACKET_CLOSE);){var i=te(n);if(!i)return null;o.push(i),me(n);var a=r.curr();if(a.type!==x.CURLY_BRACKET_CLOSE){if(a.type!==x.COMMA&&a)return Pe(n),null;r.next()}}return r.next(),{type:e.BKExpressionType.OBJECT,location:D(t,r.curr(),r.source),properties:o}},re=function(n){var r=n.scanner,t=r.curr();r.next(),me(n);var o=[];if(r.curr().type!==x.BRACKET_CLOSE)for(;;){if(o.push(z(n)),me(n),r.curr().type===x.BRACKET_CLOSE)break;if(!Me(n,[x.COMMA],"Missing , delimiter in array.",D(t,r.curr(),n.source)))return null;r.next()}return r.next(),{type:e.BKExpressionType.ARRAY,location:D(t,r.curr(),r.source),values:o}},te=function(n){var r,t=n.scanner;switch(t.curr().type){case x.SINGLE_QUOTE:case x.DOUBLE_QUOTE:r=Z(n);break;default:r=pe(n)}if(me(n),!Me(n,[x.COLON],"Missing : for object."))return null;t.next(),me(n);var o=J(n);return{type:e.BKExpressionType.KEY_VALUE_PAIR,location:D(r.location.start,o.location.end,t.source),key:r.name,value:o}},oe=function(n){var r=n.scanner,t=r.curr();r.next();var o=J(n);return r.next(),{type:e.BKExpressionType.GROUP,value:o,location:D(t,r.curr(),r.source)}},ie=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.RESERVED_KEYWORD,value:t.value,location:D(t,r.curr(),r.source)}},ae=function(n){var r=n.scanner,t=r.curr();r.next(),r.next(),n.startToken=t;var o=J(n);return n.startToken=void 0,o?{type:e.BKExpressionType.BIND,value:o,location:D(t,r.curr(),r.source)}:null},ue=function(e,n){var r=e.scanner,t=r.curr();return r.next(),r.next(),{type:n,name:pe(e).name,location:D(t,r.curr(),r.source)}},se=function(e,n){var r=e.scanner,t=r.curr();return r.next(),me(e),{type:n,condition:r.curr().type!==x.BRACKET_CLOSE?J(e):null,location:D(t,r.curr(),r.source)}},ce=function(n){var r=n.scanner,t=r.curr();if(r.next(),me(n),!Me(n,[x.TEXT],"Repeat block missing collection parameter.",B(t,n.source)))return null;var o=J(n);if(me(n),!Me(n,[x.TEXT],null,D(t,r.curr(),n.source)))return null;if("as"!==r.curr().value)return Pe(n,'Repeat block missing "as" keyword.',D(t,r.curr(),n.source)),null;if(r.next(),me(n),!Me(n,[x.TEXT],null,D(t,r.curr(),n.source)))return null;var i,a=pe(n);if(me(n),","===r.curr().value){if(r.next(),me(n),!Me(n,[x.TEXT],"Unexpected token. Repeat index parameter should only contain characters a-zA-Z.",D(t,r.curr(),n.source)))return null;i=pe(n)}return{type:e.BKExpressionType.REPEAT,location:D(t,r.curr(),r.source),each:o,asKey:i,asValue:a}},Ee=function(n){for(var r=n.scanner,t=pe(n),o=[t];!r.ended()&&r.curr().type===x.PERIOD;){if(r.next(),!Me(n,[x.TEXT]))return null;o.push(pe(n))}return 1===o.length?o[0]:{type:e.BKExpressionType.PROP_REFERENCE,path:o,location:D(t.location.start,r.curr(),r.source)}},pe=function(n){var r=n.scanner;me(n);var t=r.curr();return r.next(),{type:e.BKExpressionType.VAR_REFERENCE,name:t.value,location:D(t,r.curr(),r.source)}},le=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.BKExpressionType.NOT,value:z(n),location:D(t,r.curr(),r.source)}},Te=function(n){var r=n.scanner,t=r.curr();return r.next(),{type:e.PCExpressionType.COMMENT,value:t.value.substr(4,t.value.length-7),location:D(t,r.curr(),r.source)}},fe=function(e){return e.curr().type===x.BRACKET_OPEN&&e.peek(1).type===x.BRACKET_OPEN},de=function(n){for(var r=n.scanner,t=r.curr(),o=[];;){if(me(n),r.ended()||r.curr().type===x.CLOSE_TAG)break;var i=_e(n);if(!i)return null;o.push(i)}return{type:e.CSSExpressionType.SHEET,children:o,location:D(t,r.curr(),r.source)}},_e=function(e){switch(e.scanner.curr().type){case x.AT:return ye(e);default:return ve(e)}},ye=function(n){var r=n.scanner,t=r.curr();r.next();for(var o="";r.curr().type!==x.WHITESPACE&&r.curr().type!==x.CURLY_BRACKET_OPEN;)o+=r.curr().value,r.next();r.next();var i=[],a=[];for(me(n);!r.ended()&&(me(n),r.curr().type!==x.CURLY_BRACKET_OPEN&&r.curr().type!==x.SEMICOLON);)r.curr().type===x.SINGLE_QUOTE||r.curr().type===x.DOUBLE_QUOTE?i.push(Z(n).value):(i.push(r.curr().value),r.next());var u=r.curr();if(r.next(),u.type===x.CURLY_BRACKET_OPEN){for(;!r.ended()&&(me(n),r.curr().type!==x.CURLY_BRACKET_CLOSE);){var s=_e(n);if(!s)return null;a.push(s)}if(!Me(n,[x.CURLY_BRACKET_CLOSE],"Missing closing } character.",B(t,n.source)))return null;r.next()}return{type:e.CSSExpressionType.AT_RULE,name:o,params:i,children:a,location:D(t,r.curr(),r.source)}},ve=function(n){for(var r=n.scanner,t=r.curr(),o="";!r.ended();){var i=r.curr();if(i.type==x.CURLY_BRACKET_OPEN||i.type===x.SEMICOLON||i.type===x.CURLY_BRACKET_CLOSE||i.type===x.CLOSE_TAG)break;i.type===x.SINGLE_QUOTE||i.type===x.DOUBLE_QUOTE?o+=i.value+Z(n).value+i.value:(o+=i.value,r.next())}if(!Me(n,[x.SEMICOLON,x.CURLY_BRACKET_OPEN,x.CURLY_BRACKET_CLOSE]))return null;if(r.curr().type===x.SEMICOLON||r.curr().type===x.CURLY_BRACKET_CLOSE){var a=o.match(/(.+?):(.+)/),u=(a[0],a[1]),s=a[2];return r.curr().type===x.SEMICOLON&&r.next(),{type:e.CSSExpressionType.DECLARATION_PROPERTY,location:D(t,r.curr(),r.source),name:u,value:s}}r.next();var c=[];for(me(n);!r.ended()&&r.curr().type!==x.CURLY_BRACKET_CLOSE;){var E=ve(n);if(!E)return null;c.push(E),me(n)}return Me(n,[x.CURLY_BRACKET_CLOSE],"Missing closing } character.",B(t,n.source))?(r.next(),o=o.trim(),{type:e.CSSExpressionType.STYLE_RULE,children:c,selectorText:o,location:D(t,r.curr(),r.source)}):null},Se=function(n){var r=n.scanner,t=r.curr();r.next();var o=xe(n);return o?Me(n,[x.GREATER_THAN],"Missing > character.",D(t,r.curr(),n.source))?(r.next(),{type:e.PCExpressionType.END_TAG,name:o,location:D(t,r.curr(),r.source)}):null:(Pe(n,"Missing close tag name.",B(t,n.source)),null)},Re=function(n){var r=n.scanner,t=r.curr();r.next();var o=xe(n);if(!o)return Pe(n,"Missing open tag name.",B(t,n.source)),null;if(!r.ended()&&!Me(n,[x.WHITESPACE,x.GREATER_THAN],'Tag name contains a character where " " or > is expected.',B(t,n.source)))return null;for(var i=[],a=[];!r.ended();){me(n);var u=r.curr();if(u.type===x.BACKSLASH||u.type==x.GREATER_THAN)break;if(fe(r)){var s=j(n,Q);if(!s)return null;a.push(s)}else{if(u.type!==x.TEXT)return Pe(n),null;var c=Ce(n);if(!c)return null;i.push(c)}}if(!Ie(n))return null;if(r.curr().type===x.BACKSLASH)return r.next(),r.next(),{type:e.PCExpressionType.SELF_CLOSING_ELEMENT,name:o,attributes:i,modifiers:a,location:D(t,r.curr(),r.source)};r.next();var E=r.curr(),p=Ne(o,n);if(!p)return null;var l=p[0],T=p[1];return T?{type:e.PCExpressionType.ELEMENT,startTag:{name:o,type:e.PCExpressionType.START_TAG,location:D(t,E,r.source),modifiers:a,attributes:i},childNodes:l,location:D(t,r.curr(),r.source),endTag:T}:(Pe(n,"Close tag is missing.",D(t,E,n.source)),null)},Ne=function(n,r){var t=r.scanner,o=[];if("style"===n){var i=de(r);if(!i)return null;if(me(r),!Me(r,[x.CLOSE_TAG]))return null;var a=Se(r);return a?[[i],a]:null}if("style"===n||"script"===n){for(var u="",s=t.curr();!t.ended()&&t.curr().type!==x.CLOSE_TAG;)u+=t.curr().value,t.next();return[[{type:e.PCExpressionType.TEXT_NODE,value:u,location:D(s,t.curr(),t.source)}],F(r)]}for(var c;!t.ended();){var E=F(r);if(!E)return null;if(E.type===e.PCExpressionType.END_TAG){c=E;break}o.push(E)}return[o,c]},Ce=function(n){var r,t=n.scanner,o=t.curr(),i=xe(n);return t.curr().type!==x.EQUALS||(t.next(),r=Ae(n))?{type:e.PCExpressionType.ATTRIBUTE,name:i,value:r,location:D(o,t.curr(),t.source)}:null},Ae=function(e){if(!Ie(e))return null;var n=e.scanner;switch(n.curr().type){case x.SINGLE_QUOTE:case x.DOUBLE_QUOTE:return he(e);default:return fe(n)?j(e,W):(Pe(e),null)}},Oe=function(e,n){return Me(e,[n.type],"Missing closing "+n.value+" character.",B(n,e.source))},he=function(n){var r=n.scanner,t=r.curr(),o=[],i=!1;for(r.next();!r.ended();){var a=r.curr();if(a.type===t.type)break;if(fe(r)){i=!0;var u=j(n,W);if(!u)return null;o.push(u)}else r.next(),o.push({type:e.PCExpressionType.STRING,value:a.value,location:D(a.pos,r.curr(),r.source)})}if(!Oe(n,t))return null;r.next();var s=D(t,r.curr(),r.source);return i?{type:e.PCExpressionType.STRING_BLOCK,location:s,values:o}:{type:e.PCExpressionType.STRING,location:s,value:o.map(function(e){return e.value}).join("")}},Le=function(n){var r=n.scanner,t=r.curr();r.next();for(var o=t.value;!r.ended();){var i=r.curr();if(i.type===x.COMMENT||i.type===x.LESS_THAN||i.type==x.CLOSE_TAG||fe(r))break;r.next(),o+=i.value}return{type:e.PCExpressionType.TEXT_NODE,value:o,location:D(t,r.curr(),r.source)}},me=function(e){for(var n=e.scanner;!n.ended()&&n.curr().type===x.WHITESPACE;)n.next()},xe=function(e){for(var n=e.scanner,r="";!n.ended()&&/[a-zA-Z-][a-zA-Z0-9-]*/.test(n.curr().value);)r+=n.curr().value,n.next();return r||null},ge=function(e,n){if(!n)throw new Error("Unexpected end of file (missing closing expression).");var r=U(n,e);throw new Error('Unexpected token "'+n.value+'" at '+r.line+":"+r.column)},Pe=function(n,r,t){var o=n.scanner.curr(),i=t||(n.startToken?D(n.startToken,n.scanner.curr(),n.source):{start:U(o||n.scanner.source.length-1,n.scanner.source),end:U(o?o.pos+o.value.length:n.scanner.source.length,n.scanner.source)});return n.diagnostics.push({type:e.DiagnosticType.ERROR,location:i,message:r||(o?"Unexpected token.":"Unexpected end of file."),source:n.source,filePath:n.filePath}),!0},Ie=function(e,n,r){return!!e.scanner.curr()||(Pe(e,n,r),!1)},Me=function(e,n,r,t){var o=e.scanner.curr();return!(!o||-1===n.indexOf(o.type))||(Pe(e,r,t),!1)};!function(e){e.TANDEM="TANDEM",e.WEB="WEB"}(e.PaperclipTargetType||(e.PaperclipTargetType={}));var Ue=Symbol(),De=function(e,n){if(e[Ue]&&e[Ue][0]===e)return e[Ue][1];var r=He(e,n);return e[Ue]=[e,r],r},Be=function(e,n){var r=n.split("/");r.pop();var t=(e=e.replace("./","")).split("../"),o=t.pop();return r.splice(r.length-t.length,r.length),r.join("/")+"/"+o},be=function(e,n){var r={};return m(e).forEach(function(e){var t=Ve(e,n);t&&(r[e]=t)}),r},$e=function(e,n){var r={};return e.module.components.forEach(function(e){Object.assign(r,be(e.template,n))}),r},Ke=function(e,n){return n.components.find(function(n){return n.id===e})},we=function(e,n){var r=[],t=($e(e,n),$e(e,n));for(var o in t){var i=t[o];-1===r.indexOf(i)&&r.push(i)}return r},Ye=function(e,n){var r=e.resolvedImportUris,t=[];for(var o in r)t.push(n[r[o]]);return t},Ve=function(e,n){for(var r in n)for(var t=n[r],o=0,i=t.module.components.length;o<i;o++)if(t.module.components[o].id===e)return t},Ge=function(n,r,t){var o=r.readFile,i=r.resolveFile,a=void 0===i?Be:i;return void 0===t&&(t={}),t[n]?Promise.resolve(t):Promise.resolve(o(n)).then(G).then(function(r){var t=r.diagnostics.filter(function(n){return n.type===e.DiagnosticType.ERROR});if(t.length)throw t;return De(r.root,n)}).then(function(e){var r={};return t[n]={module:e,resolvedImportUris:r},e.imports.length?Promise.all(e.imports.map(function(e){return Promise.resolve(a(e.href,n)).then(function(n){return r[e.href]=n,Ge(n,{readFile:o,resolveFile:a},t)})})).then(function(){return t}):Promise.resolve(t)})},He=function(n,r){for(var t=n.type===e.PCExpressionType.FRAGMENT?n.childNodes:[n],o=[],u=[],E=[],p=[],l=0,T=t.length;l<T;l++){var f=t[l];if(f.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||f.type===e.PCExpressionType.ELEMENT){var d=f,_=a(d),y=i(d),v=s(d),S=c(d);if("component"===_&&d.type===e.PCExpressionType.ELEMENT){u.push(Qe(d,S,v,y));continue}if("link"===_){o.push(Xe(v));continue}if("style"===_){E.push(d);continue}}p.push(f)}return{source:n,uri:r,imports:o,components:u,globalStyles:E,unhandledExpressions:p}},ke=function(e){for(var n={},r=0,t=e.split(/,\s+/g);r<t.length;r++){var o=t[r].split("="),i=o[0],a=o[1];n[i]=a}return n},Fe=function(e,n){return e.metadata.filter(function(e){return e.name===n})},je=function(e,n){return Fe(e,n).shift()},Qe=function(n,r,t,o){for(var c,E,p,l=[],f=r.map(function(e){return e.value}).filter(function(n){return n.type===e.BKExpressionType.PROPERTY}),d=0,_=t.length;d<_;d++){var y=t[d];"id"===y.name&&(c=u(y))}for(var d=0,_=o.length;d<_;d++){var v=o[d];if(v.type===e.PCExpressionType.SELF_CLOSING_ELEMENT||v.type===e.PCExpressionType.ELEMENT){var S=v,R=a(S);s(S),i(S);"style"===R?E=S:"template"===R?p=S:"meta"===R&&l.push({name:T(S,"name"),params:ke(T(S,"content")||"")})}}return{source:n,id:c,style:E,metadata:l,properties:f,template:p}},Xe=function(e){for(var n,r,t=0,o=e.length;t<o;t++){var i=e[t];"href"===i.name?n=u(i):"type"===i.name&&(r=u(i))}return{type:r,href:n}},We=function(e,n){return Ge(e,n.io).then(function(n){return{code:ze(e,n),graph:n,entryDependency:n[e]}})},Je=function(n){switch(n.type){case e.BKExpressionType.NOT:return"!"+Je(n.value);case e.BKExpressionType.PROP_REFERENCE:return(t=n).path.map(Je).join(".");case e.BKExpressionType.STRING:var r=n;return JSON.stringify(r.value);case e.BKExpressionType.NUMBER:return n.value;case e.BKExpressionType.VAR_REFERENCE:var t=n;return t.name;case e.BKExpressionType.ARRAY:return"["+n.values.map(Je)+"]";case e.BKExpressionType.OBJECT:for(var o=n,i="{",a=0,u=o.properties.length;a<u;a++){var s=o.properties[a];i+=s.key+":"+Je(s.value)+", "}return i+="}";case e.BKExpressionType.GROUP:return"("+Je(n.value)+")";case e.BKExpressionType.RESERVED_KEYWORD:return n.value;case e.BKExpressionType.OPERATION:var c=n,E=c.left,p=c.operator,l=c.right;return Je(E)+" "+p+" "+Je(l);default:throw new Error("Unable to transpile BK block "+n.type)}},qe=function(e){return e.replace(/[\d-]+/g,"_")},ze=function(e,n){var r="((window) => {";r+='var document = window.document;const $$each = (object, iterator) => {if (Array.isArray(object)) {object.forEach(iterator);} else {for (const key in object) {iterator(object[key], key);}}};const $$count = (object) => {return Array.isArray(object) ? object.length : Object.keys(object).length;};const $$defineModule = (run) => {let exports;return () => {if (exports) return exports;exports = {};return exports = run((dep) => {return $$modules[dep]()});}};const $$setElementProperty = (element, property, value) => {if (property === "style" && typeof value !== "string") {\nelement.style = "";\nObject.assign(element.style, value);\n} else {\nelement[property] = value;}\n};let updating = false;let toUpdate = [];const $$requestUpdate = (object) => {if (toUpdate.indexOf(object) === -1) {toUpdate.push(object);}if (updating) {return;}updating = true;requestAnimationFrame(function() {for(let i = 0; i < toUpdate.length; i++) {const target = toUpdate[i];target.update();}toUpdate = [];updating = false;});};',r+="$$modules = {};";for(var t in n)r+='$$modules["'+t+'"] = '+Ze(n[t].module,n[t].resolvedImportUris)+";";return r+='const entry = $$modules["'+e+'"]();',r+="return {entry,modules: $$modules};})(window)"},Ze=function(e,n){for(var r=e.source,t=e.imports,o=e.globalStyles,i=e.components,a=(e.unhandledExpressions,{uri:e.uri,varCount:0,root:r}),u="$$defineModule((require) => {",s=In(o,a),c=0,E=s.length;c<E;c++)u+=(l=s[c]).content,u+="document.body.appendChild("+l.varName+");";for(var c=0,E=t.length;c<E;c++){var p=t[c],l=Un("import","require("+JSON.stringify(n[p.href])+")",a);u+=l.content}for(var c=0,E=i.length;c<E;c++)u+=nn(i[c],a).content;return u+="return {};",u+="})"},en=function(e){return"(() => { const binding = () => { "+e+" }; binding(); return binding; })()"},nn=function(e,n){var r=e.id,t=e.style,i=e.template,a=e.properties,u=Dn(qe(r),n),s=o({},n,{varCount:0,contextName:"this"}),c=t&&Tn(t,s);return{varName:u,bindings:[],content:"class "+u+" extends HTMLElement {constructor() {super();this.$$bindings = [];}connectedCallback() {this.render();}"+a.map(function(e){var n=e.name;return"get "+n+"() {return this.$$"+n+";}set "+n+"(value) {if (this.$$"+n+" === value || String(this.$$"+n+") === String(value)) {return;}const oldValue = this.$"+n+";this.$$"+n+' = value;if (typeof value !== "object") {this.setAttribute('+JSON.stringify(n)+", value);}if (this._rendered) {$$requestUpdate(this);}}"}).join("\n")+'render() {if (this._rendered) {return;}this._rendered = true;const shadow = this.attachShadow({ mode: "open" });'+(c?c.content+"shadow.appendChild("+c.varName+");":"")+a.map(function(e){var n=e.name,r=e.defaultValue;return"if (this.$$"+n+" == null) {this.$$"+n+" = "+(r||'this.getAttribute("'+n+'");')+"}"}).join("\n")+"let $$bindings = [];"+(i?i.childNodes.map(function(e){var n=rn(e,s);return e&&n?n.content+(n.bindings.length?"$$bindings = $$bindings.concat("+n.bindings.map(function(e){return"(() => {const $$binding = () => {const { "+a.map(function(e){return e.name}).join(",")+" } = this;"+e+"};$$binding();return $$binding;})()"})+");":"")+"shadow.appendChild("+n.varName+");":""}).join(""):"")+"this.$$bindings = $$bindings;}cloneShallow() {const clone = super.cloneShallow();clone._rendered = true;return clone;}static get observedAttributes() {return "+JSON.stringify(a.map(function(e){return e.name}))+";}attributeChangedCallback(name, oldValue, newValue) {if (super.attributeChangedCallback) {super.attributeChangedCallback(name, oldValue, newValue);}this[name] = newValue;}update() {if (!this._rendered) {return;}let bindings = this.$$bindings || [];"+pn("bindings")+'}}if (!customElements.get("'+r+'")) {customElements.define("'+r+'", '+u+');} else {console.error("Custom element \\"'+r+'\\" is already defined, ignoring");}'}},rn=function(n,r){switch(n.type){case e.PCExpressionType.FRAGMENT:return tn(n,r);case e.PCExpressionType.TEXT_NODE:return on(n,r);case e.PCExpressionType.BLOCK:return an(n,r);case e.PCExpressionType.ELEMENT:return ln(n,r);case e.PCExpressionType.SELF_CLOSING_ELEMENT:return un(n,r)}return null},tn=function(e,n){return Bn('document.createDocumentFragment("")',n)},on=function(e,n){return Kn(Bn("document.createTextNode("+JSON.stringify(e.value.replace(/[\s\r\n\t]+/g," "))+")",n),e,n)},an=function(e,n){var r=Bn('document.createTextNode("")',n),t=(r=Kn(r,e,n)).varName+"$$currentValue";return r.content+="let "+t+";",r.bindings.push(En(t,Je(e.value.value),function(e){return r.varName+".nodeValue = "+e},n)),r},un=function(e,n){return sn(e,Kn(cn(e,n),e,n),n)},sn=function(n,r,t){if(!n.modifiers.length)return r;for(var o,i,a,u,s,c=n.modifiers,p=r,l=0,T=c.length;l<T;l++)(M=c[l].value).type===e.BKExpressionType.IF?o=M:M.type===e.BKExpressionType.ELSE?i=M:M.type===e.BKExpressionType.ELSEIF?a=M:M.type===e.BKExpressionType.REPEAT?u=M:M.type===e.BKExpressionType.BIND&&(s=M);if(s){var f=s.value,d=(p={varName:r.varName,content:r.content,bindings:r.bindings.slice()}).varName+"$$spreadValue",_=Je(f);p.content+="let "+d+";",p.bindings.push(En(d,_,function(e){return"for (const $$key in "+d+") {$$setElementProperty("+r.varName+", $$key, "+d+"[$$key]);}"},t)),r=p}if(u){var y=u.each,v=u.asKey,S=u.asValue,R=Je(y),N=v?Je(v):"index",O=Je(S),h=$n(t),m=h.fragment,x=h.start,g=h.end,P=(p=m).varName+"$$currentValue",I=p.varName+"$$childBindings";p.content+="let "+P+" = [];let "+I+" = [];",p.bindings.push("let $$newValue = ("+R+") || [];if ($$newValue === "+P+") {return;}const $$oldValue = "+P+";"+P+" = $$newValue;const $$parent = "+x.varName+".parentNode;const $$startIndex = Array.prototype.indexOf.call($$parent.childNodes, "+x.varName+"); const $$newValueCount = $$count($$newValue);const $$oldValueCount = $$count($$oldValue);if ($$newValueCount > $$oldValueCount) {for (let $$i = $$newValueCount - $$oldValueCount; $$i--;) {"+r.content+"$$parent.insertBefore("+r.varName+", "+g.varName+");const $$bindings = ["+r.bindings.map(function(e){return"("+O+", "+N+") => { "+e+"}"}).join(",")+"];"+I+".push(($$newValue, $$newKey) => {"+pn("$$bindings","$$newValue, $$newKey")+"});}} else if ($$oldValue.length < $$newValue.length) {}let i = 0;$$each($$newValue, (value, k) => {"+I+"[i++](value, k);});"),r=p}if(o||a||i){for(var M=o||a||i,U=M.condition,D=t.root===n||t.root.startTag===n?[t.root]:L(t.root,n).childNodes,B=D.findIndex(function(r){return r===n||n.type===e.PCExpressionType.START_TAG&&r.type===e.PCExpressionType.ELEMENT&&r.startTag===n}),b=void 0,l=B+1;l--;){var $=D[l];if(E($)&&C($,e.BKExpressionType.IF)){b="condition_"+A($,t.root).join("");break}}if(!b)throw new Error("Element condition "+e.BKExpressionType[M.type]+" defined without an IF block.");var K=$n(t),m=K.fragment,x=K.start,g=K.end,w=(p=m).varName+"$$bindings",P=p.varName+"$$currentValue";m.content+="let "+w+" = [];let "+P+" = false;",o&&(m.content+="let "+b+" = Infinity;"),p.bindings.push("const newValue = Boolean("+(U?Je(U):"true")+") && "+b+" >= "+B+";if (newValue) {"+b+" = "+B+";} else if ("+b+" === "+B+") {"+b+" = Infinity;}if (newValue && newValue === "+P+") {if ("+P+") {"+pn(w)+"}return;}"+P+" = newValue;"+w+" = [];if (newValue) {const elementFragment = document.createDocumentFragment();"+r.content+(r.bindings.length?w+" = "+w+".concat("+r.bindings.map(en)+");":"")+"elementFragment.appendChild("+r.varName+");"+g.varName+".parentNode.insertBefore(elementFragment, "+g.varName+");} else {let curr = "+x.varName+".nextSibling;while(curr !== "+g.varName+") {curr.parentNode.removeChild(curr);curr = "+x.varName+".nextSibling;}}")}return p},cn=function(n,r){for(var t=Bn('document.createElement("'+n.name+'")',r),o=0,i=n.attributes.length;o<i;o++)!function(o,i){var a=n.attributes[o],u=a.name,s=a.value,c=qe(u);if(s){if(s.type===e.PCExpressionType.STRING){var E=s;t.content+=t.varName+'.setAttribute("'+u+'", '+JSON.stringify(E.value)+");\n"}else if(s.type===e.PCExpressionType.STRING_BLOCK||s.type===e.PCExpressionType.BLOCK){var p=t.varName+"$$"+c+"$$currentValue";t.content+="let "+p+";\n";var l=void 0;l=s.type===e.PCExpressionType.STRING_BLOCK?En(p,s.values.map(function(n){return n.type===e.PCExpressionType.BLOCK?Je(n.value.value):JSON.stringify(n.value)}).join(" + "),function(e){return t.varName+'.setAttribute("'+u+'", '+e+")"},r):En(p,Je(s.value.value),function(e){return"$$setElementProperty("+t.varName+', "'+c+'", '+e+")"},r),t.bindings.push(l)}}else t.content+=t.varName+'.setAttribute("'+u+'", "true");'}(o);return t},En=function(e,n,r,t){return"let $$newValue = "+n+";if ($$newValue !== "+e+") {"+e+" = $$newValue;"+r(e)+"}"},pn=function(e,n){return void 0===n&&(n=""),"for (let i = 0, n = "+e+".length; i < n; i++) {"+e+"[i]("+n+");}"},ln=function(e,n){switch(e.startTag.name){case"style":return Tn(e,n);default:return sn(e.startTag,Mn(e,n),n)}},Tn=function(e,n){var r=Bn('document.createElement("style")',n);(r=Kn(r,e,n)).content+="if (window.$synthetic) {";var t=fn(e.childNodes[0],n);return r.content+=t.content+(r.varName+".$$setSheet(")+t.varName+");",r.content+="} else {"+r.varName+".textContent = "+JSON.stringify(gn(e.childNodes[0]))+";}",r},fn=function(e,n){var r=dn(e.children,n),t=bn("new CSSStyleSheet(["+r.map(function(e){return e.varName}).join(",")+"])",n);return t=Kn(t,e,n),t.content=r.map(function(e){return e.content}).join("\n")+t.content,t},dn=function(e,n){return e.map(function(e){return _n(e,n)}).filter(Boolean)},_n=function(n,r){switch(n.type){case e.CSSExpressionType.AT_RULE:return yn(n,r);case e.CSSExpressionType.STYLE_RULE:return mn(n,r)}throw new Error("Unexpected rule "+n.type)},yn=function(e,n){switch(e.name){case"media":return vn(e,n);case"keyframes":return Nn(e,n);case"font-face":return Sn(e,n);case"import":return On(e,n);case"charset":return hn(e,n)}},vn=function(e,n){return Cn(e,n,"CSSMediaRule",mn)},Sn=function(e,n){return Kn(bn("new CSSFontFaceRule("+xn(Rn(e),n)+")",n),e,n)},Rn=function(n){return n.children.filter(function(n){return n.type===e.CSSExpressionType.DECLARATION_PROPERTY})},Nn=function(e,n){return Cn(e,n,"CSSKeyframesRule",An)},Cn=function(e,n,r,t){var o=e.children.map(function(e){return t(e,n)}).filter(Boolean),i=bn("new "+r+"("+JSON.stringify(e.params.join(" "))+", ["+o.map(function(e){return e.varName}).join(",")+"])",n);return i.content=o.map(function(e){return e.content}).join("\n")+i.content,i},An=function(e,n){return Ln(e,"CSSKeyframeRule",n)},On=function(e,n){return null},hn=function(e,n){return null},Ln=function(e,n,r){return bn("new "+n+"("+JSON.stringify(e.selectorText)+", "+xn(Rn(e),r)+")",r)},mn=function(e,n){return Ln(e,"CSSStyleRule",n)},xn=function(e,n){for(var r="{",t=0,o=e;t<o.length;t++){var i=o[t];r+='"'+i.name+'": "'+i.value.replace(/"/g,'\\"').replace(/[\s\r\n\t]+/g," ")+'", '}return"CSSStyleDeclaration.fromObject("+(r+="}")+")"},gn=function(e,n){return void 0===n&&(n=function(e){return e}),e.children.map(function(e){return Pn(e,n)}).filter(Boolean).join(" ")},Pn=function(n,r){switch(n.type){case e.CSSExpressionType.AT_RULE:var t=n;if("charset"===t.name||"import"===t.name)return null;a="@"+t.name+" "+t.params+" {";return a+=t.children.map(function(e){return Pn(e,r)}).filter(Boolean).join(" "),a+="}";case e.CSSExpressionType.DECLARATION_PROPERTY:var o=n;return o.name+": "+o.value+";";case e.CSSExpressionType.STYLE_RULE:var i=n,a=r(i.selectorText,i)+" {";return a+=i.children.map(function(e){return Pn(e,r)}).filter(Boolean).join(""),a+="}"}},In=function(n,r){for(var t=[],o=0,i=n.length;o<i;o++){var a=n[o];if(a.type===e.PCExpressionType.TEXT_NODE&&/^[\s\r\n\t]+$/.test(a.value)){var u=n[o-1],s=n[o+1];if((!u||E(u))&&(!s||E(s)))continue}var c=rn(a,r);c&&t.push(c)}return t},Mn=function(e,n){var r=cn(e.startTag,n);r=Kn(r,e,n);for(var t=In(e.childNodes,n),o=0,i=t.length;o<i;o++){var a=t[o];r.content+=a.content,r.content+=r.varName+".appendChild("+a.varName+");\n",(u=r.bindings).push.apply(u,a.bindings)}return r;var u},Un=function(e,n,r){var t=Dn(e,r);return{varName:t,bindings:[],content:n?"let "+t+" = "+n+";\n":"let "+t+";\n"}},Dn=function(e,n){return e+"_"+n.varCount++},Bn=function(e,n){return Un("node",e,n)},bn=function(e,n){return Un("rule",e,n)},$n=function(e){var n=Bn('document.createDocumentFragment("")',e),r=Bn('document.createTextNode("")',e),t=Bn('document.createTextNode("")',e);return n.content+=r.content+""+t.content+n.varName+".appendChild("+r.varName+");"+n.varName+".appendChild("+t.varName+");",{fragment:n,start:r,end:t}},Kn=function(e,n,r){var t=o({uri:r.uri,type:n.type},n.location);return e.content+=e.varName+".source = "+JSON.stringify(t)+";",e};!function(e){e[e.OBJECT=1]="OBJECT",e[e.ARRAY=2]="ARRAY",e[e.STRING=4]="STRING",e[e.BOOLEAN=8]="BOOLEAN",e[e.NUMBER=16]="NUMBER",e[e.OPTIONAL=32]="OPTIONAL",e[e.EXTENDABLE=64]="EXTENDABLE",e[e.OBJECT_OR_ARRAY=3]="OBJECT_OR_ARRAY",e[e.ANY_PRIMITIVE=28]="ANY_PRIMITIVE",e[e.EXTENDABLE_OBJECT=65]="EXTENDABLE_OBJECT",e[e.ANY=95]="ANY",e[e.STRING_OR_NUMBER=20]="STRING_OR_NUMBER"}(e.InferredTypeKind||(e.InferredTypeKind={}));var wn={a:{href:e.InferredTypeKind.STRING}},Yn={},Vn=function(e,n){var r=n.currentScope[e[0]];return r&&(e=r.concat(e)),e},Gn=function(e,n){Vn(e,n);for(var r=n.context,t=0,o=e.length;t<o;t++){var i=e[t];if(!r[1]||!r[1][i])return;r=r[1][i]}return r},Hn=function(e,n,r){return o({},r,{currentScope:o({},r.currentScope,(t={},t[e]=n,t))});var t},kn=function(e,n){return o({},n,{currentScope:o({},n.currentScope,(r={},r[e]=void 0,r))});var r},Fn=function(e,n,r){if(!e)return r;var t=Qn(r.context,e,n);return jn(t,r)},jn=function(e,n){return o({},n,{context:e})},Qn=function(n,r,t,i){void 0===i&&(i=0);var a=r[i];if(i===r.length)return t.slice();var u=n.slice();n[0]===e.InferredTypeKind.ANY?u=[e.InferredTypeKind.OBJECT,{}]:n[0]&e.InferredTypeKind.ARRAY||(n[0],e.InferredTypeKind.OBJECT);var s=u[1]||{};return u=[u[0],o({},s,(c={},c[a]=Qn(s[a]||[e.InferredTypeKind.OBJECT,s],r,t,i+1),c))];var c},Xn=function(e,n){for(var r=0,t=e;r<t.length;r++){var o=t[r];n=Fn(o[0],o[1],n)}return n},Wn=function(e,n){return[e,n]},Jn=function(e,n){return void 0===n&&(n=null),[e,n]},qn=function(n){return void 0===n&&(n=Jn(e.InferredTypeKind.OBJECT,{})),{context:n,currentScope:{}}},zn=function(e){return e[0]},Zn=function(e){return e[1]},er=function(e){return nr(e,qn()).context},nr=function(n,r){switch(void 0===r&&(r=qn()),n.type){case e.PCExpressionType.TEXT_NODE:return r;case e.PCExpressionType.BLOCK:return tr(n,r);case e.PCExpressionType.FRAGMENT:return pr(n.childNodes,r);case e.PCExpressionType.ELEMENT:case e.PCExpressionType.SELF_CLOSING_ELEMENT:return rr(n,r)}return r},rr=function(n,r){return r=sr(n,r),C(n,e.BKExpressionType.REPEAT)||(r=pr(i(n),r)),r},tr=function(e,n){return r=ur(e.value,n),r[0],n=r[1];var r},or=function(e,n,r){return ir(e.map(function(e){var r=e[0],t=e[1],o=t[0],i=t[1];return r&&Wn(r,Jn(o&n,i))}),r)},ir=function(e,n){for(var r=[],t=0,o=e.length;t<o;t++){var i=e[t];n=Fn(i[0],i[1],n),r.push(i)}return[r,n]},ar=function(e,n,r){return ir(e.map(function(e){var r=e[0],t=e[1];t[0],t[1];return Wn(r,n)}),r)},ur=function(n,r){switch(n.type){case e.BKExpressionType.OPERATION:var t=n,o=t.left,i=t.operator,a=t.right,u=void 0,s=void 0;u=(g=ur(o,r))[0],r=g[1],s=(P=ur(a,r))[0],r=P[1];var c=u.concat(s);if(/^[\*\/\-%]$/.test(i))for(var E=0,p=c.length;E<p;E++){var l=c[E],T=l[0],f=l[1][0];r=Fn(T,[f&e.InferredTypeKind.NUMBER,null],r)}else{if("+"===i)return ar(c,Jn(e.InferredTypeKind.ANY),r);if("==="===i||"!=="===i){var d=c.reduce(function(e,n){return e&Zn(n)[0]},e.InferredTypeKind.ANY);return ar(c,Jn(d),r)}}return[c,r];case e.BKExpressionType.STRING:return[[Wn(null,Jn(e.InferredTypeKind.STRING))],r];case e.BKExpressionType.NUMBER:return[[Wn(null,Jn(e.InferredTypeKind.NUMBER))],r];case e.BKExpressionType.VAR_REFERENCE:case e.BKExpressionType.PROP_REFERENCE:var T=n.type===e.BKExpressionType.VAR_REFERENCE?[n.name]:n.path.map(function(e){return e.name}),_=Vn(T,r),y=Gn(_,r);return y||(r=Fn(_,y=[e.InferredTypeKind.ANY,null],r)),[[Wn(_,y)],r];case e.BKExpressionType.BIND:return ur((x=n).value,r);case e.BKExpressionType.OBJECT:for(var v,S=[],R=0,N=(x=n).properties;R<N.length;R++){var C=N[R];v=(I=ur(C.value,r))[0],r=I[1],S.push.apply(S,v)}return[S,r];case e.BKExpressionType.ARRAY:for(var A,S=[],O=0,h=(x=n).values;O<h.length;O++){var L=h[O];A=(M=ur(L,r))[0],r=M[1],S.push.apply(S,A)}return[S,r];case e.BKExpressionType.NOT:var m;return U=ur(n.value,r),m=U[0],r=U[1],[m,r];case e.BKExpressionType.IF:case e.BKExpressionType.ELSEIF:return ur((x=n).condition,r);case e.BKExpressionType.GROUP:var x=n;return ur(x.value,r);default:throw new Error("Unexpected expression "+n.type)}var g,P,I,M,U},sr=function(n,r){for(var t,o,a,u=0,s=N(n).modifiers;u<s.length;u++){var c=s[u];c.value.type===e.BKExpressionType.IF?t=c.value:c.value.type===e.BKExpressionType.ELSEIF?o=c.value:c.value.type===e.BKExpressionType.ELSE?c.value:c.value.type===e.BKExpressionType.REPEAT&&(a=c.value)}if(t||o){var E=(t||o).condition;(y=ur(E,r))[0],r=y[1]}if(a){var p=a.each,l=(a.asKey,a.asValue),T=void 0,f=void 0;f=(v=ur(p,r))[0],r=v[1],f=(S=or(f,e.InferredTypeKind.OBJECT_OR_ARRAY,r))[0],r=S[1],T=ur(l,r)[0];var d=zn(f[0]),_=zn(T[0])[0];r=Hn(_,d,r),r=cr(n,r)[1],r=Er(n,r)[1],r=pr(i(n),r),r=kn(_,r)}else r=cr(n,r)[1],r=Er(n,r)[1];return r;var y,v,S},cr=function(n,r){void 0===r&&(r=qn());for(var t=N(n),o=s(n),i=[],a=wn[t.name]||Yn,u=0,c=o.length;u<c;u++){var E=[],p=o[u],l=p.value,T=p.name;if(l){if(l.type===e.PCExpressionType.BLOCK){E=(d=ur(l.value.value,r))[0],r=d[1];var f=a[T];f&&(E=(_=or(E,f,r))[0],r=_[1])}i.push.apply(i,E)}}return[i,r];var d,_},Er=function(n,r){void 0===r&&(r=qn());N(n);for(var t=c(n),o=[],i=0,a=t.length;i<a;i++){var u=t[i],s=[];if(u.value.type===e.BKExpressionType.BIND){s=(v=ur(u.value.value,r))[0],r=v[1];for(var E=[],p=0,l=s;p<l.length;p++){var T=l[p],f=T[0],d=T[1],_=(d[0],d[1]),y=[f,[e.InferredTypeKind.EXTENDABLE_OBJECT,_]];E.push(y),r=Fn(y[0],y[1],r)}s=E}o.push.apply(o,s)}return[o,r];var v},pr=function(e,n){for(var r=0,t=e;r<t.length;r++){var o=t[r];n=nr(o,n)}return n},lr=function(e){},Tr={},fr=function(e,n){if(Tr[e])return Tr[e];var r={filePath:n,source:e,diagnostics:[],scanner:w(e)};return Tr[e]={root:dr(r),diagnostics:r.diagnostics}},dr=function(n){for(var r,t=n.scanner,o=t.curr(),i=[];!t.ended();)if(i.push(_r(n)),!r){if((r=t.curr())&&r.type!==x.WHITESPACE&&r.type!==x.COMMA&&!Me(n,[x.COMMA]))return null;t.next()}return 1===i.length?i[0]:{type:r.type===x.WHITESPACE?e.DcExpressionType.SPACED_LIST:e.DcExpressionType.COMMA_LIST,items:i,location:D(o,t.curr(),t.source)}},_r=function(e){var n=e.scanner;switch(me(e),n.curr().type){case x.SINGLE_QUOTE:case x.DOUBLE_QUOTE:return Z(e);case x.HASH:return yr(e);case x.NUMBER:return vr(e);case x.MINUS:return n.hasNext()&&n.peek(1).type===x.NUMBER?vr(e):Rr(e);case x.TEXT:return Rr(e);default:ge(n.source,n.curr())}},yr=function(n){for(var r=n.scanner,t=r.curr(),o="";!r.ended()&&r.curr().type!==x.WHITESPACE;)o+=r.curr().value,r.next();return{type:e.DcExpressionType.COLOR,value:o,location:D(t,r.curr(),r.source)}},vr=function(n){var r=n.scanner,t=r.curr(),o=Sr(n),i="";return r.ended()||r.curr().type===x.WHITESPACE||r.curr().type===x.COMMA||r.curr().type===x.PAREN_CLOSE||(i=r.curr().value,r.next()),{type:e.DcExpressionType.MEASUREMENT,value:o,unit:i,location:D(t,r.curr(),r.source)}},Sr=function(e){var n=e.scanner,r=n.curr().value;return"-"===r&&(r+=n.next().value),n.next(),r},Rr=function(n){var r=n.scanner,t=r.curr(),o=Cr(n);return r.ended()||r.curr().type!==x.PAREN_OPEN?{type:e.DcExpressionType.KEYWORD,name:o}:{type:e.DcExpressionType.CALL,name:o,params:Nr(n),location:D(t,r.curr(),r.source)}},Nr=function(e){for(var n=e.scanner,r=[];!n.ended()&&n.curr().type!==x.PAREN_CLOSE;)n.next(),me(e),r.push(_r(e));return Me(e,[x.PAREN_CLOSE])?(n.next(),r):null},Cr=function(e){for(var n=e.scanner,r="";!n.ended()&&n.curr().type!==x.WHITESPACE&&n.curr().type!==x.PAREN_OPEN&&n.curr().type!==x.PAREN_CLOSE;)r+=n.curr().value,n.next();return r},Ar=function(n){switch(n.type){case e.DcExpressionType.SPACED_LIST:return(r=n).items.map(Ar).join(" ");case e.DcExpressionType.COMMA_LIST:var r=n;return r.items.map(Ar).join(", ");case e.DcExpressionType.KEYWORD:return n.name;case e.DcExpressionType.CALL:var t=n;return t.name+"("+t.params.map(Ar).join(", ")+")";case e.DcExpressionType.COLOR:return n.value;case e.BKExpressionType.STRING:return JSON.stringify(n.value);case e.DcExpressionType.MEASUREMENT:var o=n;return""+o.value+o.unit;default:throw new Error("Unable to stringify CSS declaration value type "+n.type)}},Or=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MUTATED="MUTATED",n.SET_VALUE_MUTATION="SET_VALUE_MUTATION",n.INSERT_CHILD_MUTATION="INSERT_CHILD_MUTATION",n.REMOVE_CHILD_MUTATION="REMOVE_CHILD_MUTATION",n.SET_PROPERTY_MUTATION="SET_PROPERTY_MUTATION",n.REMOVE_MUTATION="REMOVE_MUTATION",n.createMutationEvent=function(e){return{type:n.MUTATED,mutation:e}},n.createSetValueMutation=function(e,n,r){return{type:e,target:n,newValue:r}},n.createInsertChildMutation=function(e,n,r,t,o){return void 0===t&&(t=Number.MAX_SAFE_INTEGER),{type:e,target:n,child:r,index:t,clone:o}},n.createRemoveChildMutation=function(e,n,r,t){return{type:e,target:n,child:r,index:t}},n.createMoveChildMutation=function(e,n,r,t,o){return{type:e,target:n,child:r,index:t,oldIndex:o}},n.createPropertyMutation=function(e,n,r,t,o,i,a){return{type:e,target:n,name:r,newValue:t,oldValue:o,oldName:i,index:a}},n.createRemoveMutation=function(e,n,r,t,o,i){return{type:e,target:n}}});r(Or);Or.MUTATED,Or.SET_VALUE_MUTATION,Or.INSERT_CHILD_MUTATION,Or.REMOVE_CHILD_MUTATION,Or.SET_PROPERTY_MUTATION,Or.REMOVE_MUTATION,Or.createMutationEvent,Or.createSetValueMutation,Or.createInsertChildMutation,Or.createRemoveChildMutation,Or.createMoveChildMutation,Or.createPropertyMutation,Or.createRemoveMutation;var hr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.STRING_REPLACE="STRING_REPLACE",n.createStringMutation=function(e,r,t){return void 0===t&&(t=""),{startIndex:e,endIndex:r,value:t,type:n.STRING_REPLACE}},n.editString=function(e,n,r){void 0===r&&(r=[]);for(var t=e,o=r.length,i=r.concat(n),a=0,u=n.length;a<u;a++){for(var s=n[a],c=s.startIndex,E=s.endIndex,p=s.value,l=c,T=E,f=!1,d=c===E,_=a+o,y=0;y<_;y++){var v=i[y],S=v.startIndex,R=v.endIndex,N=v.value,C=S===R,A=c===S,O=E===R,h=A&&d,L=O&&d,m=A&&C,x=O&&C,g=h||L||m||x;if(S<E&&S>c&&(T-=E-S),R>c&&R<E&&(l+=R-c),(c>=S&&E<=R||c<S&&E>=R)&&!g){f=!0;break}if(S<=c&&E>S){var P=N.length-(R-S);l=Math.max(0,l+P),T=Math.max(0,T+P)}}f||(t=t.substr(0,l)+p+t.substr(T))}return t}});r(hr);hr.STRING_REPLACE,hr.createStringMutation,hr.editString;var Lr=t(function(e,n){function r(e,r,t){for(var o=[].concat(e),i=[].concat(e),a=[].concat(r),u=[],s=[],c=0,E=i.length;c<E;c++){for(var p=i[c],l=void 0,T=1/0,f=0,d=a.length;f<d;f++){var _=t(p,S=a[f]);if(~_&&_<T&&(l=S,T=_),0===T)break}null!=l&&(i.splice(c--,1),E--,a.splice(a.indexOf(l),1),s[r.indexOf(l)]=[p,l])}for(c=i.length;c--;){var p=i[c],y=e.indexOf(p);u.push(n.createArrayDeleteMutation(p,y)),o.splice(y,1)}for(var c=0,E=a.length;c<E;c++){S=a[c];s[y=r.indexOf(S)]=[void 0,S]}for(var c=0,E=s.length;c<E;c++)if(null!=s[c]){var v=s[c],p=v[0],S=v[1],R=c;if(null==p)u.push(n.createArrayInsertMutation(R,S)),o.splice(R,0,S);else{var N=o.indexOf(p);u.push(n.createArrayUpdateMutation(e.indexOf(p),N,S,R)),N!==R&&(o.splice(N,1),o.splice(R,0,p))}}return n.createArrayMutation(u)}function t(e,r,t,o){void 0===t&&(t=function(e,n){return n}),void 0===o&&(o=function(e){return e});var i=e.slice();return n.eachArrayValueMutation(r,{insert:function(e){var n=e.index,r=e.value;i.splice(n,0,o(r))},delete:function(e){var n=e.index;i.splice(n,1)},update:function(e){var n=e.patchedOldIndex,r=e.newValue,o=e.index,a=i[n],u=t(a,r);u===a&&n===o||(n!==o&&i.splice(n,1),i.splice(o,0,u))}}),i}Object.defineProperty(n,"__esModule",{value:!0}),n.ARRAY_DIFF="ARRAY_DIFF",n.ARRAY_INSERT="ARRAY_INSERT",n.ARRAY_UPDATE="ARRAY_UPDATE",n.ARRAY_DELETE="ARRAY_DELETE",n.createArrayInsertMutation=function(e,r){return{type:n.ARRAY_INSERT,index:e,value:r}},n.createArrayUpdateMutation=function(e,r,t,o){return{type:n.ARRAY_UPDATE,index:o,newValue:t,originalOldIndex:e,patchedOldIndex:r}},n.createArrayDeleteMutation=function(e,r){return{type:n.ARRAY_DELETE,value:e,index:r}},n.createArrayMutation=function(e){return{type:n.ARRAY_DIFF,mutations:e}},n.diffArray=r,n.eachArrayValueMutation=function(e,r){e.mutations.forEach(function(e){switch(e.type){case n.ARRAY_INSERT:return r.insert(e);case n.ARRAY_DELETE:return r.delete(e);case n.ARRAY_UPDATE:return r.update(e)}})},n.patchArray=t});r(Lr);Lr.ARRAY_DIFF,Lr.ARRAY_INSERT,Lr.ARRAY_UPDATE,Lr.ARRAY_DELETE,Lr.createArrayInsertMutation,Lr.createArrayUpdateMutation,Lr.createArrayDeleteMutation,Lr.createArrayMutation,Lr.diffArray,Lr.eachArrayValueMutation,Lr.patchArray;var mr=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(Or),r(hr),r(Lr)});r(mr);var xr=mr.createStringMutation,gr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});!function(e){e.PX="PX",e.PERC="%",e.VW="vw",e.VH="vh",e.CM="cm",e.EM="em",e.EX="ex",e.IN="in",e.MM="mm",e.PC="pc",e.PT="pt",e.VMIN="vmin"}(n.CSSMeasurementTypes||(n.CSSMeasurementTypes={}));!function(e){e.HORIZONTAL="HORIZONTAL",e.VERTICAL="VERTICAL"}(n.Axis||(n.Axis={}));!function(e){e[e.azimuth=0]="azimuth",e[e.borderCollapse=1]="borderCollapse",e[e.borderSpacing=2]="borderSpacing",e[e.captionSide=3]="captionSide",e[e.color=4]="color",e[e.cursor=5]="cursor",e[e.direction=6]="direction",e[e.elevation=7]="elevation",e[e.emptyCells=8]="emptyCells",e[e.fontFamily=9]="fontFamily",e[e.fontSize=10]="fontSize",e[e.fontStyle=11]="fontStyle",e[e.fontVariant=12]="fontVariant",e[e.fontWeight=13]="fontWeight",e[e.font=14]="font",e[e.letterSpacing=15]="letterSpacing",e[e.lineHeight=16]="lineHeight",e[e.listStyleImage=17]="listStyleImage",e[e.listStylePosition=18]="listStylePosition",e[e.listStyleType=19]="listStyleType",e[e.listStyle=20]="listStyle",e[e.orphans=21]="orphans",e[e.pitchRange=22]="pitchRange",e[e.pitch=23]="pitch",e[e.quotes=24]="quotes",e[e.richness=25]="richness",e[e.speakHeader=26]="speakHeader",e[e.speakNumeral=27]="speakNumeral",e[e.speakPunctuation=28]="speakPunctuation",e[e.speak=29]="speak",e[e.speechRate=30]="speechRate",e[e.stress=31]="stress",e[e.textAlign=32]="textAlign",e[e.textIndent=33]="textIndent",e[e.textDecoration=34]="textDecoration",e[e.textTransform=35]="textTransform",e[e.visibility=36]="visibility",e[e.voiceFamily=37]="voiceFamily",e[e.volume=38]="volume",e[e.whiteSpace=39]="whiteSpace",e[e.widows=40]="widows",e[e.wordSpacing=41]="wordSpacing"}(n.INHERITED_CSS_STYLE_PROPERTIES||(n.INHERITED_CSS_STYLE_PROPERTIES={}))});r(gr);gr.CSSMeasurementTypes,gr.Axis,gr.INHERITED_CSS_STYLE_PROPERTIES;var Pr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CSS_STYLE_RULE_SET_SELECTOR_TEXT="CSS_STYLE_RULE_SET_SELECTOR_TEXT",n.CSS_STYLE_RULE_SET_STYLE="CSS_STYLE_RULE_SET_STYLE",n.CSS_STYLE_RULE_SET_STYLE_PROPERTY="CSS_STYLE_RULE_SET_STYLE_PROPERTY",n.CSS_PARENT_INSERT_RULE="CSS_PARENT_INSERT_RULE",n.CSS_PARENT_DELETE_RULE="CSS_PARENT_DELETE_RULE",n.CSS_PARENT_MOVE_RULE="CSS_PARENT_MOVE_RULE",n.CSS_INSERT_CSS_RULE_TEXT="CSS_INSERT_CSS_RULE_TEXT"});r(Pr);Pr.CSS_STYLE_RULE_SET_SELECTOR_TEXT,Pr.CSS_STYLE_RULE_SET_STYLE,Pr.CSS_STYLE_RULE_SET_STYLE_PROPERTY,Pr.CSS_PARENT_INSERT_RULE,Pr.CSS_PARENT_DELETE_RULE,Pr.CSS_PARENT_MOVE_RULE,Pr.CSS_INSERT_CSS_RULE_TEXT;var Ir=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SET_ELEMENT_ATTRIBUTE_EDIT="setElementAttributeEdit",n.ATTACH_SHADOW_ROOT_EDIT="attachShadowRootEdit",n.SET_TEXT_CONTENT="setTextContent",n.INSERT_HTML_EDIT="INSERT_HTML_EDIT",n.INSERT_CHILD_NODE_EDIT="INSERT_CHILD_NODE_EDIT",n.REMOVE_CHILD_NODE_EDIT="REMOVE_CHILD_NODE_EDIT",n.MOVE_CHILD_NODE_EDIT="MOVE_CHILD_NODE_EDIT",n.UPDATE_VALUE_NODE="UPDATE_VALUE_NODE"});r(Ir);Ir.SET_ELEMENT_ATTRIBUTE_EDIT,Ir.ATTACH_SHADOW_ROOT_EDIT,Ir.SET_TEXT_CONTENT,Ir.INSERT_HTML_EDIT,Ir.INSERT_CHILD_NODE_EDIT,Ir.REMOVE_CHILD_NODE_EDIT,Ir.MOVE_CHILD_NODE_EDIT,Ir.UPDATE_VALUE_NODE;var Mr=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(gr),r(Pr),r(Ir)});r(Mr);var Ur=Mr,Dr=Ur.UPDATE_VALUE_NODE,Br=Ur.SET_ELEMENT_ATTRIBUTE_EDIT,br=Ur.INSERT_CHILD_NODE_EDIT,$r=Ur.REMOVE_CHILD_NODE_EDIT,Kr=Ur.INSERT_HTML_EDIT,wr=(Ur.CSS_INSERT_CSS_RULE_TEXT,Ur.CSS_PARENT_DELETE_RULE,Ur.CSS_STYLE_RULE_SET_SELECTOR_TEXT,Ur.CSS_STYLE_RULE_SET_STYLE_PROPERTY,t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createInsertHTMLMutation=function(e,n,r){return{type:Ir.INSERT_HTML_EDIT,html:r,childIndex:n,target:e}}}));r(wr);wr.createInsertHTMLMutation;var Yr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.insertCSSRuleText=function(e,n,r){return{type:Pr.CSS_INSERT_CSS_RULE_TEXT,target:e,childIndex:n,cssText:r}}});r(Yr);Yr.insertCSSRuleText;var Vr=t(function(e,n){function r(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}Object.defineProperty(n,"__esModule",{value:!0}),r(wr),r(Yr)});r(Vr);var Gr=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r])}(Vr)});r(Gr);var Hr=Gr.createInsertHTMLMutation,kr=function(e,n){return{type:"PC_REMOVE_CHILD_NODE",index:n,target:e}},Fr=function(e){return{type:"PC_REMOVE_NODE",target:e}},jr=function(e,n){var r=G(e),t=Xr(r.root,n.target.location||n.target.source);if(n.target.source&&console.warn("Mutation target does not match expected type."),!t)return[xr(0,0,"")];switch(n.type){case Dr:return et(t,n);case Br:return nt(t,n);case $r:return Wr(t,n.index);case br:return qr(t,n,e);case Kr:return zr(t,n,e);case"PC_REMOVE_CHILD_NODE":return Wr(t,n.index);case"PC_REMOVE_NODE":return Jr(t)}return[xr(0,0,"")]},Qr=function(e,n){return e.location.start.line===n.start.line&&e.location.start.column===n.start.column&&e.location.end.line===n.end.line&&e.location.end.column===n.end.column},Xr=function(n,r){if(Qr(n,r))return n;if(n.type===e.PCExpressionType.FRAGMENT||n.type===e.PCExpressionType.ELEMENT)for(var t=0,o=n.childNodes;t<o.length;t++){var i=o[t],a=Xr(i,r);if(a)return a}},Wr=function(e,n){var r=e.childNodes[n];return Jr(r)},Jr=function(e){return[xr(e.location.start.pos,e.location.end.pos,"")]},qr=function(e,n,r){var t=n.target,o=n.index,i=n.child;return zr(e,Hr(t,o,i.nodeValue||i.outerHTML),r)},zr=function(n,r,t){var o=r.childIndex,i=r.html;if(n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT)return[xr(Zr((u=n).location.end.pos-2,t),u.location.end.pos,">"+i+"</"+u.name+">")];var a=n.childNodes[o];if(!a){var u=n;return[xr(u.startTag.location.end.pos,u.startTag.location.end.pos,i)]}return[xr(a.location.start.pos,a.location.start.pos,i)]},Zr=function(e,n){var r=n.substr(0,e).split("").reverse().join("").match(/^([\s\r\n\t]+)/)||["",""];return e-r[1].length},et=function(e,n){var r=n.newValue;return[xr(e.location.start.pos,e.location.end.pos,r)]},nt=function(n,r){var t;n.type===e.PCExpressionType.SELF_CLOSING_ELEMENT?t=n:n.type===e.PCExpressionType.ELEMENT&&(t=n.startTag);for(var o,i=r.name,a=r.newValue&&'"'+r.newValue+'"',u=0,s=t.attributes;u<s.length;u++){var c=s[u];if(c.name===i)return o=!0,a?[xr(c.value.location.start.pos,c.value.location.end.pos,a)]:[xr(c.location.start.pos-1,c.location.end.pos,"")]}if(!o){var E=t.location.start.pos+t.name.length+1;return[xr(E,E,!0===r.newValue?i:" "+i+"="+a)]}};e.getElementChildNodes=i,e.getElementTagName=a,e.getAttributeStringValue=u,e.getElementAttributes=s,e.getElementModifiers=c,e.isTag=E,e.filterPCElementsByStartTag=p,e.getElementStartTag=l,e.getPCStartTagAttribute=T,e.hasPCStartTagAttribute=f,e.getPCStyleElements=d,e.getPCLinkStyleElements=_,e.getPCCSSElements=y,e.getPCMetaTags=v,e.getPCMetaName=S,e.traversePCAST=R,e.getStartTag=N,e.getPCElementModifier=C,e.getExpressionPath=A,e.filterPCASTTree=O,e.getPCASTElementsByTagName=h,e.getPCParent=L,e.getAllChildElementNames=m,e.parseModuleSource=G,e.parseStyleSource=H,e.createString=Z,e.eatWhitespace=me,e.throwUnexpectedToken=ge,e.addUnexpectedToken=Pe,e.testCurrTokenExists=Ie,e.testCurrTokenType=Me,e.bundleVanilla=We,e.transpileBlockExpression=Je,e.transpileStyleElement=Tn,e.transpileCSSSheet=gn,e.loadModuleAST=De,e.defaultResolveModulePath=Be,e.getChildComponentInfo=be,e.getDependencyChildComponentInfo=$e,e.getModuleComponent=Ke,e.getUsedDependencies=we,e.getImportDependencies=Ye,e.getComponentDependency=Ve,e.loadModuleDependencyGraph=Ge,e.parseMetaContent=ke,e.getComponentMetadataItems=Fe,e.getComponentMetadataItem=je,e.setSymbolTableEntries=Xn,e.inferredType=Jn,e.symbolTable=qn,e.inferRootNodeTypes=er,e.inferNodeTypes=nr,e.inferElementAttributeTypes=cr,e.inferElementSpreadTypes=Er,e.loadComponentTypes=lr,e.parseDeclaration=fr,e.stringifyDeclarationAST=Ar,e.editPaperclipSource=jr,e.PC_REMOVE_CHILD_NODE="PC_REMOVE_CHILD_NODE",e.PC_REMOVE_NODE="PC_REMOVE_NODE",e.createPCRemoveChildNodeMutation=kr,e.createPCRemoveNodeMutation=Fr,e.generatePrettyErrorMessage=g,Object.defineProperty(e,"__esModule",{value:!0})});
