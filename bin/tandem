#!/usr/bin/env node
var createApp = require('../lib/@tandem/back-end/server').create;

var argv = require('yargs').argv;
var path = require('path');
var exec = require('child_process').exec;

var filepath = argv._[0];

if (filepath && !/^\//.test(filepath)) {
  filepath = path.join(process.cwd(), filepath);
}

var app = createApp();

app.bus.execute({
  type  : 'openProjectFile',
  path  : filepath
}).then(function() {
  if (argv.open !== false) {
    exec(`open http://localhost:${app.config.port}/editor`);
  }
});
